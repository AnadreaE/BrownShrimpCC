select(E, L, J_f, J2_f, J3_f, J4_f, J5_f, A1_f, J_m, J2_m, J3_m, J4_m, J5_m, A1_m, A2, A3)
# Loop through 4 quarters
par(mfrow = c(2, 2))
# Define colors for each sex: f = light blue, m = steel blue, U = gray
cols <- c("f" = "#8856a7", "m" = "#add8e6", "U" = "gray80")
# Define x-axis label order (class names)
x_labels_vec <- c("E", "L", "J", "J2", "J3", "J4", "J5", "A1", "A2", "A3")
label_map <- c(
"E" = "E",
"L" = "i-0.6",
"J" = "0.6-1",
"J2" = "1-2",
"J3" = "2-3",
"J4" = "3-4",
"J5" = "4-5",
"A1" = "5-6",
"A2" = "6-7",
"A3" = "7-Linf"
)
#width_vector_all <- rep(1, length(x_labels_vec))  # Optional bar widths
# Loop through 4 quarters
for (q in 1:4) {
# Indices for each quarter
init_idx <- 912 * (q - 1) + 1
final_idx <- 912 * q
# Subset data for quarter
quarter_data <- fishery_M_F_2015[init_idx:final_idx, ]
# 1. Get sexed class columns (e.g., J_f, J2_m, A1_f, etc.)
sexed_df <- quarter_data %>%
select(matches("^(J|A1)\\d?_f$|^(J|A1)\\d?_m$"))
# 2. Get unsexed class columns: E and L
unsexed_df1 <- quarter_data %>%
select(E, L)
unsexed_df2 <- quarter_data %>%
select( A2, A3)
# 3. Compute column means
sexed_means <- colMeans(sexed_df)
unsexed1_means <- colMeans(unsexed_df1)
unsexed2_means <- colMeans(unsexed_df2)
# 4. Create long-format data frame for sexed
sexed_df_long <- data.frame(
class_sex = names(sexed_means),
value = as.numeric(sexed_means)
) %>%
separate(class_sex, into = c("class", "sex"), sep = "_")
# 5. Create long-format data frame for unsexed, with sex = "U"
unsexed1_df_long <- data.frame(
class = names(unsexed1_means),
value = as.numeric(unsexed1_means),
sex = "U"
)
unsexed2_df_long <- data.frame(
class = names(unsexed2_means),
value = as.numeric(unsexed2_means),
sex = "U"
)
# 6. Combine both
means_df <- bind_rows(unsexed1_df_long , sexed_df_long, unsexed2_df_long)
# 7. Set class as factor to preserve desired order
means_df$class <- factor(means_df$class, levels = x_labels_vec)
means_df$label <- label_map[as.character(means_df$class)]
# 8. Pivot to wide format for barplot
means_mat <- means_df %>%
pivot_wider(names_from = sex, values_from = value, values_fill = 0 ) %>%
arrange(class) %>%
select(any_of(c("f", "m", "U")))  # Ensure consistent column order
# 9. Transpose to matrix for barplot (rows = sex, columns = classes)
mat <- t(as.matrix(means_mat))
# 10. Draw barplot
barplot(mat,
col = cols[rownames(mat)],
main = paste('F & M - Q', q, '2015'),
names.arg = label_map[levels(means_df$class)], #x_labels_vec,
las = 2,
cex.main = 2,
cex.axis = 1.5,
cex.names = 1.5,
ylim = c(0,3),#c(0, max(colSums(mat)) * 1.1),
# width = width_vector_all,
space = 0,
beside = FALSE,
legend.text = rownames(mat),
args.legend = list(x = "topright", bty = "n", inset = 0.02, cex = 1, y.intersp = 0.5)
)
}
lopt = function(l_pred){
l = log(l_pred)
r=-1.65
gamma = 0.011
return(r + l - gamma*l^2)
}
ingestion_kernel = function(I_max, l_pred, l_prey){
l_opt = lopt(l_pred)
return(I_max*exp(-3/2*(log(l_prey)-l_opt)^2))
}
cod_lRange = seq(2.5, 120, 0.1) #[cm]
cod_larvRange = seq(2.5, 3, 0.01) #[cm]
shrimp_lRange = seq(0.155, 8.5, 0.0071) #(8.5-0.15)/1176 steps to meet same length as cod L range
plot(cod_lRange, exp(lopt(cod_lRange)), main = 'Optimal prey lenght of cod', xlab= 'Cod L [cm]',
ylab = 'prey l [cm]' , col = 'gray41', las = 1, cex.axis=1.5, cex.lab=1.5)#, cex.main=1.3, xlim = c(1,4), ylim = c(0,2))
abline(h=0.2, lty= 2, col = 'lightsalmon', lwd=2)
abline(h=8.5, lty=2, col='tomato3', lwd = 2)
legend("topleft", c('l_opt', 'min l BS', 'max l BS') ,col=c('gray41','lightsalmon', 'tomato3'),
lty = c(1,2,2), lwd=2)
dev.off()
plot(cod_lRange, exp(lopt(cod_lRange)), main = 'Optimal prey lenght of cod', xlab= 'Cod L [cm]',
ylab = 'prey l [cm]' , col = 'gray41', las = 1, cex.axis=1.5, cex.lab=1.5)#, cex.main=1.3, xlim = c(1,4), ylim = c(0,2))
abline(h=0.2, lty= 2, col = 'lightsalmon', lwd=2)
abline(h=8.5, lty=2, col='tomato3', lwd = 2)
legend("topleft", c('l_opt', 'min l BS', 'max l BS') ,col=c('gray41','lightsalmon', 'tomato3'),
lty = c(1,2,2), lwd=2)
natural_mort_br <- sapply(temp_range, respiration_rate_b, L=3, sex_params = parameters_solv$Fem_params)
library(dplyr)
library(lubridate)
library(BrownShrimp)
library(deSolve)
#Here I will check plausibility of individual funciton that are used in the model
#### Some params ####
temp_range = seq(1,30, 0.1)
the.method = 'rk4'
h = 0.2 # half saturatuion constant original aprox .5
L_inf = 8.5
epsilon = 0.22
m = 3
const_c = 0.01
natural_mort_br <- sapply(temp_range, respiration_rate_b, L=3, sex_params = parameters_solv$Fem_params)
#dev.off()
plot(temp_range, respiration_rate(temp_range, 3) , type = "b", col = "blue",
xlab = "Temperature (°C)", ylab = " ",
main = "natural mortality Gauss vs Briere")
lines(temp_range, natural_mort_br, type = "b", col = 'red' , cex = 0.5)
legend("topright", legend = c("Gauss", "Briere"), col = c("blue", "red"), lty = 1, pch = 1)
natural_mort_br <- sapply(temp_range, respiration_rate_b, L=5, sex_params = parameters_solv$Fem_params)
#dev.off()
plot(temp_range, respiration_rate(temp_range, 3) , type = "b", col = "blue",
xlab = "Temperature (°C)", ylab = " ",
main = "natural mortality Gauss vs Briere")
lines(temp_range, natural_mort_br, type = "b", col = 'red' , cex = 0.5)
legend("topright", legend = c("Gauss", "Briere"), col = c("blue", "red"), lty = 1, pch = 1)
natural_mort_br <- sapply(temp_range, respiration_rate_b, L=5, sex_params = parameters_solv$Fem_params)
#dev.off()
plot(temp_range, respiration_rate(temp_range, 5) , type = "b", col = "blue",
xlab = "Temperature (°C)", ylab = " ",
main = "natural mortality Gauss vs Briere")
lines(temp_range, natural_mort_br, type = "b", col = 'red' , cex = 0.5)
legend("topright", legend = c("Gauss", "Briere"), col = c("blue", "red"), lty = 1, pch = 1)
?respiration_rate_b
Temp = c(5, 10, 15, 20)
length_range = seq(0.6, 8.5, 0.05)
plot( length_range, sapply(length_range, respiration_rate_b, temperature = Temp[1], sex_params = parameters_solv$Fem_params) )
for (i in 2:4){
lines(length_range, sapply(length_range, respiration_rate_b, temperature = Temp[i], sex_params = parameters_solv$Fem_params) )
}
plot( length_range, sapply(length_range, respiration_rate_b, temperature = Temp[1], sex_params = parameters_solv$Fem_params), xlim = 0.009 )
plot( length_range, sapply(length_range, respiration_rate_b, temperature = Temp[1], sex_params = parameters_solv$Fem_params), ylim = 0.009 )
plot( length_range, sapply(length_range, respiration_rate_b, temperature = Temp[1], sex_params = parameters_solv$Fem_params), ylim = c(0,009= )
plot( length_range, sapply(length_range, respiration_rate_b, temperature = Temp[1], sex_params = parameters_solv$Fem_params), ylim = c(0,009))
for (i in 2:4){
lines(length_range, sapply(length_range, respiration_rate_b, temperature = Temp[i], sex_params = parameters_solv$Fem_params) )
}
plot( length_range, sapply(length_range, respiration_rate_b, temperature = Temp[1], sex_params = parameters_solv$Fem_params), ylim = c(0,0.09))
for (i in 2:4){
lines(length_range, sapply(length_range, respiration_rate_b, temperature = Temp[i], sex_params = parameters_solv$Fem_params) )
}
plot( length_range, sapply(length_range, respiration_rate_b, temperature = Temp[1], sex_params = parameters_solv$Fem_params), ylim = c(0,0.009))
for (i in 2:4){
lines(length_range, sapply(length_range, respiration_rate_b, temperature = Temp[i], sex_params = parameters_solv$Fem_params) )
}
Temp = c(5, 10, 15, 20, 25)
length_range = seq(0.6, 8.5, 0.05)
plot( length_range, sapply(length_range, respiration_rate_b, temperature = Temp[1], sex_params = parameters_solv$Fem_params), ylim = c(0,0.01))
for (i in 2:4){
lines(length_range, sapply(length_range, respiration_rate_b, temperature = Temp[i], sex_params = parameters_solv$Fem_params) )
}
Temp = c(5, 10, 15, 20, 25)
length_range = seq(0.6, 8.5, 0.05)
colors = c('lightpink', 'lightgoldenrod', 'olivedrab1', 'peru', 'violet')
plot( length_range, sapply(length_range, respiration_rate_b, temperature = Temp[1], sex_params = parameters_solv$Fem_params), ylim = c(0,0.02), col = colors[1])
for (i in 2:4){
lines(length_range, sapply(length_range, respiration_rate_b, temperature = Temp[i], sex_params = parameters_solv$Fem_params),
col = colors[1])
}
legend("topleft", legend = paste( 'T= ', as.character(Temp)), col = colors, lty = 1, pch = 1)
Temp = c(5, 10, 15, 20, 25)
length_range = seq(0.6, 8.5, 0.05)
colors = c('lightpink', 'lightgoldenrod', 'olivedrab1', 'peru', 'violet')
plot( length_range, sapply(length_range, respiration_rate_b, temperature = Temp[1], sex_params = parameters_solv$Fem_params),
ylim = c(0,0.02), col = colors[1])
for (i in 2:4){
lines(length_range, sapply(length_range, respiration_rate_b, temperature = Temp[i], sex_params = parameters_solv$Fem_params),
col = colors[i], lwd = 2)
}
legend("topleft", legend = paste( 'T= ', as.character(Temp)), col = colors, lty = 1, pch = 1)
Temp = c(5, 10, 15, 20, 25)
length_range = seq(0.6, 8.5, 0.05)
colors = c('lightpink', 'lightgoldenrod', 'olivedrab1', 'peru', 'violet')
plot( length_range, sapply(length_range, respiration_rate_b, temperature = Temp[1], sex_params = parameters_solv$Fem_params),
ylim = c(0,0.02), col = colors[1])
for (i in 2:5){
lines(length_range, sapply(length_range, respiration_rate_b, temperature = Temp[i], sex_params = parameters_solv$Fem_params),
col = colors[i], lwd = 2)
}
legend("topleft", legend = paste( 'T= ', as.character(Temp)), col = colors, lty = 1, pch = 1)
legend("topleft", legend = paste( 'T= ', as.character(Temp)),
col = colors, lty = 1, pch = c(1,2,2,2,2))
Temp = c(5, 10, 15, 20, 25)
length_range = seq(0.6, 8.5, 0.05)
colors = c('lightpink', 'navy', 'olivedrab1', 'peru', 'violet')
plot( length_range, sapply(length_range, respiration_rate_b, temperature = Temp[1], sex_params = parameters_solv$Fem_params),
ylim = c(0,0.02), col = colors[1])
for (i in 2:5){
lines(length_range, sapply(length_range, respiration_rate_b, temperature = Temp[i], sex_params = parameters_solv$Fem_params),
col = colors[i], lwd = 2)
}
legend("topleft", legend = paste( 'T= ', as.character(Temp)),
col = colors, lty = 1, pch = c(1,2,2,2,2))
Temp = c(5, 10, 15, 20, 25)
length_range = seq(0.6, 8.5, 0.05)
colors = c('lightpink', 'navy', 'olivedrab1', 'peru', 'violet')
plot( length_range, sapply(length_range, respiration_rate_b, temperature = Temp[1], sex_params = parameters_solv$Fem_params),
ylim = c(0,0.015), col = colors[1])
for (i in 2:5){
lines(length_range, sapply(length_range, respiration_rate_b, temperature = Temp[i], sex_params = parameters_solv$Fem_params),
col = colors[i], lwd = 2)
}
legend("topleft", legend = paste( 'T= ', as.character(Temp)),
col = colors, lty = 1, pch = c(1,2,2,2,2))
?shift_next_sizeClass
?shift_next_sizeClass
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = Temp[1], sex_params = parameters_solv$Fem_params) )
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = Temp[1], sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', Temp[1] ) )
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = Temp[1], sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', Temp[1] ), ylab = 'rate' )
points(0.001, hatch_eggs(Temp[1]), col = 'khaki1')
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = Temp[1], sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', Temp[1] ), ylab = 'rate' , ylim = c(0, 0.1))
points(0.001, hatch_eggs(Temp[1]), col = 'khaki1')
hatch_eggs(Temp[1])
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = Temp[1], sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', Temp[1] ), ylab = 'rate' )#, ylim = c(0, 0.1))
points(0.01, hatch_eggs(Temp[1]), col = 'khaki1')
points(1, hatch_eggs(Temp[1]), col = 'khaki1')
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = Temp[1], sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', Temp[1] ), ylab = 'rate' )#, ylim = c(0, 0.1))
points(1, hatch_eggs(Temp[1]), col = 'khaki1')
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = Temp[1], sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', Temp[1] ), ylab = 'rate' )#, ylim = c(0, 0.1))
lines(1, hatch_eggs(Temp[1]), col = 'khaki1')
plot(1, hatch_eggs(Temp[1]), col = 'khaki1')
hatch_eggs(Temp[1])
plot(1, hatch_eggs(Temp[1]), col = 'khaki1', lty=1)
plot(1, hatch_eggs(Temp[1]), col = 'khaki4', lty=1)
plot(1, hatch_eggs(Temp[1]), fill = 'khaki4', lty=1)
points(1, hatch_eggs(Temp[1]), col = 'khaki4', lty=1)
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = Temp[1], sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', Temp[1] ), ylab = 'rate' )#, ylim = c(0, 0.1))
points(1, hatch_eggs(Temp[1]), col = 'khaki4', lty=1)
points(1, hatch_eggs(Temp[1]), col = 'khaki4', bg = 'khaki1' ,lty=1)
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = Temp[1], sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', Temp[1] ), ylab = 'rate' )#, ylim = c(0, 0.1))
points(1, hatch_eggs(Temp[1]), col = 'khaki4', bg = 'khaki3' ,lty=1)
points(1, hatch_eggs(Temp[1]), col = 'khaki4', bg = 'khaki3')
points(1, hatch_eggs(Temp[1]), col = 'khaki4', bg = 'khaki3', pch = 21)
points(1, hatch_eggs(Temp[1]), col = 'khaki4', bg = 'khaki3', pch = 21, cex = 2)
points(0.1, hatch_eggs(Temp[1]), col = 'khaki4', bg = 'khaki3', pch = 21, cex = 2)
points(0.6, shiftTo_juvenile(Temp[1]), col = 'slateblue4', bg = 'slateblue', pch = 21, cex = 2 )
par(mfrow = c(2,2))
for (i in Temp[1:4]){
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = i, sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', i ), ylab = 'rate' )#, ylim = c(0, 0.1))
points(0.1, hatch_eggs(i), col = 'khaki4', bg = 'khaki3', pch = 21, cex = 2)
points(0.6, shiftTo_juvenile(i), col = 'slateblue4', bg = 'slateblue', pch = 21, cex = 2 )
legend('topright', legend= c('Eggs', 'Larvae', 'Juvenile'), col = c('black', 'khaki4', 'slateblue'))
}
par(mfrow = c(2,2))
for (i in Temp[1:4]){
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = i, sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', i ), ylab = 'rate' , ylim = c(0, 0.15))
points(0.1, hatch_eggs(i), col = 'khaki4', bg = 'khaki3', pch = 21, cex = 2)
points(0.6, shiftTo_juvenile(i), col = 'slateblue4', bg = 'slateblue', pch = 21, cex = 2 )
legend('topright', legend= c('Eggs', 'Larvae', 'Juvenile'), col = c('black', 'khaki4', 'slateblue'))
}
legend('topright', legend= c('Eggs', 'Larvae', 'Juvenile'), col = c('black', 'khaki4', 'slateblue'), pch = c(1,2,2,2,2))
par(mfrow = c(2,2))
for (i in Temp[1:4]){
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = i, sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', i ), ylab = 'rate' , ylim = c(0, 0.15))
points(0.1, hatch_eggs(i), col = 'khaki4', bg = 'khaki3', pch = 21, cex = 2)
points(0.6, shiftTo_juvenile(i), col = 'slateblue4', bg = 'slateblue', pch = 21, cex = 2 )
legend('topright', legend= c('Eggs', 'Larvae', 'Juvenile'), col = c('black', 'khaki4', 'slateblue'), pch = c(1,2,2,2,2))
}
par(mfrow = c(2,2))
for (i in Temp[1:4]){
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = i, sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', i ), ylab = 'rate' , ylim = c(0, 0.15))
points(0.1, hatch_eggs(i), col = 'khaki4', bg = 'khaki3', pch = 21, cex = 3)
points(0.6, shiftTo_juvenile(i), col = 'slateblue4', bg = 'slateblue', pch = 21, cex = 2 )
legend('topright', legend= c('Eggs', 'Larvae', 'Juvenile'), col = c('khaki4', 'slateblue', 'black'),
pch = c(1,2,2,2,2), lty = 1)
}
par(mfrow = c(2,2))
for (i in Temp[1:4]){
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = i, sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', i ), ylab = 'rate' , ylim = c(0, 0.15))
points(0.3, hatch_eggs(i), col = 'khaki4', bg = 'khaki3', pch = 21, cex = 2)
points(0.8, shiftTo_juvenile(i), col = 'slateblue4', bg = 'slateblue', pch = 21, cex = 2 )
legend('topright', legend= c('Eggs', 'Larvae', 'Juvenile'), col = c('khaki4', 'slateblue', 'black'),
pch = c(1,2,2,2,2), lty = 1)
}
par(mfrow = c(2,2))
for (i in Temp[1:4]){
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = i, sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', i ), ylab = 'rate' , ylim = c(0, 0.15))
points(0.5, hatch_eggs(i), col = 'khaki4', bg = 'khaki3', pch = 21, cex = 2)
points(0.8, shiftTo_juvenile(i), col = 'slateblue4', bg = 'slateblue', pch = 21, cex = 2 )
legend('topright', legend= c('Eggs', 'Larvae', 'Juvenile'), col = c('khaki4', 'slateblue', 'black'),
pch = c(1,2,2,2,2), lty = 1)
}
developmentTima_larvae = 1/shiftTo_juvenile(12)
developmentTima_larvae
developmentTime_larvae = 1/shiftTo_juvenile(12)
par(mfrow = c(2,2))
for (i in Temp[1:4]){
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = i, sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', i ), ylab = 'rate' , ylim = c(0, 0.18))
points(0.5, hatch_eggs(i), col = 'khaki4', bg = 'khaki3', pch = 21, cex = 2)
points(0.8, shiftTo_juvenile(i), col = 'slateblue4', bg = 'slateblue', pch = 21, cex = 2 )
legend('topright', legend= c('Eggs', 'Larvae', 'Juvenile'), col = c('khaki4', 'slateblue', 'black'),
pch = c(1,2,2,2,2), lty = 1)
}
developmentTime_larvae = 1/shiftTo_juvenile(12)
?shift_next_sizeClass
developmentTime_juv3 = 1/shift_next_sizeClass(3,12, parameters_solv$Fem_params)
developmentTime_juv3
developmentTime_juv3 = 1/shift_next_sizeClass(5,12, parameters_solv$Fem_params)
developmentTime_juv3
developmentTime_juv3 = 1/shift_next_sizeClass(2,12, parameters_solv$Fem_params)
developmentTime_juv3
par(mfrow = c(2,2))
for (i in Temp[1:4]){
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = i, sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', i ), ylab = 'rate' , ylim = c(0, 0.18),
xlab = 'L [cm]', ylab = 'rate', las = 1)
points(0.5, hatch_eggs(i), col = 'khaki4', bg = 'khaki3', pch = 21, cex = 2)
points(0.8, shiftTo_juvenile(i), col = 'slateblue4', bg = 'slateblue', pch = 21, cex = 2 )
legend('topright', legend= c('Eggs', 'Larvae', 'Juvenile'), col = c('khaki4', 'slateblue', 'black'),
pch = c(1,2,2,2,2), lty = 1, cex = 1.3)
}
par(mfrow = c(2,2))
for (i in Temp[1:4]){
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = i, sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', i ), ylim = c(0, 0.18),
xlab = 'L [cm]', ylab = 'rate', las = 1)
points(0.5, hatch_eggs(i), col = 'khaki4', bg = 'khaki3', pch = 21, cex = 2)
points(0.8, shiftTo_juvenile(i), col = 'slateblue4', bg = 'slateblue', pch = 21, cex = 2 )
legend('topright', legend= c('Eggs', 'Larvae', 'Juvenile'), col = c('khaki4', 'slateblue', 'black'),
pch = c(1,2,2,2,2), lty = 1, cex = 1.3)
}
par(mfrow = c(2,2))
for (i in Temp[1:4]){
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = i, sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', i ), ylim = c(0, 0.18),
xlab = 'L [cm]', ylab = 'rate', las = 1)
points(0.5, hatch_eggs(i), col = 'khaki4', bg = 'khaki3', pch = 21, cex = 2)
points(0.8, shiftTo_juvenile(i), col = 'slateblue4', bg = 'slateblue', pch = 21, cex = 2 )
legend('topright', legend= c('Eggs', 'Larvae', 'Juvenile'), col = c('khaki4', 'slateblue', 'black'),
pch = c(1,2,2,2,2), lty = 1, cex = 1.15)
}
par(mfrow = c(2,2))
for (i in Temp[1:4]){
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = i, sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', i ), ylim = c(0, 0.18),
xlab = 'L [cm]', ylab = 'rate', las = 1)
points(0.5, hatch_eggs(i), col = 'khaki4', bg = 'khaki3', pch = 21, cex = 2)
points(0.8, shiftTo_juvenile(i), col = 'slateblue4', bg = 'slateblue', pch = 21, cex = 2 )
legend('topright', legend= c('Eggs', 'Larvae', 'Juvenile'), col = c('khaki4', 'slateblue', 'black'),
pch = c(1,2,2,2,2), lty = 1, cex = 1.1)
}
par(mfrow = c(2,2))
for (i in Temp[1:4]){
plot(length_range,
sapply(length_range, shift_next_sizeClass, temperatur = i, sex_params = parameters_solv$Fem_params),
main = paste('Growth rates at T =', i ), ylim = c(0, 0.18),
xlab = 'L [cm]', ylab = 'rate', las = 1)
points(0.5, hatch_eggs(i), col = 'khaki4', bg = 'khaki3', pch = 21, cex = 2)
points(0.8, shiftTo_juvenile(i), col = 'slateblue4', bg = 'slateblue', pch = 21, cex = 2 )
legend('topright', legend= c('Eggs', 'Larvae', 'Juvenile'), col = c('khaki4', 'slateblue', 'black'),
pch = c(1,2,2,2,2), lty = 1, cex = 1.05, lwd = 2)
}
1/shiftTo_juvenile(12)
1/shiftTo_juvenile(10)
?dev_egg
egg_dev(10#)
egg_dev(10)
egg_dev(10)
devtools::load_all(".")
egg_dev(10)
hatch_eggs(10)
1/hatch_eggs(10)
1/shiftTo_juvenile(10)
devtools::load_all(".")
som_growth(5, 10, 85)
som_growth(5, 10, 85, 'F')
som_growth(0.5, 10, 85, 'F')
1/molting_fraction(6, 10)
1/molting_fraction(6, 12)
1/molting_fraction(6, 16)
0.01878 * 6^3.539
0.01878 * 60^3.539
library(BrownShrimp)
#APPROACH: to compare and if applicable, to adapt own spawning function to Temings result.
#For all simulations, I will consider a constant number of females (100) with an specific size (6 cm)
#### MOLTING FRACTION ####
#Check behavior of molting fraction
molting_fraction_old <- function(L, temperature){
mf = 0
if (L >= 5){
mf = (1 / (5.7066 * L^0.7364 * exp(temperature*-0.09363) ) ) #revision 28.05. Temming's implementation (above was Temming's formula on paper)
}
return ( mf )
}
temp_range_wide = seq(1,40, 0.1)
plot(temp_range_wide, molting_fraction_old(6, temp_range_wide))
abline(h = 1, lty= 2)
avg_weight_egg = 17.725*10^-6 #[gr] ~avg 17.725 microgramm over the year (from table from seasonal changes on eggs Urzua)
temp_range = seq(0,30, 0.1)
fem_abundance <- 100 #number of females (we will consider first also a constant size L=6 cm)
L_test1 <- 6 #cm
#TEMING
# SI = C_l * E_l * EF_l * MF_l
# c_l: number of individuals per a size class 'l'
# E_l: Share of egg-bearing Fem in size class 'l'
# EF_l: mean number of eggs per size class
# MF_l: molting frequency
number_eggs <- function(L){
0.01805*L^3.539 #incongruency on Temming's paper weather 0.01805 or 0.001805. The first seem more plausible for me
}
eggs_production_temming <- c()
eggs_production_AF <- c()
spawning_rate_old <- function(L, temperature){
s = 0
if(L>5) s = convertL_to_W(L)*K_func(temperature)*3
return(s)
}
for (i in temp_range){
prod_temming <- fem_abundance*molting_fraction(L_test1, i)*number_eggs(L_test1*10) #L*10 because Temming's fomula is in mm
B_fe = convertL_to_W(6)
prod_AF <- B_fe*fem_abundance*molting_fraction(L_test1, i)*spawning_rate_old(L_test1, i)#/epsilon #Biommass
eggs_production_temming <- append(eggs_production_temming, prod_temming) #number of eggs
eggs_production_AF <- append(eggs_production_AF, prod_AF) #biomass
}
eggs_production_temming <- c()
eggs_production_AF <- c()
for (i in temp_range){
prod_temming <- fem_abundance*molting_fraction(L_test1, i)*number_eggs(L_test1*10) #L*10 because Temming's fomula is in mm
B_fe = convertL_to_W(6)
prod_AF <- B_fe*fem_abundance*molting_fraction(L_test1, i)*spawning_rate_b(L_test1, i, parameters_solv$Fem_params)#/epsilon #Biommass
eggs_production_temming <- append(eggs_production_temming, prod_temming) #number of eggs
eggs_production_AF <- append(eggs_production_AF, prod_AF) #biomass
}
Teming_biomass = eggs_production_temming*avg_weight_egg #[gr]
plot(temp_range, Teming_biomass, main = "Egg production Temming vs Bertalanffy \n  Nr. Fems. = 100, L=6cm",
xlab = 'T [°C]', ylab = 'Biomass [gr]', col = 'gray41', las = 1, lwd = 2,
cex.main = 1.5, cex.lab = 1.75, cex.axis = 1.75)
lines(temp_range, eggs_production_AF, col = 'orangered3', lwd = 3)
abline(v = temp_range[which.max(Teming_biomass)], lty = 2)
legend("topleft",
legend = c("Temming", "v. Bertalanffy k*w", "T_opt"),
col = c("gray41", "orangered3", "black"),
pch = c(16, NA, NA),
lty = c(1,1,2))
plot(temp_range, Teming_biomass, main = "Egg production Temming vs Bertalanffy \n  Nr. Fems. = 100, L=6cm",
xlab = 'T [°C]', ylab = 'Biomass [gr]', col = 'gray41', las = 1, lwd = 2,
cex.main = 1.5, cex.lab = 1.75, cex.axis = 1.75)
lines(temp_range, eggs_production_AF, col = 'orangered3', lwd = 3)
abline(v = temp_range[which.max(Teming_biomass)], lty = 2)
legend("buttonrigth",
legend = c("Temming", "v. Bertalanffy k*w", "T_opt"),
col = c("gray41", "orangered3", "black"),
pch = c(16, NA, NA),
lty = c(1,1,2))
legend("bottomrigth",
legend = c("Temming", "v. Bertalanffy k*w", "T_opt"),
col = c("gray41", "orangered3", "black"),
pch = c(16, NA, NA),
lty = c(1,1,2))
legend("bottomright",
legend = c("Temming", "v. Bertalanffy k*w", "T_opt"),
col = c("gray41", "orangered3", "black"),
pch = c(16, NA, NA),
lty = c(1,1,2))
