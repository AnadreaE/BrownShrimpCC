summarise(avg_L = mean(L_avg, na.rm = TRUE), avg_B = mean(ttlB, na.rm = TRUE), .groups = "drop")
init15 = as.POSIXct("2015-01-01", format="%Y-%m-%d", tz = "UTC")
end15 = as.POSIXct("2015-12-31", format="%Y-%m-%d", tz = "UTC")
plot(weekly_avg_noPreasure$avg_L[weekly_avg_noPreasure$year == 2015], weekly_avg_noPreasure$avg_B[weekly_avg_noPreasure$year == 2015],
lwd = 3, col = 'grey', lty=1, ylim = c(50,1000), xlim = c(2.5, 4.35) )
points(weekly_avg_fish$avg_L[weekly_avg_fish$year == 2015], weekly_avg_fish$avg_B[weekly_avg_fish$year == 2015], lwd = 2, col ='skyblue4' )
points(weekly_avg_pred$avg_L[weekly_avg_pred$year == 2015], weekly_avg_pred$avg_B[weekly_avg_pred$year == 2015], lwd = 2, col ='indianred3' )
points(weekly_avg_both$avg_L[weekly_avg_both$year == 2015], weekly_avg_both$avg_B[weekly_avg_pred$year == 2015], lwd = 2, col= 'hotpink' )
legend("topleft", legend = c('no preasure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', 'indianred3', 'skyblue4','hotpink'), border = NA, bty = "n", y.intersp = 0.7)
plot(weekly_avg_noPreasure$avg_L[weekly_avg_noPreasure$year == 2015], weekly_avg_noPreasure$avg_B[weekly_avg_noPreasure$year == 2015],
lwd = 3, col = 'grey', lty=1, ylim = c(50,1000), xlim = c(2.5, 5.5) )
points(weekly_avg_fish$avg_L[weekly_avg_fish$year == 2015], weekly_avg_fish$avg_B[weekly_avg_fish$year == 2015], lwd = 2, col ='skyblue4' )
points(weekly_avg_pred$avg_L[weekly_avg_pred$year == 2015], weekly_avg_pred$avg_B[weekly_avg_pred$year == 2015], lwd = 2, col ='indianred3' )
points(weekly_avg_both$avg_L[weekly_avg_both$year == 2015], weekly_avg_both$avg_B[weekly_avg_pred$year == 2015], lwd = 2, col= 'hotpink' )
legend("topleft", legend = c('no preasure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', 'indianred3', 'skyblue4','hotpink'), border = NA, bty = "n", y.intersp = 0.7)
plot(weekly_avg_noPreasure$avg_L[weekly_avg_noPreasure$year == 2015], weekly_avg_noPreasure$avg_B[weekly_avg_noPreasure$year == 2015],
lwd = 3, col = 'grey', lty=1, ylim = c(50,1000), xlim = c(2.5, 5) )
points(weekly_avg_fish$avg_L[weekly_avg_fish$year == 2015], weekly_avg_fish$avg_B[weekly_avg_fish$year == 2015], lwd = 2, col ='skyblue4' )
points(weekly_avg_pred$avg_L[weekly_avg_pred$year == 2015], weekly_avg_pred$avg_B[weekly_avg_pred$year == 2015], lwd = 2, col ='indianred3' )
points(weekly_avg_both$avg_L[weekly_avg_both$year == 2015], weekly_avg_both$avg_B[weekly_avg_pred$year == 2015], lwd = 2, col= 'hotpink' )
legend("topleft", legend = c('no preasure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', 'indianred3', 'skyblue4','hotpink'), border = NA, bty = "n", y.intersp = 0.7)
avg_weight_egg = 17.725*10^-6 #[gr] ~avg 17.725 microgramm over the year (from table from seasonal changes on eggs Urzua)
temp_range = seq(0,30, 0.1)
mat_size_range = seq(5.5, 8.5, by = 0.1)
fem_abundance <- 1 #number of females (we will consider first also a constant size L=6 cm)
L_test1 <- 6 #cm
#TEMING
# SI = C_l * E_l * EF_l * MF_l
# c_l: number of individuals per a size class 'l'
# E_l: Share of egg-bearing Fem in size class 'l'
# EF_l: mean number of eggs per size class
# MF_l: molting frequency
number_eggs <- function(L){
0.01805*L^3.539 #incongruency on Temming's paper weather 0.01805 or 0.001805. The first seem more plausible for me
}
#### SIMULATIONS ####
temp_range = seq(1,30, 0.1)
eggs_production_temming <- c()
eggs_production_AF <- c()
spawning_rate_vB <- function(L, temperature){
s = 0
if(L>5.5) s = convertL_to_W(L)*K_func(temperature)*3
return(s)
}
spawning_s = data.frame(row = seq(1, length(temp_range)))
egg_prod_T = data.frame(row = seq(1, length(temp_range)))
for (s in mat_size_range){
eggs_production_temming = c()
eggs_production_AF = c()
for (i in temp_range){
prod_temming <- fem_abundance*number_eggs(s*10) #L*10 because Temming's fomula is in mm
#B_fe = convertL_to_W(s)
#prod_AF <- B_fe*fem_abundance*spawning_rate_vB(s, i)#, parameters_solv$Fem_params) #Biommass
prod_AF <-fem_abundance*spawning_rate_vB(s, i)#, parameters_solv$Fem_params) #Biommass
eggs_production_temming <- append(eggs_production_temming, prod_temming) #number of eggs
eggs_production_AF <- append(eggs_production_AF, prod_AF) #biomass
}
spawning_s[as.character(s)] <- eggs_production_AF
egg_prod_T[as.character(s)] <- eggs_production_temming
}
Teming_biomass = egg_prod_T[, 2:ncol(egg_prod_T)]*avg_weight_egg#eggs_production_temming*avg_weight_egg #[gr]
plot(temp_range, Teming_biomass$'6', ylim = c(0,0.7))
lines(temp_range, spawning_s$'6', col = 'red')
factor = c()
for (i in 1:ncol(Teming_biomass)){
B_i = convertL_to_W(mat_size_range[i])
factor = append(factor, Teming_biomass[[i]][1]/B_i)
}
B_sc =  convertL_to_W(mat_size_range)
logx = log(B_sc)
logy = log(factor)
fit_factortsLog = lm(logy ~ logx)
summary(fit_factortsLog)
log_a <- coef(fit_factortsLog)[1]
b_est <- coef(fit_factortsLog)[2]
a_est <- exp(log_a)
plot(B_sc, factor, log = 'xy')
lines(B_sc, a_est * B_sc^b_est, col = 'red')
b_est
a_est
####
temperature_dataSet <- read.csv("./data/Temperature_data_1982-2018_MarBiol.csv", header = TRUE, sep = ';')
temperature_90 <- temperature_func(temperature_dataSet, "01/01/1990", "31/12/1990")
temperature_85 <- temperature_func(temperature_dataSet, "01/01/1985", "31/12/1985")
spG_90 = sapply(temperature_90$temperature, spawning_rate_b, L = 5.5, sex_params= parameters_solv$Fem_params)
#END OF REVISED VERSION 30.05.25
####
temperature_dataSet <- read.csv("./data/Temperature_data_1982-2018_MarBiol.csv", header = TRUE, sep = ';')
temperature_90 <- temperature_func(temperature_dataSet, "01/01/1990", "31/12/1990")
temperature_85 <- temperature_func(temperature_dataSet, "01/01/1985", "31/12/1985")
spG_90 = sapply(temperature_90$temperature, spawning_rate_b, L = 5.5, sex_params= parameters_solv$Fem_params)
spawning_rate = function(L, Te){
interc = coef(fit_intercepts)[1] + L*coef(fit_intercepts)[2]
fact = coef(fit_factors)[1] + L*coef(fit_factors)[2]
return(B_fe*fem_abundance*molting_fraction(s, i)*spawning_rate_vB(s, i))
}
plot(temp_range, Teming_biomass, main = "Temming vs AF fitted \n with constant T and for L=6cm",
xlab = 'T', ylab = 'Biomass')
Nr_Afem = 100
molFraction_Temming = molting_fraction_Temming(6, temp_range)
library(BrownShrimp)
#APPROACH: to compare and if applicable, to adapt own spawning function to Temings result.
#For all simulations, I will consider a constant number of females (100) with an specific size (6 cm)
#### MOLTING FRACTION ####
#Check behavior of molting fraction
molting_fraction_Temming <- function(L, temperature){
mf = 0
if (L >= 5.5){
L=10*L
mf = (1 / (5.7066 * L^0.7364 * exp(temperature*-0.09363) ) ) #revision 28.05. Temming's implementation (above was Temming's formula on paper)
}
return ( mf )
}
vB_term = function(L, fem_params, Te){
w = convertL_to_W(L)
return(3*K_func_briere(Te, parameters_solv$Fem_params)*w)
}
number_eggs <- function(L){
L=L*10
0.01805*L^3.539 #incongruency on Temming's paper weather 0.01805 or 0.001805. The first seem more plausible for me
}
temp_range_wide = seq(1,40, 0.1)
avg_weight_egg = 17.725*10^-6 #[gr] ~avg 17.725 microgramm over the year (from table from seasonal changes on eggs Urzua)
temp_range = seq(0,30, 0.1)
mat_size_range = seq(5.5, 8.5, by = 0.1)
Nr_Afem = 100
molFraction_Temming = molting_fraction_Temming(6, temp_range)
ovigerous_fem_Temming = Nr_Afem*molFraction_Temming
biomass_temming = ovigerous_fem_Temming*number_eggs(6)*avg_weight_egg
molFraction_Thesis = sapply(temp_range, spawning_energy, L=6,  Fem_params = parameters_solv$Fem_params)
spawning_energy = function(L, Te, Fem_params){
w = convertL_to_W(L)
vB = 3*K_func_briere(Te, parameters_solv$Fem_params)*w
intercept = coef(fit_intercept_exp)[1]*exp(L*-coef(fit_intercept_exp)[2])
factor = coef(fit_facto_exp)[1]*exp(L*-coef(fit_facto_exp)[2])
return(mean(intercept_fits) + vB*factor)
}
plot(temp_range, benchmark_moltingFraction$`6`, main = 'test for L = 7cm')
Nr_Afem = 100
molFraction_Temming = molting_fraction_Temming(6, temp_range)
ovigerous_fem_Temming = Nr_Afem*molFraction_Temming
biomass_temming = ovigerous_fem_Temming*number_eggs(6)*avg_weight_egg
molFraction_Thesis = sapply(temp_range, spawning_energy, L=6,  Fem_params = parameters_solv$Fem_params)
ovigerous_fem_Thesis = Nr_Afem*molFraction_Thesis
biomass_thesis = ovigerous_fem_Thesis*spawning_rate_b(6)
library(BrownShrimp)
#APPROACH: to compare and if applicable, to adapt own spawning function to Temings result.
#For all simulations, I will consider a constant number of females (100) with an specific size (6 cm)
#### MOLTING FRACTION ####
#Check behavior of molting fraction
molting_fraction_Temming <- function(L, temperature){
mf = 0
if (L >= 5.5){
L=10*L
mf = (1 / (5.7066 * L^0.7364 * exp(temperature*-0.09363) ) ) #revision 28.05. Temming's implementation (above was Temming's formula on paper)
}
return ( mf )
}
vB_term = function(L, fem_params, Te){
w = convertL_to_W(L)
return(3*K_func_briere(Te, parameters_solv$Fem_params)*w)
}
number_eggs <- function(L){
L=L*10
0.01805*L^3.539 #incongruency on Temming's paper weather 0.01805 or 0.001805. The first seem more plausible for me
}
temp_range_wide = seq(1,40, 0.1)
par(mfrow=c(1,1))
plot(temp_range_wide, molting_fraction_Temming(6, temp_range_wide), ylim = c(0,0.4), main = "Molting fraction Temming vs Bertalanffy term \n L=6cm",
xlab = 'T [Â°C]', ylab = 'molting fraction')
abline(h = 1, lty= 2) #Surpassing one is very unrealistic !
lines(temp_range_wide, sapply(temp_range_wide, vB_term, L=6, fem_params=parameters_solv$Fem_params), col = 'red')
#We identify here that curve keeps growing with temperatures that are not realistic and that are not congruent
#with TPC theory; furthermore, the mf goes above 1, which is also completely unrealistic.
#Solution: piece-wise (already implemented in bib) mf for T above T_opt is always same as mf at T_opt
K_vals = sapply(temp_range, K_func_briere, parameters_solv$Fem_params)
plot(temp_range, benchmark_moltingFraction$`6`, main = 'test for L = 6cm')
avg_weight_egg = 17.725*10^-6 #[gr] ~avg 17.725 microgramm over the year (from table from seasonal changes on eggs Urzua)
temp_range = seq(0,30, 0.1)
mat_size_range = seq(5.5, 8.5, by = 0.1)
benchmark_egg_biomass = data.frame(row = seq(1, length(temp_range)))
fem_abundance <- 1 #number of females (we will consider first also a constant size L=6 cm)
for (s in mat_size_range){
eggs_production_temming = c()
#eggs_production_AF = c()
for (i in temp_range){
prod_temming <- fem_abundance*number_eggs(s) #L*10 because Temming's fomula is in mm
#B_fe = convertL_to_W(s)
#prod_AF <- B_fe*fem_abundance*spawning_rate_vB(s, i)#, parameters_solv$Fem_params) #Biommass
#prod_AF <-fem_abundance*spawning_rate_vB(s, i)#, parameters_solv$Fem_params) #Biommass
eggs_production_temming <- append(eggs_production_temming, prod_temming) #number of eggs
#eggs_production_AF <- append(eggs_production_AF, prod_AF) #biomass
}
#spawning_s[as.character(s)] <- eggs_production_AF
benchmark_egg_biomass[as.character(s)] <- eggs_production_temming
}
benchmark_egg_biomass = benchmark_egg_biomass[, 2:ncol(benchmark_egg_biomass)]*avg_weight_egg#eggs_production by one individual
benchmark_moltingFraction = data.frame(row = seq(1, length(temp_range)))
for (s in mat_size_range){
mol_fraction_temming = c()
#eggs_production_AF = c()
for (i in temp_range){
mf <- molting_fraction_Temming(s, i) #L*10 because Temming's fomula is in mm
mol_fraction_temming <- append(mol_fraction_temming, mf) #number of eggs
}
benchmark_moltingFraction[as.character(s)] <- mol_fraction_temming
}
#delete first column 'row'
benchmark_moltingFraction =  benchmark_moltingFraction[,2:ncol(benchmark_moltingFraction)]
plot(temp_range, benchmark_moltingFraction$`6`)
t_optstep = T_opt*10
T_opt = which.max(K_vals)/10
K_vals = sapply(temp_range, K_func_briere, parameters_solv$Fem_params)
T_opt = which.max(K_vals)/10
avg_weight_egg = 17.725*10^-6 #[gr] ~avg 17.725 microgramm over the year (from table from seasonal changes on eggs Urzua)
temp_range = seq(0,30, 0.1)
mat_size_range = seq(5.5, 8.5, by = 0.1)
benchmark_egg_biomass = data.frame(row = seq(1, length(temp_range)))
fem_abundance <- 1 #number of females (we will consider first also a constant size L=6 cm)
for (s in mat_size_range){
eggs_production_temming = c()
#eggs_production_AF = c()
for (i in temp_range){
prod_temming <- fem_abundance*number_eggs(s) #L*10 because Temming's fomula is in mm
#B_fe = convertL_to_W(s)
#prod_AF <- B_fe*fem_abundance*spawning_rate_vB(s, i)#, parameters_solv$Fem_params) #Biommass
#prod_AF <-fem_abundance*spawning_rate_vB(s, i)#, parameters_solv$Fem_params) #Biommass
eggs_production_temming <- append(eggs_production_temming, prod_temming) #number of eggs
#eggs_production_AF <- append(eggs_production_AF, prod_AF) #biomass
}
#spawning_s[as.character(s)] <- eggs_production_AF
benchmark_egg_biomass[as.character(s)] <- eggs_production_temming
}
benchmark_egg_biomass = benchmark_egg_biomass[, 2:ncol(benchmark_egg_biomass)]*avg_weight_egg#eggs_production by one individual
benchmark_moltingFraction = data.frame(row = seq(1, length(temp_range)))
for (s in mat_size_range){
mol_fraction_temming = c()
#eggs_production_AF = c()
for (i in temp_range){
mf <- molting_fraction_Temming(s, i) #L*10 because Temming's fomula is in mm
mol_fraction_temming <- append(mol_fraction_temming, mf) #number of eggs
}
benchmark_moltingFraction[as.character(s)] <- mol_fraction_temming
}
#delete first column 'row'
benchmark_moltingFraction =  benchmark_moltingFraction[,2:ncol(benchmark_moltingFraction)]
plot(temp_range, benchmark_moltingFraction$`6`)
t_optstep = T_opt*10
vB_vals = sapply(temp_range, vB_term, L=6, fem_params=parameters_solv$Fem_params)
fit_test = lm(benchmark_moltingFraction$`6`[1:t_optstep] ~ vB_vals[1:t_optstep])
summary(fit_test)
#Check with different sizes
plot(temp_range, benchmark_moltingFraction$`6`, main = 'test for L = 6cm')
lines(temp_range, coef(fit_test)[1] + vB_vals * coef(fit_test)[2], col = 'red' )
vB_vals = sapply(temp_range, vB_term, L=7, fem_params=parameters_solv$Fem_params)
plot(temp_range, benchmark_moltingFraction$`7`, main = 'test for L = 7cm')
lines(temp_range, coef(fit_test)[1] + vB_vals * coef(fit_test)[2], col = 'red' )
#A fit for each size has to be carried out:
intercept_fits = c()
factor_fits = c()
for (i in colnames(benchmark_moltingFraction)){
L = as.numeric(i)
vB_vals = sapply(temp_range, vB_term, L=L, fem_params=parameters_solv$Fem_params)
fit = lm(benchmark_moltingFraction[[i]][1:t_optstep] ~ vB_vals[1:t_optstep])
intercept_fits = append(intercept_fits, coef(fit)[1])
factor_fits = append(factor_fits, coef(fit)[2])
}
plot(mat_size_range, intercept_fits)
abline(h=mean(intercept_fits), lty= 2)
fit_intercept_exp = nls(intercept_fits ~ a*exp(mat_size_range*-b), start = list(a=1 ,b=0.05) )
summary(fit_intercept_exp)
plot(mat_size_range, intercept_fits)
lines(mat_size_range,predict(fit_intercept_exp))
plot(mat_size_range, factor_fits)
#here we see the decaying exponential value and thus proceed with fit to convert it as funcion of length
fit_facto_exp = nls(factor_fits ~ a*exp(mat_size_range*-b), start = list(a=1 ,b=0.5) )
summary(fit_facto_exp)
plot(mat_size_range, factor_fits)
lines(mat_size_range, predict(fit_facto_exp), col = 'red')
spawning_energy = function(L, Te, Fem_params){
w = convertL_to_W(L)
vB = 3*K_func_briere(Te, parameters_solv$Fem_params)*w
intercept = coef(fit_intercept_exp)[1]*exp(L*-coef(fit_intercept_exp)[2])
factor = coef(fit_facto_exp)[1]*exp(L*-coef(fit_facto_exp)[2])
return(mean(intercept_fits) + vB*factor)
}
#vB_vals = sapply(temp_range, vB_term, L=7, fem_params=parameters_solv$Fem_params)
plot(temp_range, benchmark_moltingFraction$`6`, main = 'test for L = 7cm')
lines(temp_range, sapply(temp_range, spawning_energy, L=6, Fem_params = parameters_solv$Fem_params), col = 'red' )
Nr_Afem = 100
molFraction_Temming = molting_fraction_Temming(6, temp_range)
ovigerous_fem_Temming = Nr_Afem*molFraction_Temming
biomass_temming = ovigerous_fem_Temming*number_eggs(6)*avg_weight_egg
molFraction_Thesis = sapply(temp_range, spawning_energy, L=6,  Fem_params = parameters_solv$Fem_params)
ovigerous_fem_Thesis = Nr_Afem*molFraction_Thesis
biomass_thesis = ovigerous_fem_Thesis*spawning_rate_b(6)
plot(temp_range, molFraction_Temming)
lines(temp_range, molFraction_Thesis, col = 'red')
Nr_Afem = 100
molFraction_Temming = molting_fraction_Temming(7, temp_range)
ovigerous_fem_Temming = Nr_Afem*molFraction_Temming
biomass_temming = ovigerous_fem_Temming*number_eggs(7)*avg_weight_egg
molFraction_Thesis = sapply(temp_range, molting_fraction, L=7,  Fem_params = parameters_solv$Fem_params)
plot(temp_range, molFraction_Temming)
lines(temp_range, molFraction_Thesis, col = 'red')
B_s = cos(2 * pi * (days_3years - 250) / 365)
eta_J <- function(t_day) {
cos_term <- cos(2 * pi * (t_day - 150) / 365)
eta <- 0.5 + 0.5*cos_term  # gives values from 0 to 2
return(eta^2)         # seasonal amplification
}
ST_predation = function(t_day, Te, B_s){
mu_ref = 0.025 #day^-1 #same as mesozooplankton paper
f_t = 4
sigma = 0.8
eta = eta_J(t_day)
beta = 18 #same as mesozooplankton paper
gamma = 3.7469 #m2 (Kg d)^-1 #original 0.1 m2 (molC d)^-1
return(mu_ref*f_t*sigma*(gamma*B_s + beta*eta ))
}
#test
days_3years = seq(1, 365*3)
B_s = cos(2 * pi * (days_3years - 250) / 365)
plot(days_3years, B_s)
plot(days_3years, B_s)
B_s = 2 + cos(2 * pi * (days_3years - 250) / 365)
plot(days_3years, B_s)
predatio_preasure = ST_predation(days_3years, 10, B_s)
plot(days_3years, predatio_preasure)
ST_predation = function(t_day, Te, B_s){
mu_ref = 0.025 #day^-1 #same as mesozooplankton paper
f_t = 4
sigma = 0.8
eta = eta_J(t_day)
beta = 10 #same as mesozooplankton paper
gamma = 3.7469 #m2 (Kg d)^-1 #original 0.1 m2 (molC d)^-1
return(mu_ref*f_t*sigma*(gamma*B_s + beta*eta ))
}
predatio_preasure = ST_predation(days_3years, 10, B_s)
plot(days_3years, predatio_preasure)
ST_predation = function(t_day, Te, B_s){
mu_ref = 0.025 #day^-1 #same as mesozooplankton paper
f_t = 4
sigma = 0.8
eta = eta_J(t_day)
beta = 5 # mesozooplankton paper = 18
gamma = 3.7469 #m2 (Kg d)^-1 #original 0.1 m2 (molC d)^-1
return(mu_ref*f_t*sigma*(gamma*B_s + beta*eta ))
}
predatio_preasure = ST_predation(days_3years, 10, B_s)
plot(days_3years, predatio_preasure)
ST_predation = function(t_day, Te, B_s){
mu_ref = 0.025 #day^-1 #same as mesozooplankton paper
f_t = 4
sigma = 0.8
eta = eta_J(t_day)
beta = 2 # mesozooplankton paper = 18
gamma = 3.7469 #m2 (Kg d)^-1 #original 0.1 m2 (molC d)^-1
return(mu_ref*f_t*sigma*(gamma*B_s + beta*eta ))
}
predatio_preasure = ST_predation(days_3years, 10, B_s)
plot(days_3years, predatio_preasure)
ST_predation = function(t_day, Te, B_s){
mu_ref = 0.025 #day^-1 #same as mesozooplankton paper
f_t = 2
sigma = 0.8
eta = eta_J(t_day)
beta = 2 # mesozooplankton paper = 18
gamma = 3.7469 #m2 (Kg d)^-1 #original 0.1 m2 (molC d)^-1
return(mu_ref*f_t*sigma*(gamma*B_s + beta*eta ))
}
predatio_preasure = ST_predation(days_3years, 10, B_s)
plot(days_3years, predatio_preasure)
ST_predation = function(t_day, Te, B_s){
mu_ref = 0.025 #day^-1 #same as mesozooplankton paper
f_t = 2
sigma = 0.5
eta = eta_J(t_day)
beta = 2 # mesozooplankton paper = 18
gamma = 3.7469 #m2 (Kg d)^-1 #original 0.1 m2 (molC d)^-1
return(mu_ref*f_t*sigma*(gamma*B_s + beta*eta ))
}
predatio_preasure = ST_predation(days_3years, 10, B_s)
plot(days_3years, predatio_preasure)
ST_predation = function(t_day, Te, B_s){
mu_ref = 0.025 #day^-1 #same as mesozooplankton paper
f_t = 2
sigma = 0.5
eta = eta_J(t_day)
beta = 1.8 # mesozooplankton paper = 18
gamma = 3.7469 #m2 (Kg d)^-1 #original 0.1 m2 (molC d)^-1
return(mu_ref*f_t*sigma*(gamma*B_s + beta*eta ))
}
ST_predation = function(t_day, Te, B_s){
mu_ref = 0.025 #day^-1 #same as mesozooplankton paper
f_t = 2
sigma = 0.5
eta = eta_J(t_day)
beta = 1.8 # mesozooplankton paper = 18
gamma = 3.7469 #m2 (Kg d)^-1 #original 0.1 m2 (molC d)^-1
return(mu_ref*f_t*sigma*(gamma*B_s + beta*eta ))
}
predatio_preasure = ST_predation(days_3years, 10, B_s)
plot(days_3years, predatio_preasure)
ST_predation = function(t_day, Te, B_s){
mu_ref = 0.025 #day^-1 #same as mesozooplankton paper
f_t = 2
sigma = 0.5
eta = eta_J(t_day)
beta = 18 # mesozooplankton paper = 18
gamma = 3.7469 #m2 (Kg d)^-1 #original 0.1 m2 (molC d)^-1
return(mu_ref*f_t*sigma*(gamma*B_s + beta*eta ))
}
predatio_preasure = ST_predation(days_3years, 10, B_s)
plot(days_3years, predatio_preasure)
#See how new_predation function look like:
plot(days_3years, new_Bpredator(days_3years))
devtools::load_all(".")
#See how new_predation function look like:
plot(days_3years, new_Bpredator(days_3years))
#See how new_predation function look like:
plot(days_3years, new_Bpredator(days_3years), main = 'see preador funciton')
ST_predation = function(t_day, Te, B_s){
mu_ref = 0.025 #day^-1 #same as mesozooplankton paper
f_t = 2
sigma = 0.5
eta = eta_J(t_day)
beta = 10 # mesozooplankton paper = 18
gamma = 3.7469 #m2 (Kg d)^-1 #original 0.1 m2 (molC d)^-1
return(mu_ref*f_t*sigma*(gamma*B_s + beta*eta ))
}
ST_predation = function(t_day, Te, B_s){
mu_ref = 0.025 #day^-1 #same as mesozooplankton paper
f_t = 2
sigma = 0.5
eta = eta_J(t_day)
beta = 18 # mesozooplankton paper = 18
gamma = 3.7469 #m2 (Kg d)^-1 #original 0.1 m2 (molC d)^-1
return(mu_ref*f_t*sigma*(gamma*B_s + beta*eta ))
}
predatio_preasure = ST_predation(days_3years, 10, B_s)
plot(days_3years, predatio_preasure)
library(ggplot2)
library(deSolve)
library(RColorBrewer)
library(BrownShrimp)
library(viridis)
library(dplyr)
library(tidyr)
library("colorspace")
library(lubridate)
library(latex2exp)
library(profvis)
#library(devtools)
#UPLOAD TEMPERATURE DATA
temperature_dataSet <- read.csv("./data/Temperature_data_1982-2018_MarBiol.csv", header = TRUE, sep = ';')
temperature_14_18 <- temperature_func(temperature_dataSet, "01/01/2014", "31/12/2018")
t_5years = seq(0,length(temperature_14_18$temperature)-0.1)
state_r = c(P = 2, E = 0.1, L= 0.0928 *1.5 ,
BF = BF+0.1, BM = BM+0.1,
Pred = 0.05 )
#### TEST (1 out of 4) WITHOUT ANY KIND OF PREASURE (P NEITHER F) ####
noPreasure_params = parameters_solv
noPreasure_params$general_params$Fi = 0 #No fishery
noPreasure_params$general_params$Imax_ik = 0 #No predation
start <- Sys.time()
test_noPreasure <- solver_sizeClass.v4(t = t_5years, state = state_r, parameters = noPreasure_params, temperature_dataSet = temperature_14_18)
print(Sys.time() - start)
#Plot size spectra
plot_sizeSpectra(test_noPreasure, 2015, title = "NP")
devtools::load_all(".")
#SIZE SPECTRA MODEL
library(ggplot2)
library(deSolve)
library(RColorBrewer)
library(BrownShrimp)
library(viridis)
library(dplyr)
library(tidyr)
library("colorspace")
library(lubridate)
library(latex2exp)
library(profvis)
#library(devtools)
#UPLOAD TEMPERATURE DATA
temperature_dataSet <- read.csv("./data/Temperature_data_1982-2018_MarBiol.csv", header = TRUE, sep = ';')
temperature_14_18 <- temperature_func(temperature_dataSet, "01/01/2014", "31/12/2018")
t_5years = seq(0,length(temperature_14_18$temperature)-0.1)
state_r = c(P = 2, E = 0.1, L= 0.0928 *1.5 ,
BF = BF+0.1, BM = BM+0.1,
Pred = 0.05 )
#### TEST (1 out of 4) WITHOUT ANY KIND OF PREASURE (P NEITHER F) ####
noPreasure_params = parameters_solv
noPreasure_params$general_params$Fi = 0 #No fishery
noPreasure_params$general_params$Imax_ik = 0 #No predation
start <- Sys.time()
test_noPreasure <- solver_sizeClass.v4(t = t_5years, state = state_r, parameters = noPreasure_params, temperature_dataSet = temperature_14_18)
print(Sys.time() - start)
#Plot size spectra
plot_sizeSpectra(test_noPreasure, 2015, title = "NP")
start <- Sys.time()
test_noPreasure <- solver_sizeClass.v4(t = t_5years, state = state_r, parameters = noPreasure_params, temperature_dataSet = temperature_14_18)
print(Sys.time() - start)
#Plot size spectra
plot_sizeSpectra(test_noPreasure, 2015, title = "NP")
devtools::load_all(".")
#Plot size spectra
plot_sizeSpectra(test_noPreasure, 2015, title = "NP")
View(test_noPreasure)
