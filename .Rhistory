time_range <- seq(1,1095)
temperature_range <- seq(0,25, 0.1) #(10,15)
## Calculate development time for each size class
#### JUVI ####
development_df_juvI <- data.frame(row = seq(1, 1095))
#simulate development with constant temperature for each 0.1?C:
for (i in temperature_range){
development <- c()
initial_l <- 6 #mm
for (j in time_range){
new_legth <- som_growth(initial_l, i, 85, 'F')
development <- append(development, new_legth)
initial_l <- new_legth
}
development_df_juvI[as.character(i)] <- development
}
dev_time_juvI <- sapply(development_df_juvI, function(col){
BrownShrimp::count_devDays(col, juvI_min, juvI_max) } )
dev_time_juvI <- dev_time_juvI[-c(1)]
#plot( (1:251)*0.1,  dev_time_juvI, main = "Development days Juvenile \n with min_size = 6 mm and max_size = 20 mm" )
#Fitting curve for JUVI
#first: delete all values = 1095:
indexes_1095 <- which(dev_time_juvI == 1095)
dev_time_JUVI_reduced <- dev_time_juvI[dev_time_juvI != 1095]
temperature_range_red_juvI <- temperature_range[-indexes_1095]
#plot( (1:length(dev_time_JUVI_reduced))*0.1,  dev_time_JUVI_reduced, main = "Development days Juvenile \n reduced data" )
fit_juvI <- nls( dev_time_JUVI_reduced ~ ( a + c*exp(-b*temperature_range_red_juvI) ),
start = list(a = 40, c = 3000, b = 1))
a_juvI <- coef(fit_juvI)[1]
b_juvI <- coef(fit_juvI)[3]
c_juvI <- coef(fit_juvI)[2]
#(optional) plot results form fit:
plot(temperature_range, dev_time_juvI, pch = 1, col = 'gray28', las = 1, xlab = 'T [?C]', ylab = 'developent time [days]', cex.lab = 1.5, main = 'Class: Juv I')
lines(temperature_range_red_juvI, predict(fit_juvI), col = 'lightseagreen', lwd = 2.5)
#### JUVII ####
development_df_juvII <- data.frame(row = seq(1, 1095))
#simulate development with constant temperature for each 0.1?C:
for (i in temperature_range){
development <- c()
initial_l <- juvII_min #mm
for (j in time_range){
new_legth <- som_growth(initial_l, i, 85, 'F')
development <- append(development, new_legth)
initial_l <- new_legth
}
development_df_juvII[as.character(i)] <- development
}
dev_time_juvII <- sapply(development_df_juvII, function(col){
count_devDays(col, juvII_min, juvII_max) } )
dev_time_juvII <- dev_time_juvII[-c(1)] #first row doesn't make sence
#plot( (1:251)*0.1,  dev_time_juvII, main = paste("Development days Juvenile \n with min_size =", juvII_min , "mm and max_size = ", juvII_max ,"mm") )
#Fitting curve for JUVI
#first: delete all values = 1095:
indexes_1095 <- which(dev_time_juvII == 1095)
dev_time_JUVII_reduced <- dev_time_juvII[dev_time_juvII != 1095]
temperature_range_red_juvII <- temperature_range[-indexes_1095]
#length(temperature_range_red_juvI)
#length(dev_time_JUVI_reduced)
#plot( (1:length(dev_time_JUVII_reduced))*0.1,  dev_time_JUVII_reduced, main = "Development days Juvenile II \n reduced data", xlab = "T ?C", las = 1)
fit_juvII <- nls( dev_time_JUVII_reduced ~ ( a + c*exp(-b*temperature_range_red_juvII) ),
start = list(a = 20, c = 1500, b = 1))
a_juvII <- coef(fit_juvII)[1]
b_juvII <- coef(fit_juvII)[3]
c_juvII <- coef(fit_juvII)[2]
#(optional) plot results form fit:
plot(temperature_range, dev_time_juvII, pch = 1, col = 'gray28', las = 1, xlab = 'T [?C]', ylab = 'developent time [days]', cex.lab = 1.5, main = 'Class: Juv II')
lines(temperature_range_red_juvII, predict(fit_juvII), col = 'lightseagreen', lwd = 2.5)
#### JUVIII ####
development_df_juvIII <- data.frame(row = seq(1, 1095))
#simulate development with constant temperature for each 0.1?C:
for (i in temperature_range){
development <- c()
initial_l <- juvIII_min #mm
for (j in time_range){
new_legth <- som_growth(initial_l, i, 85, 'F')
development <- append(development, new_legth)
initial_l <- new_legth
}
development_df_juvIII[as.character(i)] <- development
}
dev_time_juvIII <- sapply(development_df_juvIII, function(col){
count_devDays(col, juvIII_min, juvIII_max) } )
dev_time_juvIII <- dev_time_juvIII[-c(1)] #first row doesn't make sence
#plot( (1:251)*0.1,  dev_time_juvIII, main = paste("Development days Juvenile \n with min_size =", juvIII_min , "mm and max_size = ", juvIII_max ,"mm") )
#Fitting curve for JUVIII
#first: delete all values = 1095:
indexes_1095 <- which(dev_time_juvIII == 1095)
dev_time_juvIII_reduced <- dev_time_juvIII[dev_time_juvIII != 1095]
temperature_range_red_juvIII <- temperature_range[-indexes_1095]
#plot( (1:length(dev_time_juvIII_reduced))*0.1,  dev_time_juvIII_reduced, main = "Development days Juvenile II \n reduced data", xlab = "T ?C", las = 1)
fit_juvIII <- nls( dev_time_juvIII_reduced ~ ( a + c*exp(-b*temperature_range_red_juvIII) ),
start = list(a = 20, c = 1500, b = 1))
a_juvIII <- coef(fit_juvIII)[1]
b_juvIII <- coef(fit_juvIII)[3]
c_juvIII <- coef(fit_juvIII)[2]
#(optional) plot results form fit:
plot(temperature_range, dev_time_juvIII, pch = 1, col = 'gray28', las = 1, xlab = 'T [°C]', ylab = 'developent time [days]', cex.lab = 1.5, main = 'Class: Juv III')
lines(temperature_range_red_juvIII, predict(fit_juvIII), col = 'lightseagreen', lwd = 2.5)
#### JUVIV ####
development_df_juvIV <- data.frame(row = seq(1, 1095))
#simulate development with constant temperature for each 0.1?C:
for (i in temperature_range){
development <- c()
initial_l <- juvIV_min #mm
for (j in time_range){
new_legth <- som_growth(initial_l, i, 85, 'F')
development <- append(development, new_legth)
initial_l <- new_legth
}
development_df_juvIV[as.character(i)] <- development
}
dev_time_juvIV <- sapply(development_df_juvIV, function(col){
count_devDays(col, juvIV_min, juvIV_max) } )
dev_time_juvIV <- dev_time_juvIV[-c(1)] #first row doesn't make sence
#plot( (1:251)*0.1,  dev_time_juvIV, main = paste("Development days Juvenile \n with min_size =", juvIV_min , "mm and max_size = ", juvIV_max ,"mm") )
#Fitting curve for juvIV
#first: delete all values = 1095:
indexes_1095 <- which(dev_time_juvIV == 1095)
dev_time_juvIV_reduced <- dev_time_juvIV[dev_time_juvIV != 1095]
temperature_range_red_juvIV <- temperature_range[-indexes_1095]
#plot( (1:length(dev_time_juvIV_reduced))*0.1,  dev_time_juvIV_reduced, main = "Development days Juvenile II \n reduced data", xlab = "T ?C", las = 1)
fit_juvIV <- nls( dev_time_juvIV_reduced ~ ( a + c*exp(-b*temperature_range_red_juvIV) ),
start = list(a = 20, c = 1500, b = 1))
a_juvIV <- coef(fit_juvIV)[1]
b_juvIV <- coef(fit_juvIV)[3]
c_juvIV <- coef(fit_juvIV)[2]
#(optional) plot results form fit:
plot(temperature_range, dev_time_juvIV, pch = 1, col = 'gray28', las = 1, xlab = 'T [?C]', ylab = 'developent time [days]', cex.lab = 1.5, main = 'Class: Juv IV')
lines(temperature_range_red_juvIV, predict(fit_juvIV), col = 'lightseagreen', lwd = 2.5)
#### juvV ####
development_df_juvV <- data.frame(row = seq(1, 1095))
#simulate development with constant temperature for each 0.1?C:
for (i in temperature_range){
development <- c()
initial_l <- juvV_min #mm
for (j in time_range){
new_legth <- som_growth(initial_l, i, 85, 'F')
development <- append(development, new_legth)
initial_l <- new_legth
}
development_df_juvV[as.character(i)] <- development
}
dev_time_juvV <- sapply(development_df_juvV, function(col){
count_devDays(col, juvV_min, juvV_max) } )
dev_time_juvV <- dev_time_juvV[-c(1)] #first row doesn't make sence
#plot( (1:251)*0.1,  dev_time_juvV, main = paste("Development days Juvenile \n with min_size =", juvV_min , "mm and max_size = ", juvV_max ,"mm") )
#Fitting curve for juvV
#first: delete all values = 1095:
indexes_1095 <- which(dev_time_juvV == 1095)
dev_time_juvV_reduced <- dev_time_juvV[dev_time_juvV != 1095]
temperature_range_red_juvV <- temperature_range[-indexes_1095]
#plot( (1:length(dev_time_juvV_reduced))*0.1,  dev_time_juvV_reduced, main = "Development days Juvenile II \n reduced data", xlab = "T ?C", las = 1)
fit_juvV <- nls( dev_time_juvV_reduced ~ ( a + c*exp(-b*temperature_range_red_juvV) ),
start = list(a = 20, c = 1500, b = 1))
a_juvV <- coef(fit_juvV)[1]
b_juvV <- coef(fit_juvV)[3]
c_juvV <- coef(fit_juvV)[2]
#(optional) plot results form fit:
plot(temperature_range, dev_time_juvV, pch = 1, col = 'gray28', las = 1, xlab = 'T [?C]', ylab = 'developent time [days]', cex.lab = 1.5, main = 'Class: Juv V')
lines(temperature_range_red_juvV, predict(fit_juvV), col = 'lightseagreen', lwd = 2.5)
#### adultI ####
development_df_adultI <- data.frame(row = seq(1, 1095))
#simulate development with constant temperature for each 0.1?C:
for (i in temperature_range){
development <- c()
initial_l <- adultI_min #mm
for (j in time_range){
new_legth <- som_growth(initial_l, i, 85, 'F')
development <- append(development, new_legth)
initial_l <- new_legth
}
development_df_adultI[as.character(i)] <- development
}
dev_time_adultI <- sapply(development_df_adultI, function(col){
count_devDays(col, adultI_min, adultI_max) } )
dev_time_adultI <- dev_time_adultI[-c(1)] #first row doesn't make sence
#plot( (1:251)*0.1,  dev_time_adultI, main = paste("Development days Juvenile \n with min_size =", adultI_min , "mm and max_size = ", adultI_max ,"mm") )
#Fitting curve for adultI
#first: delete all values = 1095:
indexes_1095 <- which(dev_time_adultI == 1095)
dev_time_adultI_reduced <- dev_time_adultI[dev_time_adultI != 1095]
temperature_range_red_adultI <- temperature_range[-indexes_1095]
#plot( temperature_range_red_adultI,  dev_time_adultI_reduced, main = "Development days Juvenile II \n reduced data", xlab = "T ?C", las = 1)
#view <- development_df_adultI['20.8']
#Failed to make a good fit for the U shape, temporary solution:
#ignore all T values from < 20 (because from 20?C dev. time rises again)
temperature_range_redII_adultI <- temperature_range_red_adultI[temperature_range_red_adultI <= 20]
dev_time_adultI_reducedII <- dev_time_adultI_reduced[1: length(temperature_range_redII_adultI)] #as I know that I want to unselect the last values
fitII_adultI <- nls( dev_time_adultI_reducedII ~ ( a + c*exp(-b*temperature_range_redII_adultI) ),
start = list(a = 100, c = 3000, b = 1))
a_adultI <- coef(fitII_adultI)[1]
b_adultI <- coef(fitII_adultI)[2]
c_adultI <- coef(fitII_adultI)[3]
plot(temperature_range, dev_time_adultI, pch = 1, col = 'gray28', las = 1, xlab = 'T [°C]', ylab = 'developent time [days]', cex.lab = 1.5, main = 'Class: Adult I')
lines(temperature_range_redII_adultI, predict(fitII_adultI), col = 'lightseagreen', lwd = 2.5)
plot(temperature_range, 1/dev_time_adultI, pch = 1, col = 'gray28', las = 1, xlab = 'T [°C]', ylab = 'developent time [days]', cex.lab = 1.5, main = 'Class: Adult I')
#Shifts of Biomass function
shift_next_sizeClass = function(Te, sizeClass){
ratio = 0
if (Te <= 0) {
return (0)
} else {
if (sizeClass == 'juvI'){
a = 11.73753
b = 2.205524
c = 1747.899
ratio = 1 / (a + c*exp(-b*Te))
}
if (sizeClass == 'juvII'){
a = coef(fit_juvII)[1]
b = coef(fit_juvII)[3]
c = coef(fit_juvII)[2]
ratio = 1 / (a + c*exp(-b*Te))
}
if (sizeClass == 'juvIII'){
a = coef(fit_juvIII)[1]
b = coef(fit_juvIII)[3]
c = coef(fit_juvIII)[2]
ratio = 1 / (a + c*exp(-b*Te))
}
if (sizeClass == 'juvIV'){
a = coef(fit_juvIV)[1]
b = coef(fit_juvIV)[3]
c = coef(fit_juvIV)[2]
ratio = 1 / (a + c*exp(-b*Te))
}
if (sizeClass == 'juvV'){
a = coef(fit_juvV)[1]
b = coef(fit_juvV)[3]
c = coef(fit_juvV)[2]
ratio = 1 / (a + c*exp(-b*Te))
}
if (sizeClass == 'adultI'){
a = coef(fitII_adultI)[1]
b = coef(fitII_adultI)[2]
c = coef(fitII_adultI)[3]
ratio = 1 / (a + c*exp(-b*Te))
}
if (sizeClass == 'egg'){
ratio = 1/ (1031.34*Te^-1.345)
}
if (sizeClass == 'larv' ){
ratio = 1 / ((5.5/0.00584)*Te^-1.347)
}
return (ratio)
}
}
the.method = 'rk4'
h = 0.2 # half saturatuion constant original aprox .5
L_inf = 8.5
epsilon = 0.22
m = 3
const_c = 0.01 # reference density g/cm3
t = seq(0,length(temperature_10_11$temperature)-0.1, by = 0.1)
state = c(P = 2, E = 0.1, L= 0.4 , J = .4 , J2 = 0.3, J3 = 0.3, J4 = 0.2, J5 = 0.2, A1 = 0.35, A2 = 0.1)
#state = c(P = 100, E = 2, L= 40 , J = 70 , J2 = 50, A2 = 40)
parameters = c()
test_briere <- solver_sizeClass_extended_b(t = t, state = state2, parameters = parameters, temperature_10_11)
state2 <- c(P = 2, E = 0.1, L= 0.4 , J = .175 , J2 = 0.125, J3 = 0.125, J4 = 0.1, J5 = 0.1, A1 = 0.35, A2 = 0.1)
test_briere <- solver_sizeClass_extended_b(t = t, state = state2, parameters = parameters, temperature_10_11)
start_date <- as.POSIXct("2010-01-01", format="%Y-%m-%d", tz = "UTC")
test_briere <- mutate(test_briere, dateTime = start_date + test_briere$time * 86400) #86400 seconds in one day
test_briere <- test_briere[ , -1] # delete timesteps column
#cc_long_2 <- gather(cc_2, key = "Type", value = "Value", P, E, L, J, J2, J3, J4, J5, A1, A2)
test_briere_long <- test_briere %>%
pivot_longer(-dateTime, names_to = "variable", values_to = "value")
ggplot(test_briere_long, aes(x = dateTime, y = value, color = variable)) +
geom_line(size = 1) +  # Plot lines
labs(title = " extended size classes Briere aprox. each 10 mm \n 2010-2011", x = "Days", y = "Biomass") +
scale_color_manual(
values = c( "P" = "#d9f0a3", "E"= "#1c9099" ,"L" = "gray"  ,"J" = "#bfd3e6", "J2" = "#9ebcda", "J3" = "#8c96c6", "J4" = "#8856a7", "J5" = "#810f7c" ,
"A1" = "#fd8d3c" ,"A2" = "#e6550d" )) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), # Center title
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.position="bottom") + ylim(0,10) + xlim( as.POSIXct("2010-04-01", format="%Y-%m-%d", tz = "UTC") , as.POSIXct("2010-07-10", format="%Y-%m-%d", tz = "UTC") )
ggplot(test_briere_long, aes(x = dateTime, y = value, color = variable)) +
geom_line(size = 1) +  # Plot lines
labs(title = " extended size classes Briere aprox. each 10 mm \n 2010-2011", x = "Days", y = "Biomass") +
scale_color_manual(
values = c( "P" = "#d9f0a3", "E"= "#1c9099" ,"L" = "gray"  ,"J" = "#bfd3e6", "J2" = "#9ebcda", "J3" = "#8c96c6", "J4" = "#8856a7", "J5" = "#810f7c" ,
"A1" = "#fd8d3c" ,"A2" = "#e6550d" )) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), # Center title
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.position="bottom")
devtools::load_all(".")
test_briere <- solver_sizeClass_extended_b(t = t, state = state2, parameters = parameters, temperature_10_11)
start_date <- as.POSIXct("2010-01-01", format="%Y-%m-%d", tz = "UTC")
test_briere <- mutate(test_briere, dateTime = start_date + test_briere$time * 86400) #86400 seconds in one day
test_briere <- test_briere[ , -1] # delete timesteps column
#cc_long_2 <- gather(cc_2, key = "Type", value = "Value", P, E, L, J, J2, J3, J4, J5, A1, A2)
test_briere_long <- test_briere %>%
pivot_longer(-dateTime, names_to = "variable", values_to = "value")
ggplot(test_briere_long, aes(x = dateTime, y = value, color = variable)) +
geom_line(size = 1) +  # Plot lines
labs(title = " extended size classes Briere aprox. each 10 mm \n 2010-2011", x = "Days", y = "Biomass") +
scale_color_manual(
values = c( "P" = "#d9f0a3", "E"= "#1c9099" ,"L" = "gray"  ,"J" = "#bfd3e6", "J2" = "#9ebcda", "J3" = "#8c96c6", "J4" = "#8856a7", "J5" = "#810f7c" ,
"A1" = "#fd8d3c" ,"A2" = "#e6550d" )) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), # Center title
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.position="bottom")
tim()
time()
system.time()
sys.time()
Sys.time()
View(test_briere)
View(temperature_10_11)
K_func_briere(-5)
K_func_briere(0)
K_func_briere(1)
K_func_briere(10)
K_func_briere(15)
devtools::load_all(".")
start <- Sys.time()
test_briere <- solver_sizeClass_extended_b(t = t, state = state2, parameters = parameters, temperature_10_11)
print(Sys.time() - start)
start_date <- as.POSIXct("2010-01-01", format="%Y-%m-%d", tz = "UTC")
test_briere <- mutate(test_briere, dateTime = start_date + test_briere$time * 86400) #86400 seconds in one day
test_briere <- test_briere[ , -1] # delete timesteps column
#cc_long_2 <- gather(cc_2, key = "Type", value = "Value", P, E, L, J, J2, J3, J4, J5, A1, A2)
test_briere_long <- test_briere %>%
pivot_longer(-dateTime, names_to = "variable", values_to = "value")
ggplot(test_briere_long, aes(x = dateTime, y = value, color = variable)) +
geom_line(size = 1) +  # Plot lines
labs(title = " extended size classes Briere aprox. each 10 mm \n 2010-2011", x = "Days", y = "Biomass") +
scale_color_manual(
values = c( "P" = "#d9f0a3", "E"= "#1c9099" ,"L" = "gray"  ,"J" = "#bfd3e6", "J2" = "#9ebcda", "J3" = "#8c96c6", "J4" = "#8856a7", "J5" = "#810f7c" ,
"A1" = "#fd8d3c" ,"A2" = "#e6550d" )) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), # Center title
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.position="bottom")
View(test_briere)
K_func_briere(1)
K_func_briere(0)
K_func_briere(-5)
devtools::load_all(".")
#### Now Test new Kfunction Briere ####
start <- Sys.time()
test_briere <- solver_sizeClass_extended_b(t = t, state = state2, parameters = parameters, temperature_10_11)
print(Sys.time() - start)
start_date <- as.POSIXct("2010-01-01", format="%Y-%m-%d", tz = "UTC")
test_briere <- mutate(test_briere, dateTime = start_date + test_briere$time * 86400) #86400 seconds in one day
test_briere <- test_briere[ , -1] # delete timesteps column
#cc_long_2 <- gather(cc_2, key = "Type", value = "Value", P, E, L, J, J2, J3, J4, J5, A1, A2)
test_briere_long <- test_briere %>%
pivot_longer(-dateTime, names_to = "variable", values_to = "value")
ggplot(test_briere_long, aes(x = dateTime, y = value, color = variable)) +
geom_line(size = 1) +  # Plot lines
labs(title = " extended size classes Briere aprox. each 10 mm \n 2010-2011", x = "Days", y = "Biomass") +
scale_color_manual(
values = c( "P" = "#d9f0a3", "E"= "#1c9099" ,"L" = "gray"  ,"J" = "#bfd3e6", "J2" = "#9ebcda", "J3" = "#8c96c6", "J4" = "#8856a7", "J5" = "#810f7c" ,
"A1" = "#fd8d3c" ,"A2" = "#e6550d" )) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), # Center title
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.position="bottom")
View(test_briere)
ingestion_rate_b(2, 5, 2)
ingestion_rate_b(0, 5, 2)
ingestion_rate_b(-1, 5, 2)
ingestion_rate_b(-8, 5, 2)
spawning_rate_b(5.5, 3)
spawning_rate_b(5.5, 0)
spawning_rate_b(5.5, -1)
0*0
natural_mortality_b(3, 6)
natural_mortality_b(10, 6)
natural_mortality_b(10, 3)
natural_mortality_b(0, 3)
natural_mortality_b(-1, 3)
natural_mortality_b(10, 3)
natural_mortality_b(1, 3)
natural_mortality_b(0.1, 3)
natural_mortality_b(5.5, 3)
natural_mortality_b(0.8, 3)
natural_mortality_b(0.5, 3)
natural_mortality_b(0.15, 3)
natural_mortality_b(0.19, 3)
natural_mortality_b(0.2, 3)
natural_mortality_b(0.3, 3)
natural_mortality_b(0.4, 3)
natural_mortality_b(10, 3)
natural_mortality_b(5, 3)
natural_mortality_b(1, 3)
natural_mortality_b(0.5, 3)
start <- Sys.time()
test_briere <- solver_sizeClass_extended_b(t = t, state = state2, parameters = parameters, temperature_10_11)
print(Sys.time() - start)
start_date <- as.POSIXct("2010-01-01", format="%Y-%m-%d", tz = "UTC")
test_briere <- mutate(test_briere, dateTime = start_date + test_briere$time * 86400) #86400 seconds in one day
test_briere <- test_briere[ , -1] # delete timesteps column
#cc_long_2 <- gather(cc_2, key = "Type", value = "Value", P, E, L, J, J2, J3, J4, J5, A1, A2)
test_briere_long <- test_briere %>%
pivot_longer(-dateTime, names_to = "variable", values_to = "value")
ggplot(test_briere_long, aes(x = dateTime, y = value, color = variable)) +
geom_line(size = 1) +  # Plot lines
labs(title = " extended size classes Briere aprox. each 10 mm \n 2010-2011", x = "Days", y = "Biomass") +
scale_color_manual(
values = c( "P" = "#d9f0a3", "E"= "#1c9099" ,"L" = "gray"  ,"J" = "#bfd3e6", "J2" = "#9ebcda", "J3" = "#8c96c6", "J4" = "#8856a7", "J5" = "#810f7c" ,
"A1" = "#fd8d3c" ,"A2" = "#e6550d" )) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), # Center title
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.position="bottom")
devtools::load_all(".")
start <- Sys.time()
test_briere <- solver_sizeClass_extended_b(t = t, state = state2, parameters = parameters, temperature_10_11)
print(Sys.time() - start)
start_date <- as.POSIXct("2010-01-01", format="%Y-%m-%d", tz = "UTC")
test_briere <- mutate(test_briere, dateTime = start_date + test_briere$time * 86400) #86400 seconds in one day
test_briere <- test_briere[ , -1] # delete timesteps column
#cc_long_2 <- gather(cc_2, key = "Type", value = "Value", P, E, L, J, J2, J3, J4, J5, A1, A2)
test_briere_long <- test_briere %>%
pivot_longer(-dateTime, names_to = "variable", values_to = "value")
ggplot(test_briere_long, aes(x = dateTime, y = value, color = variable)) +
geom_line(size = 1) +  # Plot lines
labs(title = " extended size classes Briere aprox. each 10 mm \n 2010-2011", x = "Days", y = "Biomass") +
scale_color_manual(
values = c( "P" = "#d9f0a3", "E"= "#1c9099" ,"L" = "gray"  ,"J" = "#bfd3e6", "J2" = "#9ebcda", "J3" = "#8c96c6", "J4" = "#8856a7", "J5" = "#810f7c" ,
"A1" = "#fd8d3c" ,"A2" = "#e6550d" )) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), # Center title
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.position="bottom")
K_func_briere(0.5)
K_func_briere(0)
K_func_briere(-5)
natural_mortality_b(2, 3)
natural_mortality_b(1, 3)
natural_mortality_b(0, 3)
natural_mortality_b(-5, 3)
View(test_briere)
natural_mortality_b(-0.25, 3)
K_func_briere(-0.25)
devtools::load_all(".")
start <- Sys.time()
test_briere <- solver_sizeClass_extended_b(t = t, state = state2, parameters = parameters, temperature_10_11)
print(Sys.time() - start)
View(test_briere)
start_date <- as.POSIXct("2010-01-01", format="%Y-%m-%d", tz = "UTC")
test_briere <- mutate(test_briere, dateTime = start_date + test_briere$time * 86400) #86400 seconds in one day
test_briere <- test_briere[ , -1] # delete timesteps column
View(test_briere)
natural_mortality(0.03)
natural_mortality_b(0.03)
K_func_briere(0.03)
K_func_briere(0)
K_func_briere(0.5)
K_func_briere(0.4)
K_func_briere(0.1)
K_func_briere(-5)
K_func_briere(10)
K_func_briere(5)
K_func_briere(2)
K_func_briere(1)
K_func_briere(0)
devtools::load_all(".")
start <- Sys.time()
test_briere <- solver_sizeClass_extended_b(t = t, state = state2, parameters = parameters, temperature_10_11)
library(dplyr)
library(ggplot2)
library(cowplot) #for combined plots
library(RColorBrewer)
library("colorspace")
library(deSolve)
library(tidyr)
library(RColorBrewer)
library(BrownShrimp)
library(viridis)
start <- Sys.time()
test_briere <- solver_sizeClass_extended_b(t = t, state = state2, parameters = parameters, temperature_10_11)
print(Sys.time() - start)
start_date <- as.POSIXct("2010-01-01", format="%Y-%m-%d", tz = "UTC")
test_briere <- mutate(test_briere, dateTime = start_date + test_briere$time * 86400) #86400 seconds in one day
test_briere <- test_briere[ , -1]
View(test_briere)
test_briere_long <- test_briere %>%
pivot_longer(-dateTime, names_to = "variable", values_to = "value")
ggplot(test_briere_long, aes(x = dateTime, y = value, color = variable)) +
geom_line(size = 1) +  # Plot lines
labs(title = " extended size classes Briere aprox. each 10 mm \n 2010-2011", x = "Days", y = "Biomass") +
scale_color_manual(
values = c( "P" = "#d9f0a3", "E"= "#1c9099" ,"L" = "gray"  ,"J" = "#bfd3e6", "J2" = "#9ebcda", "J3" = "#8c96c6", "J4" = "#8856a7", "J5" = "#810f7c" ,
"A1" = "#fd8d3c" ,"A2" = "#e6550d" )) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), # Center title
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.position="bottom")
ggplot(test_briere_long, aes(x = dateTime, y = value, color = variable)) +
geom_line(size = 1) +  # Plot lines
labs(title = " extended size classes Briere aprox. each 10 mm \n 2010-2011", x = "Days", y = "Biomass") +
scale_color_manual(
values = c( "P" = "#d9f0a3", "E"= "#1c9099" ,"L" = "gray"  ,"J" = "#bfd3e6", "J2" = "#9ebcda", "J3" = "#8c96c6", "J4" = "#8856a7", "J5" = "#810f7c" ,
"A1" = "#fd8d3c" ,"A2" = "#e6550d" )) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), # Center title
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.position="bottom") + ylim(0,10)
