juvIII_max <- 3.0
juvIV_min  <- 3.0
juvIV_max <- 4.0
juvV_min  <- 4.0
juvV_max <- 5.0
adultI_min <- 5.0
adultI_max <- 6.0
adultII_min <- 6.0
adultII_max <- 7.0
adultIII_min <- 7.0
adultIII_max <- Linf_F
#Define mean sizes for each range [cm]
LL = 0.3
LJ = (juvI_min+juvI_max)/2
LJ2 = (juvII_min+juvII_max)/2
LJ3 = (juvIII_min+juvIII_max)/2
LJ4 = (juvIV_min+juvIV_max)/2
LJ5 = (juvV_min+juvV_max)/2
LA1 = (adultI_min + adultI_max)/2
LA2 = (adultII_min + adultII_max)/2
LA3 = (adultIII_min + adultIII_max)/2
sizeClass_names = c("LJ", "LJ2", "LJ3", "LJ4", "LJ5", "LA1", "LA2", "LA3" )
sizeClass_means = c(LJ, LJ2, LJ3, LJ4, LJ5, LA1, LA2, LA3 )
#### Def. growth function (as function of time) ####
lengthGrowth_funcTime = function (L0, time, temp, sex){ #L[cm]
#This funciton works only in this context i.e. to simulate growth with constant temperatures in order to
#compare and check plausibilty of the results.
L0 = L0*10
if (sex == "F") Linf = 85
if (sex == "M") Linf = 55
if (L0 > Linf ) growth = 0
else growth = Linf- (Linf-L0)*exp(-K_func_briere(temp)*3*time)
return(growth/10 )
}
#### Simulations ####
time_range <- seq(1,1095)
temperature_range <- seq(0,30, 0.1) #(10,15)
k_vals = sapply(temperature_range, K_func_briere)
#### JUVI ####
development.df_juvI <- data.frame(row = seq(1, 1095))
#simulate development with constant temperature for each 0.1°C & store results columns wise in the df:
for (i in temperature_range){
development <- c()
initial_l <- 0.6 #cm
for (j in time_range){
growth = lengthGrowth_funcTime(initial_l, j ,i , "F")
#initial_l = growth #+  L_init
development = append(development, growth)
}
development.df_juvI[as.character(i)] <- development
}
development.df_juvI = development.df_juvI[ , !(names(development.df_juvI) == "row")] #delete first column with timesteps, same as index
#Count how many time steps there are, where individual's size is between min and max size of its size class range:
dev_time_juvI <- sapply(development.df_juvI, function(col){
BrownShrimp::count_devDays(col, juvI_min, juvI_max) } )
#dev_time_juvI <- dev_time_juvI[-c(1)] #delete first element cuz doesn't make sense
#dev.off()
#With following plot, we know the shape of the curve (U shape. But inverted is again TPC)
plot( (1:length(dev_time_juvI))*0.1, dev_time_juvI, main = "Development days Juvenile I \n min_size = 0.6 cm and max_size = 1 cm" )
plot( (1:length(dev_time_juvI))*0.1, 1/dev_time_juvI, main = "1/Development days Juvenile I \n min_size = 0.6 cm and max_size = 1 cm" )
lines(temperature_range, k_vals, col = 'red', ldw = 2)
legend("topright", legend = c('1/devTime', 'K_func_briere'), fill = c("black", "red"))
#Deleet values where there is no development i.e. when devTime = 1095
indexes_1095 <- which(dev_time_juvI == 1095)
dev_time_JUVI_reduced <- dev_time_juvI[dev_time_juvI != 1095]
temperature_range_red_juvI <- temperature_range[-indexes_1095]
k_vals_reduced_JUVI = k_vals[-indexes_1095]
devTime_juvI_inv_reduced = 1/dev_time_JUVI_reduced
k_vals_reduced_JUVI_inv = 1/k_vals_reduced_JUVI
fit_JuvI = lm(dev_time_JUVI_reduced ~ k_vals_reduced_JUVI_inv )
summary(fit_JuvI)
plot( (1:length(dev_time_juvI))*0.1, dev_time_juvI, main = "Development days Juvenile vs fit I \n min_size = 6 mm and max_size = 20 mm" )
lines(temperature_range_red_juvI, predict(fit_JuvI), col = 'red4', lwd = 2)
legend("topright", legend = c('1/devTime', 'K_func_briere'), fill = c("black", "red4"))
#### JUV II ####
development.df_juvII <- data.frame(row = seq(1, 1095))
#simulate development with constant temperature for each 0.1°C & store results columns wise in the df:
for (i in temperature_range){
development <- c()
initial_l <- 1 #cm
for (j in time_range){
growth = lengthGrowth_funcTime(initial_l, j ,i , "F")
#initial_l = growth #+  L_init
development = append(development, growth)
}
development.df_juvII[as.character(i)] <- development
}
development.df_juvII = development.df_juvII[ , !(names(development.df_juvII) == "row")] #delete first column with timesteps, same as index
#Count how many time steps there are, where individual's size is between min and max size of its size class range:
dev_time_juvII <- sapply(development.df_juvII, function(col){
BrownShrimp::count_devDays(col, juvII_min, juvII_max) } )
#With following plot, we know the shape of the curve (U shape. But inverted is again TPC)
#plot( (1:length(dev_time_juvII))*0.1, dev_time_juvII, main = "Development days Juvenile I \n min_size = 0.6 cm and max_size = 1 cm" )
plot( (1:length(dev_time_juvII))*0.1, 1/dev_time_juvII, main = "1/Development days Juvenile II \n min_size = 1 cm and max_size = 2 cm" )
lines(temperature_range, k_vals, col = 'red', lwd = 2)
legend("topright", legend = c('1/devTime', 'K_func_briere'), fill = c("black", "red"))
#Deleet values where there is no development i.e. when devTime = 1095
indexes_1095 <- which(dev_time_juvII == 1095)
dev_time_juvII_reduced <- dev_time_juvII[dev_time_juvII != 1095]
temperature_range_red_juvII <- temperature_range[-indexes_1095]
k_vals_reduced_juvII = k_vals[-indexes_1095]
devTime_juvII_inv_reduced = 1/dev_time_juvII_reduced
k_vals_reduced_juvII_inv = 1/k_vals_reduced_juvII
fit_juvII = lm(dev_time_juvII_reduced ~ k_vals_reduced_juvII_inv )
summary(fit_juvII)
plot( (1:length(dev_time_juvII))*0.1, dev_time_juvII, main = "Development days Juvenile II vs fit \n min_size = 1 cm and max_size = 2 cm" )
lines(temperature_range_red_juvII, predict(fit_juvII), col = 'red4', lwd = 2)
legend("topright", legend = c('1/devTime', 'K_func_briere'), fill = c("black", "red4"))
#### JUV III ####
development.df_juvIII <- data.frame(row = seq(1, 1095))
#simulate development with constant temperature for each 0.1°C & store results columns wise in the df:
for (i in temperature_range){
development <- c()
initial_l <- 2 #cm
for (j in time_range){
growth = lengthGrowth_funcTime(initial_l, j ,i , "F")
#initial_l = growth #+  L_init
development = append(development, growth)
}
development.df_juvIII[as.character(i)] <- development
}
development.df_juvIII = development.df_juvIII[ , !(names(development.df_juvIII) == "row")] #delete first column with timesteps, same as index
#Count how many time steps there are, where individual's size is between min and max size of its size class range:
dev_time_juvIII <- sapply(development.df_juvIII, function(col){
BrownShrimp::count_devDays(col, juvIII_min, juvIII_max) } )
#With following plot, we know the shape of the curve (U shape. But inverted is again TPC)
plot( (1:length(dev_time_juvIII))*0.1, dev_time_juvIII, main = "Development days Juvenile III \n min_size = 0.6 cm and max_size = 1 cm" )
plot( (1:length(dev_time_juvIII))*0.1, 1/dev_time_juvIII, main = "1/Development days Juvenile III \n min_size = 2 cm and max_size = 3 cm" )
lines(temperature_range, k_vals, col = 'red', lwd = 2)
legend("topright", legend = c('1/devTime', 'K_func_briere'), fill = c("black", "red"))
#Deleet values where there is no development i.e. when devTime = 1095
indexes_1095 <- which(dev_time_juvIII == 1095)
dev_time_juvIII_reduced <- dev_time_juvIII[dev_time_juvIII != 1095]
temperature_range_red_juvIII <- temperature_range[-indexes_1095]
k_vals_reduced_juvIII = k_vals[-indexes_1095]
devTime_juvIII_inv_reduced = 1/dev_time_juvIII_reduced
k_vals_reduced_juvIII_inv = 1/k_vals_reduced_juvIII
fit_juvIII = lm(dev_time_juvIII_reduced ~ k_vals_reduced_juvIII_inv )
summary(fit_juvIII)
plot( (1:length(dev_time_juvIII))*0.1, dev_time_juvIII, main = "Development days Juvenile III vs fit \n min_size = 2 cm and max_size = 3 cm" )
lines(temperature_range_red_juvIII, predict(fit_juvIII), col = 'red4', lwd = 2)
legend("topright", legend = c('1/devTime', 'K_func_briere'), fill = c("black", "red4"))
#### JUV IV ####
development.df_juvIV <- data.frame(row = seq(1, 1095))
#simulate development with constant temperature for each 0.1°C & store results columns wise in the df:
for (i in temperature_range){
development <- c()
initial_l <- 3 #cm
for (j in time_range){
growth = lengthGrowth_funcTime(initial_l, j ,i , "F")
#initial_l = growth #+  L_init
development = append(development, growth)
}
development.df_juvIV[as.character(i)] <- development
}
development.df_juvIV = development.df_juvIV[ , !(names(development.df_juvIV) == "row")] #delete first column with timesteps, same as index
#Count how many time steps there are, where individual's size is between min and max size of its size class range:
dev_time_juvIV <- sapply(development.df_juvIV, function(col){
BrownShrimp::count_devDays(col, juvIV_min, juvIV_max) } )
#With following plot, we know the shape of the curve (U shape. But inverted is again TPC)
plot( (1:length(dev_time_juvIV))*0.1, dev_time_juvIV, main = "Development days Juvenile IV \n min_size = 3 cm and max_size = 4 cm" )
plot( (1:length(dev_time_juvIV))*0.1, 1/dev_time_juvIV, main = "1/Development days Juvenile IV \n min_size = 3 cm and max_size = 4 cm" )
lines(temperature_range, k_vals, col = 'red', lwd = 2)
legend("topright", legend = c('1/devTime', 'K_func_briere'), fill = c("black", "red"))
#Deleet values where there is no development i.e. when devTime = 1095
indexes_1095 <- which(dev_time_juvIV == 1095)
dev_time_juvIV_reduced <- dev_time_juvIV[dev_time_juvIV != 1095]
temperature_range_red_juvIV <- temperature_range[-indexes_1095]
k_vals_reduced_juvIV = k_vals[-indexes_1095]
devTime_juvIV_inv_reduced = 1/dev_time_juvIV_reduced
k_vals_reduced_juvIV_inv = 1/k_vals_reduced_juvIV
fit_juvIV = lm(dev_time_juvIV_reduced ~ k_vals_reduced_juvIV_inv )
summary(fit_juvIV)
plot( (1:length(dev_time_juvIV))*0.1, dev_time_juvIV, main = "Development days Juvenile IV vs fit \n min_size = 3 cm and max_size = 4 cm" )
lines(temperature_range_red_juvIV, predict(fit_juvIV), col = 'red4', lwd = 2)
legend("topright", legend = c('1/devTime', 'K_func_briere'), fill = c("black", "red4"))
#### JUV V ####
development.df_juvV <- data.frame(row = seq(1, 1095))
#simulate development with constant temperature for each 0.1°C & store results columns wise in the df:
for (i in temperature_range){
development <- c()
initial_l <- 4 #cm
for (j in time_range){
growth = lengthGrowth_funcTime(initial_l, j ,i , "F")
#initial_l = growth #+  L_init
development = append(development, growth)
}
development.df_juvV[as.character(i)] <- development
}
development.df_juvV = development.df_juvV[ , !(names(development.df_juvV) == "row")] #delete first column with timesteps, same as index
#Count how many time steps there are, where individual's size is between min and max size of its size class range:
dev_time_juvV <- sapply(development.df_juvV, function(col){
BrownShrimp::count_devDays(col, juvV_min, juvV_max) } )
#With following plot, we know the shape of the curve (U shape. But inverted is again TPC)
plot( (1:length(dev_time_juvV))*0.1, dev_time_juvV, main = "Development days Juvenile V \n min_size = 4 cm and max_size = 5 cm" )
plot( (1:length(dev_time_juvV))*0.1, 1/dev_time_juvV, main = "1/Development days Juvenile V \n min_size = 4 cm and max_size = 5 cm" )
lines(temperature_range, k_vals, col = 'red', lwd = 2)
legend("topright", legend = c('1/devTime', 'K_func_briere'), fill = c("black", "red"))
#Deleet values where there is no development i.e. when devTime = 1095
indexes_1095 <- which(dev_time_juvV == 1095)
dev_time_juvV_reduced <- dev_time_juvV[dev_time_juvV != 1095]
temperature_range_red_juvV <- temperature_range[-indexes_1095]
k_vals_reduced_juvV = k_vals[-indexes_1095]
devTime_juvV_inv_reduced = 1/dev_time_juvV_reduced
k_vals_reduced_juvV_inv = 1/k_vals_reduced_juvV
fit_juvV = lm(dev_time_juvV_reduced ~ k_vals_reduced_juvV_inv )
summary(fit_juvV)
plot( (1:length(dev_time_juvV))*0.1, dev_time_juvV, main = "Development days Juvenile V vs fit \n min_size = 4 cm and max_size = 5 cm" )
lines(temperature_range_red_juvV, predict(fit_juvV), col = 'red4', lwd = 2)
legend("topright", legend = c('1/devTime', 'K_func_briere'), fill = c("black", "red4"))
#### ADULT I####
development.df_aduI <- data.frame(row = seq(1, 1095))
#simulate development with constant temperature for each 0.1°C & store results columns wise in the df:
for (i in temperature_range){
development <- c()
initial_l <- 5 #cm
for (j in time_range){
growth = lengthGrowth_funcTime(initial_l, j ,i , "F")
#initial_l = growth #+  L_init
development = append(development, growth)
}
development.df_aduI[as.character(i)] <- development
}
development.df_aduI = development.df_aduI[ , !(names(development.df_aduI) == "row")] #delete first column with timesteps, same as index
#Count how many time steps there are, where individual's size is between min and max size of its size class range:
dev_time_aduI <- sapply(development.df_aduI, function(col){
BrownShrimp::count_devDays(col, adultI_min, adultI_max) } )
#With following plot, we know the shape of the curve (U shape. But inverted is again TPC)
plot( (1:length(dev_time_aduI))*0.1, dev_time_aduI, main = "Development days Adult I \n min_size = 5 cm and max_size = 6 cm" )
plot( (1:length(dev_time_aduI))*0.1, 1/dev_time_aduI, main = "1/Development days Adult I \n min_size = 5 cm and max_size = 6 cm" )
lines(temperature_range, k_vals, col = 'red', lwd = 2)
legend("topright", legend = c('1/devTime', 'K_func_briere'), fill = c("black", "red"))
#Deleet values where there is no development i.e. when devTime = 1095
indexes_1095 <- which(dev_time_aduI == 1095)
dev_time_aduI_reduced <- dev_time_aduI[dev_time_aduI != 1095]
temperature_range_red_aduI <- temperature_range[-indexes_1095]
k_vals_reduced_aduI = k_vals[-indexes_1095]
devTime_aduI_inv_reduced = 1/dev_time_aduI_reduced
k_vals_reduced_aduI_inv = 1/k_vals_reduced_aduI
fit_aduI = lm(dev_time_aduI_reduced ~ k_vals_reduced_aduI_inv )
summary(fit_aduI)
plot( (1:length(dev_time_aduI))*0.1, dev_time_aduI, main = "Development days Adult I vs fit \n min_size = 5 cm and max_size = 6 cm" )
lines(temperature_range_red_aduI, predict(fit_aduI), col = 'red4', lwd = 2)
legend("topright", legend = c('1/devTime', 'K_func_briere'), fill = c("black", "red4"))
#### ADULT II####
development.df_aduII <- data.frame(row = seq(1, 1095))
#simulate development with constant temperature for each 0.1°C & store results columns wise in the df:
for (i in temperature_range){
development <- c()
initial_l <- 6 #cm
for (j in time_range){
growth = lengthGrowth_funcTime(initial_l, j ,i , "F")
#initial_l = growth #+  L_init
development = append(development, growth)
}
development.df_aduII[as.character(i)] <- development
}
development.df_aduII = development.df_aduII[ , !(names(development.df_aduII) == "row")] #delete first column with timesteps, same as index
#Count how many time steps there are, where individual's size is between min and max size of its size class range:
dev_time_aduII <- sapply(development.df_aduII, function(col){
BrownShrimp::count_devDays(col, adultII_min, adultII_max) } )
#With following plot, we know the shape of the curve (U shape. But inverted is again TPC)
plot( (1:length(dev_time_aduII))*0.1, dev_time_aduII, main = "Development days Adult II \n min_size = 6 cm and max_size = 7 cm" )
plot( (1:length(dev_time_aduII))*0.1, 1/dev_time_aduII, main = "1/Development days Adult II \n min_size = 6 cm and max_size = 7 cm" )
lines(temperature_range, k_vals, col = 'red', lwd = 2)
legend("topright", legend = c('1/devTime', 'K_func_briere'), fill = c("black", "red"))
#Deleet values where there is no development i.e. when devTime = 1095
indexes_1095 <- which(dev_time_aduII == 1095)
dev_time_aduII_reduced <- dev_time_aduII[dev_time_aduII != 1095]
temperature_range_red_aduII <- temperature_range[-indexes_1095]
k_vals_reduced_aduII = k_vals[-indexes_1095]
devTime_aduII_inv_reduced = 1/dev_time_aduII_reduced
k_vals_reduced_aduII_inv = 1/k_vals_reduced_aduII
fit_aduII = lm(dev_time_aduII_reduced ~ k_vals_reduced_aduII_inv )
summary(fit_aduII)
plot( (1:length(dev_time_aduII))*0.1, dev_time_aduII, main = "Development days Adult II vs fit \n min_size = 6 cm and max_size = 7 cm" )
lines(temperature_range_red_aduII, predict(fit_aduII), col = 'red4', lwd = 2)
legend("topright", legend = c('1/devTime', 'K_func_briere'), fill = c("black", "red4"))
#### FITS SUMMARY  ####
intercepts = c(coef(fit_JuvI)[1], coef(fit_juvII)[1], coef(fit_juvIII)[1], coef(fit_juvIV)[1], coef(fit_juvV)[1], coef(fit_aduI)[1], coef(fit_aduII)[1])
factors = c(coef(fit_JuvI)[2], coef(fit_juvII)[2], coef(fit_juvIII)[2], coef(fit_juvIV)[2], coef(fit_juvV)[2], coef(fit_aduI)[2], coef(fit_aduII)[2])
sizeClass_means_reduced = sizeClass_means[1:length(sizeClass_means)-1]
fits_df = data.frame( row.names = sizeClass_names[1:length(sizeClass_names)-1], intercept = intercepts, factor = factors)
View(fits_df)
mean_intercept = mean(fits_df$intercept)
#OR linear regression
fit_intercepts = lm(fits_df$intercept ~ sizeClass_means_reduced)
summary(fit_intercepts)
fit_factortsLog = lm(logy ~ logx)
logx = log(sizeClass_means_reduced)
logy = log(fits_df$factor)
fit_factortsLog = lm(logy ~ logx)
summary(fit_factortsLog)
log_a <- coef(fit_factortsLog)[1]
b_est <- coef(fit_factortsLog)[2]
a_est <- exp(log_a)
growth_optionB_t = function(L_mean, temperature, sex, range_diff){
intercept = -0.5056125 * range_diff#-0.522060 + L_mean*0.006774
factor = a_est* L_mean^b_est * range_diff# a=  0.03155726, b= 0.8109572
k = K_func_briere(temperature)
return(1/ (intercept + factor*(1/k)) )
}
range_diffs = c(juvI_max-juvI_min, juvII_max-juvII_min, juvIII_max-juvIII_min, juvIV_max-juvIV_min, juvV_max-juvV_min,
adultI_max-adultI_min, adultII_max-adultII_min )
par(mfrow = c(3, 3), mar = c(4, 4, 2, 1))
ind = 1
for (i in sizeClass_names){
plot(temperature_range,  1 / (fits_df[i, 'intercept'] + fits_df[i, 'factor']*(1/k_vals) ),
main = paste('growth', i ,'vs function'), ylim = c(0, 0.6), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, sapply(temperature_range, growth_optionB_t, L_mean = sizeClass_means[ind], sex='F', range_diff = range_diffs[ind] ) , col = 'red3' , lwd = 1.8)
ind = ind + 1
}
plot.new()  # empty plot
legend("center", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
growth_optionA_t = function(L_mean, temperature, sex){
intercept = -0.4968367 #-0.522060 + L_mean*0.006774
#factor = 0.022447 * exp(0.306237 * L_mean) #0.06734 * exp(0.30622*L_mean)
factor = a_est * L_mean^b_est #0.06734 * exp(0.30622*L_mean)#new with power law fit
k = K_func_briere(temperature)
return(1/ (intercept + factor*(1/k)) )
}
par(mfrow = c(3, 3), mar = c(4, 4, 2, 1))
ind = 1
for (i in sizeClass_names){
plot(temperature_range,  1 / (fits_df[i, 'intercept'] + fits_df[i, 'factor']*(1/k_vals) ),
main = paste('growth', i ,'vs function'), ylim = c(0, 0.6), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, sapply(temperature_range, growth_optionA_t, L_mean = sizeClass_means[ind], sex='F' ) , col = 'red3' , lwd = 1.8)
ind = ind + 1
}
plot.new()  # empty plot
legend("center", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
plot(temperature_range,  1 / (fits_df['LJ', 'intercept'] + fits_df['LJ', 'factor']*(1/k_vals) ),
main = paste('growth', i ,'vs function'), ylim = c(0, 0.6), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
b_est <- coef(fit_factortsLog)[2]
a_est <- exp(log_a)
a_est
b_est
summary(fit_intercepts)
growth_optionA_t = function(L_mean, temperature, sex){
intercept = -0.479210 + -0.004975*L_mean  #-0.4968367 #-0.522060 + L_mean*0.006774
#factor = 0.022447 * exp(0.306237 * L_mean) #0.06734 * exp(0.30622*L_mean)
factor = a_est * L_mean^b_est #0.06734 * exp(0.30622*L_mean)#new with power law fit
k = K_func_briere(temperature)
return(1/ (intercept + factor*(1/k)) )
}
par(mfrow = c(3, 3), mar = c(4, 4, 2, 1))
ind = 1
for (i in sizeClass_names){
plot(temperature_range,  1 / (fits_df[i, 'intercept'] + fits_df[i, 'factor']*(1/k_vals) ),
main = paste('growth', i ,'vs function'), ylim = c(0, 0.6), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, sapply(temperature_range, growth_optionA_t, L_mean = sizeClass_means[ind], sex='F' ) , col = 'red3' , lwd = 1.8)
ind = ind + 1
}
plot.new()  # empty plot
legend("center", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
mean_intercept
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library("colorspace")
library(deSolve)
library(tidyr)
library(RColorBrewer)
library(BrownShrimp)
library(viridis)
library(devtools)
#UPLOAD TEMPERATURE DATA
temperature_dataSet <- read.csv("C:/Users/andre/Desktop/Hereon/Data/Wadden Sea, Penning/Temperature_data_1982-2018_MarBiol.csv", header = TRUE, sep = ';')
temperature_95_96 <- temperature_func(temperature_dataSet, "01/01/1995", "31/12/1996")
temperature_10_11 <- temperature_func(temperature_dataSet, "01/01/2010", "31/12/2011")
temperature_10_14 <- temperature_func(temperature_dataSet, "01/01/2010", "31/12/2014")
L_as_F <- 85
juvI_min <- 6
juvI_max <- 10
juvII_min  <- 10
juvII_max <- 20
juvIII_min  <- 20
juvIII_max <- 30
juvIV_min  <- 30
juvIV_max <- 40
juvV_min  <- 40
juvV_max <- 50
adultI_min <- 50
adultI_max <- 70
adultII_min <- 70
adultII_max <- L_as_F
LL = 0.3
LJ = (juvI_min+juvI_max)/2 #cm
LJ2 = (juvII_min+juvII_max)/2 /10  # 3cm
LJ3 = (juvIII_min+juvIII_max)/2 /10
LJ4 = (juvIV_min+juvIV_max)/2 /10
LJ5 = (juvV_min+juvV_max)/2 /10
LA1 = (adultI_min + adultI_max)/2 /10
LA2 = (adultII_min + adultII_max)/2 /10 #cm
time_range <- seq(1,1095)
temperature_range <- seq(0,25, 0.1) #(10,15)
t = seq(0,length(temperature_10_11$temperature)-0.1, by = 0.1)
t_5years = seq(0,length(temperature_10_14$temperature)-0.1, by = 0.1)
state = c(P = 2, E = 0.1, L= 0.4 , J = .4 , J2 = 0.3, J3 = 0.3, J4 = 0.2, J5 = 0.2, A1 = 0.35, A2 = 0.1)
#state = c(P = 100, E = 2, L= 40 , J = 70 , J2 = 50, A2 = 40)
parameters = c()
state2 <- c(P = 2, E = 0.1, L= 0.4 , J = .175 , J2 = 0.125, J3 = 0.125, J4 = 0.1, J5 = 0.1, A1 = 0.35, A2 = 0.1)
start <- Sys.time()
cc_2 <- solver_sizeClass_extended(t = t_5years, state = state2, parameters = parameters, temperature_10_14)
print(Sys.time() - start)
start_date <- as.POSIXct("2010-01-01", format="%Y-%m-%d", tz = "UTC")
cc_2 <- mutate(cc_2, dateTime = start_date + cc_2$time * 86400) #86400 seconds in one day
cc_2 <- cc_2[ , -1] # delete timesteps column
#cc_long_2 <- gather(cc_2, key = "Type", value = "Value", P, E, L, J, J2, J3, J4, J5, A1, A2)
cc_2_long <- cc_2 %>%
pivot_longer(-dateTime, names_to = "variable", values_to = "value")
ggplot(cc_2_long, aes(x = dateTime, y = value, color = variable)) +
geom_line(size = 1) +  # Plot lines
labs(title = " extended size classes aprox. each 10 mm \n 2010-2014 ", x = "Days", y = "Biomass") +
scale_color_manual(
values = c( "P" = "#d9f0a3", "E"= "#1c9099" ,"L" = "gray"  ,"J" = "#bfd3e6", "J2" = "#9ebcda", "J3" = "#8c96c6", "J4" = "#8856a7", "J5" = "#810f7c" ,
"A1" = "#fd8d3c" ,"A2" = "#e6550d" )) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), # Center title
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.position="bottom") + ylim(0,20)
#HERE SIMULATIONS WITH NEW K-FUNC tpc FLEXBRIERE
library(dplyr)
library(ggplot2)
#library(cowplot) #for combined plots
library(RColorBrewer)
library("colorspace")
library(deSolve)
library(tidyr)
library(RColorBrewer)
library(BrownShrimp)
library(viridis)
library(devtools)
#UPLOAD TEMPERATURE DATA
temperature_dataSet <- read.csv("C:/Users/andre/Desktop/Hereon/Data/Wadden Sea, Penning/Temperature_data_1982-2018_MarBiol.csv", header = TRUE, sep = ';')
temperature_10_11 <- temperature_func(temperature_dataSet, "01/01/2010", "31/12/2011")
temperature_10_14 <- temperature_func(temperature_dataSet, "01/01/2010", "31/12/2014")
######### START ###########
#Def. Size Classes ranges [cm]
L_as_F <- 8.5
juvI_min <- .6
juvI_max <- 1.0
juvII_min  <- 1.0
juvII_max <- 2.0
juvIII_min  <- 2.0
juvIII_max <- 3.0
juvIV_min  <- 3.0
juvIV_max <- 4.0
juvV_min  <- 4.0
juvV_max <- 5.0
adultI_min <- 5.0
adultI_max <- 7.0
adultII_min <- 7.0
adultII_max <- L_as_F
LL = 0.3
LJ = (juvI_min+juvI_max)/2 #cm
LJ2 = (juvII_min+juvII_max)/2   # 3cm
LJ3 = (juvIII_min+juvIII_max)/2
LJ4 = (juvIV_min+juvIV_max)/2
LJ5 = (juvV_min+juvV_max)/2
LA1 = (adultI_min + adultI_max)/2
LA2 = (adultII_min + adultII_max)/2  #cm
time_range <- seq(1,1095) #3 years
temperature_range <- seq(0,30, 0.1) #(10,15)
development_df_juvI <- data.frame(row = seq(1, 1095))
the.method = 'rk4'
h = 0.2 # half saturatuion constant original aprox .5
L_inf = 8.5
epsilon = 0.22
m = 3
const_c = 0.01 # reference density g/cm3
state2 <- c(P = 2, E = 0.1, L= 0.4 , J = .175 , J2 = 0.125, J3 = 0.125, J4 = 0.1, J5 = 0.1, A1 = 0.35, A2 = 0.1)
t = seq(0,length(temperature_10_11$temperature)-0.1, by = 0.1)
t_5years = seq(0,length(temperature_10_14$temperature)-0.1, by = 0.1)
parameters = c()
start <- Sys.time()
test_briere <- solver_sizeClass_extended_b(t = t_5years, state = state2, parameters = parameters, temperature_10_14)
print(Sys.time() - start)
start_date <- as.POSIXct("2010-01-01", format="%Y-%m-%d", tz = "UTC")
test_briere <- mutate(test_briere, dateTime = start_date + test_briere$time * 86400) #86400 seconds in one day
test_briere <- test_briere[ , -1] # delete timesteps column
#cc_long_2 <- gather(cc_2, key = "Type", value = "Value", P, E, L, J, J2, J3, J4, J5, A1, A2)
test_briere_long <- test_briere %>%
pivot_longer(-dateTime, names_to = "variable", values_to = "value")
#dev.off()
ggplot(test_briere_long, aes(x = dateTime, y = value, color = variable)) +
geom_line(size = 1) +  # Plot lines
labs(title = " extended size classes Briere aprox. each 10 mm \n 2010-2014", x = "Days", y = "Biomass") +
scale_color_manual(
values = c( "P" = "#d9f0a3", "E"= "#1c9099" ,"L" = "gray"  ,"J" = "#bfd3e6", "J2" = "#9ebcda", "J3" = "#8c96c6", "J4" = "#8856a7", "J5" = "#810f7c" ,
"A1" = "#fd8d3c" ,"A2" = "#e6550d" )) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), # Center title
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.position="bottom") + ylim(0,52)
df_long_testBriere <- test_briere[ , -1] %>% #delete  plancton col
pivot_longer(-dateTime, names_to = "variable", values_to = "value")
#ensure that vertical order is same as life stages
stack_order_Br <- rev(c(colnames(test_briere)[2:10]) )
# Ensure 'variable' is a factor with levels in the same order
df_long_testBriere$variable <- factor(df_long_testBriere$variable, levels = stack_order_Br)
ggplot(df_long_testBriere, aes(x = dateTime, y = value, fill = variable)) +
geom_area() +
scale_fill_viridis_d() +
labs(
title = "K func as TPC",
x = "Date",
y = "Biomass",
fill = "Size class"
)
