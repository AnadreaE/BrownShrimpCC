week = isoweek(dateTime)  # or week(dateTime), depending on your preference
) %>%
group_by(year, week) %>%
summarise(avg_L = mean(L_avg, na.rm = TRUE), avg_B = mean(ttlB, na.rm = TRUE), .groups = "drop")
weekly_avg_fish_stPred  <- Lavg_fishery_stPred %>%
mutate(
year = year(dateTime),
week = isoweek(dateTime)  # or week(dateTime), depending on your preference
) %>%
group_by(year, week) %>%
summarise(avg_L = mean(L_avg, na.rm = TRUE), avg_B = mean(ttlB, na.rm = TRUE), .groups = "drop")
weekly_avg_pred_stPred  <- Lavg_pred_stPred %>%
mutate(
year = year(dateTime),
week = isoweek(dateTime)  # or week(dateTime), depending on your preference
) %>%
group_by(year, week) %>%
summarise(avg_L = mean(L_avg, na.rm = TRUE), avg_B = mean(ttlB, na.rm = TRUE), .groups = "drop")
weekly_avg_both_stPred  <- Lavg_bothPF_stPred %>%
mutate(
year = year(dateTime),
week = isoweek(dateTime)  # or week(dateTime), depending on your preference
) %>%
group_by(year, week) %>%
summarise(avg_L = mean(L_avg, na.rm = TRUE), avg_B = mean(ttlB, na.rm = TRUE), .groups = "drop")
init15 = as.POSIXct("2015-01-01", format="%Y-%m-%d", tz = "UTC")
end15 = as.POSIXct("2015-12-31", format="%Y-%m-%d", tz = "UTC")
plot(weekly_avg_noPreasure_stPred$avg_L[weekly_avg_noPreasure_stPred$year == 2015], weekly_avg_noPreasure_stPred$avg_B[weekly_avg_noPreasure_stPred$year == 2015],
lwd = 3, col = 'grey', lty=1, ylim = c(15,750), xlim = c(2.5, 5) )
points(weekly_avg_fish_stPred$avg_L[weekly_avg_fish_stPred$year == 2015], weekly_avg_fish_stPred$avg_B[weekly_avg_fish_stPred$year == 2015], lwd = 2, col ='skyblue4' )
points(weekly_avg_pred_stPred$avg_L[weekly_avg_pred_stPred$year == 2015], weekly_avg_pred_stPred$avg_B[weekly_avg_pred_stPred$year == 2015], lwd = 2, col ='indianred3' )
points(weekly_avg_both_stPred$avg_L[weekly_avg_both_stPred$year == 2015], weekly_avg_both_stPred$avg_B[weekly_avg_pred_stPred$year == 2015], lwd = 2, col= 'hotpink' )
legend("topleft", legend = c('no preasure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', 'indianred3', 'skyblue4','hotpink'), border = NA, bty = "n", y.intersp = 0.7)
#read Ble data
ble_data = read.csv("./data/BLE_Inlandslandungen_SpeiseKrabbe.csv", sep = ';')
#read Ble data
ble_data = read.csv("./data/BLE_Inlandslandungen_SpeiseKrabbe.csv", sep = ';')
#read Ble data
ble_data = read.csv("./data/BLE_Inlandslandungen_SpeiseKrabbe.csv", sep = ';')
#read Ble data
ble_data = read.csv("./data/BLE_Inlandslandungen_SpeiseKrabbe.csv", sep = ';')
View(ble_data)
plot(ble_data$year, ble_data$t)
plot(ble_data$year, ble_data$t, type = l)
plot(ble_data$year, ble_data$t, type = 'l')
plot(ble_data$year, ble_data$t, type = 'b')
plot(ble_data$year[ble_data$year==2015], ble_data$t, type = 'b')
#read Ble data
ble_data = read.csv("./data/BLE_Inlandslandungen_SpeiseKrabbe.csv", sep = ';')
plot(ble_data$year[ble_data$year==2015], ble_data$t, type = 'b')
plot(ble_data$year[ble_data$year==2015], ble_data$t[ble_data$year==2015], type = 'b')
#read Ble data
ble_data = read.csv("./data/BLE_Inlandslandungen_SpeiseKrabbe.csv", sep = ';')
plot(ble_data$year[ble_data$year==2015], ble_data$t[ble_data$year==2015], type = 'b')
plot(ble_data$month[ble_data$year==2015], ble_data$t[ble_data$year==2015], type = 'b')
#read Ble data
ble_data = read.csv("./data/BLE_Inlandslandungen_SpeiseKrabbe.csv", sep = ';')
plot(ble_data$month[ble_data$year==2015], ble_data$t[ble_data$year==2015], type = 'b')
plot(ble_data$month, ble_data$t, type = 'b')
plot(ble_data$year, ble_data$t, type = 'b')
plot(ble_data$year[ble_data$year<=2015], ble_data$t[ble_data$year<=2015], type = 'b',
main = 'Landings before mesh size regulation', xlab = 'Date', ylab = 'landings [tones]')
par(mfrow = c(1,2))
plot(ble_data$year[ble_data$year<=2015], ble_data$t[ble_data$year<=2015], type = 'b',
main = 'Landings before mesh size regulation', xlab = 'Date', ylab = 'landings [tones]')
plot(ble_data$year[ble_data$year>2015], ble_data$t[ble_data$year>2015], type = 'b',
main = 'Landings after mesh size regulation', xlab = 'Date', ylab = 'landings [tones]')
par(mfrow = c(2,1))
plot(ble_data$year[ble_data$year<=2015], ble_data$t[ble_data$year<=2015], type = 'b',
main = 'Landings before mesh size regulation', xlab = 'Date', ylab = 'landings [tones]')
plot(ble_data$year[ble_data$year>2015], ble_data$t[ble_data$year>2015], type = 'b',
main = 'Landings after mesh size regulation', xlab = 'Date', ylab = 'landings [tones]')
par(mfrow = c(2,1))
plot(ble_data$year[ble_data$year<=2015], ble_data$t[ble_data$year<=2015], type = 'l',
main = 'Landings before mesh size regulation', xlab = 'Date', ylab = 'landings [tones]')
plot(ble_data$year[ble_data$year>2015], ble_data$t[ble_data$year>2015], type = 'l',
main = 'Landings after mesh size regulation', xlab = 'Date', ylab = 'landings [tones]')
par(mfrow = c(2,1))
plot(ble_data$year[ble_data$year<=2015 & ble_data$year>2013 ], ble_data$t[ble_data$year<=2015 & ble_data$year>2013], type = 'l',
main = 'Landings before mesh size regulation', xlab = 'Date', ylab = 'landings [tones]')
par(mfrow = c(2,1))
plot(ble_data$year[ble_data$year<=2015 & ble_data$year>=2013 ], ble_data$t[ble_data$year<=2015 & ble_data$year>=2013], type = 'l',
main = 'Landings before mesh size regulation', xlab = 'Date', ylab = 'landings [tones]')
plot(ble_data$year[ble_data$year>2015], ble_data$t[ble_data$year>2015], type = 'l',
main = 'Landings after mesh size regulation', xlab = 'Date', ylab = 'landings [tones]')
par(mfrow = c(2,1))
plot(ble_data$year[ble_data$year<=2015 & ble_data$year>=2013 ], ble_data$t[ble_data$year<=2015 & ble_data$year>=2013], type = 'l',
main = 'Landings before mesh size regulation', xlab = 'Date', ylab = 'landings [tones]')
plot(ble_data$year[ble_data$year>2015 & ble_data$year<2021], ble_data$t[ble_data$year>2015 & ble_data$year<2021], type = 'l',
main = 'Landings after mesh size regulation', xlab = 'Date', ylab = 'landings [tones]')
par(mfrow = c(2,1))
plot(ble_data$year[ble_data$year<=2015 & ble_data$year>=2013 ], ble_data$t[ble_data$year<=2015 & ble_data$year>=2013], type = 'l',
main = 'Landings before mesh size regulation', xlab = 'Date', ylab = 'landings [tones]')
plot(ble_data$year[ble_data$year>2015 & ble_data$year<2018], ble_data$t[ble_data$year>2015 & ble_data$year<2018], type = 'l',
main = 'Landings after mesh size regulation', xlab = 'Date', ylab = 'landings [tones]')
par(mfrow = c(2,1))
plot(ble_data$year[ble_data$year<2016 & ble_data$year>=2013 ], ble_data$t[ble_data$year<2016 & ble_data$year>=2013], type = 'l',
main = 'Landings before mesh size regulation', xlab = 'Date', ylab = 'landings [tones]')
plot(ble_data$year[ble_data$year>2015 & ble_data$year<2018], ble_data$t[ble_data$year>2015 & ble_data$year<2018], type = 'l',
main = 'Landings after mesh size regulation', xlab = 'Date', ylab = 'landings [tones]')
plot(ble_data$month[ble_data$year==2015], ble_data$t[ble_data$year==2015], type = 'b')
years = (2013, 2015, 2016, 2018)
years = c(2013, 2015, 2016, 2018)
par(mfrow = c(4,1))
for (i in years){
plot(ble_data$year[ble_data$year ==i ], ble_data$t[ble_data$year ==i ], type = 'l',
main = paste('Landings', i), xlab = 'Date', ylab = 'landings [tones]' )
}
years = c(2013, 2015, 2016, 2018)
par(mfrow = c(4,1))
for (i in years){
plot(ble_data$month[ble_data$year ==i ], ble_data$t[ble_data$year ==i ], type = 'l',
main = paste('Landings', i), xlab = 'Date', ylab = 'landings [tones]' )
}
years = c(2013, 2015, 2016, 2018)
par(mfrow = c(4,1))
for (i in years){
plot(ble_data$month[ble_data$year ==i ], ble_data$t[ble_data$year ==i ], type = 'b',
main = paste('Landings', i), xlab = 'Date', ylab = 'landings [tones]' )
}
cols =  brewer.pal(5,"Set3")
library(RColorBrewer)
cols =  brewer.pal(5,"Set3")
cols
years = c(2013, 2015, 2016, 2018, 2020)
cols =  brewer.pal(5,"Set3")
plot(ble_data$month[ble_data$year ==2013 ], ble_data$t[ble_data$year == 2013 ], type = 'b',
main = paste('Landings', i), xlab = 'Date', ylab = 'landings [tones]' , col = cols[1])
#par(mfrow = c(4,1))
for (i in 2:length(years)){
lines(ble_data$month[ble_data$year == years[i] ], ble_data$t[ble_data$year == years[i] ], type = 'b',
main = paste('Landings', i), xlab = 'Date', ylab = 'landings [tones]', col = cols[i] )
}
dev.off()
years = c(2013, 2015, 2016, 2018, 2020)
cols =  brewer.pal(5,"Set3")
#dev.off()
plot(ble_data$month[ble_data$year ==2013 ], ble_data$t[ble_data$year == 2013 ], type = 'b',
main = paste('Landings', i), xlab = 'Date', ylab = 'landings [tones]' , col = cols[1])
#par(mfrow = c(4,1))
for (i in 2:length(years)){
lines(ble_data$month[ble_data$year == years[i] ], ble_data$t[ble_data$year == years[i] ], type = 'b',
main = paste('Landings', i), xlab = 'Date', ylab = 'landings [tones]', col = cols[i] )
}
years = c(2013, 2015, 2016, 2018, 2020)
cols =  brewer.pal(5,"Set3")
#dev.off()
plot(ble_data$month[ble_data$year ==2013 ], ble_data$t[ble_data$year == 2013 ], type = 'b',
main = paste('Landings', i), xlab = 'Date', ylab = 'landings [tones]' , col = cols[1], xlim = (2100) )
cols =  brewer.pal(5,"Set3")
#dev.off()
plot(ble_data$month[ble_data$year ==2013 ], ble_data$t[ble_data$year == 2013 ], type = 'b',
main = paste('Landings', i), xlab = 'Date', ylab = 'landings [tones]' , col = cols[1], ylim = (2100) )
years = c(2013, 2015, 2016, 2018, 2020)
cols =  brewer.pal(5,"Set3")
#dev.off()
plot(ble_data$month[ble_data$year ==2013 ], ble_data$t[ble_data$year == 2013 ], type = 'b',
main = paste('Landings', i), xlab = 'Date', ylab = 'landings [tones]' , col = cols[1], ylim = c(0,2100) )
#par(mfrow = c(4,1))
for (i in 2:length(years)){
lines(ble_data$month[ble_data$year == years[i] ], ble_data$t[ble_data$year == years[i] ], type = 'b',
main = paste('Landings', i), xlab = 'Date', ylab = 'landings [tones]', col = cols[i] )
}
years = c(2013, 2015, 2016, 2018, 2020)
cols =  brewer.pal(5,"Set3")
#dev.off()
plot(ble_data$month[ble_data$year ==2013 ], ble_data$t[ble_data$year == 2013 ], type = 'b',
main = paste('Landings', i), xlab = 'Date', ylab = 'landings [tones]' , col = cols[1], ylim = c(0,2200) )
#par(mfrow = c(4,1))
for (i in 2:length(years)){
lines(ble_data$month[ble_data$year == years[i] ], ble_data$t[ble_data$year == years[i] ], type = 'b',
main = paste('Landings', i), xlab = 'Date', ylab = 'landings [tones]', col = cols[i] )
}
years = c(2013, 2015, 2016, 2018, 2020)
cols =  brewer.pal(5,"Set3")
#dev.off()
plot(ble_data$month[ble_data$year ==2013 ], ble_data$t[ble_data$year == 2013 ], type = 'b',
main = paste('Landings', i), xlab = 'Date', ylab = 'landings [tones]' , col = cols[1],
ylim = c(0,2200), xlim = c(0,12) )
#par(mfrow = c(4,1))
for (i in 2:length(years)){
lines(ble_data$month[ble_data$year == years[i] ], ble_data$t[ble_data$year == years[i] ], type = 'b',
main = paste('Landings', i), xlab = 'Date', ylab = 'landings [tones]', col = cols[i] )
}
?legend
years = c(2013, 2015, 2016, 2018, 2020)
cols =  brewer.pal(5,"Set3")
#dev.off()
plot(ble_data$month[ble_data$year ==2013 ], ble_data$t[ble_data$year == 2013 ], type = 'b',
main = paste('Landings', i), xlab = 'Date', ylab = 'landings [tones]' , col = cols[1],
ylim = c(0,2200), xlim = c(0,12), lwd = 2 )
#par(mfrow = c(4,1))
for (i in 2:length(years)){
lines(ble_data$month[ble_data$year == years[i] ], ble_data$t[ble_data$year == years[i] ], type = 'b',
main = paste('Landings', i), xlab = 'Date', ylab = 'landings [tones]', col = cols[i] , lwd = 2)
}
legend('topleft', legend = as.character(years), col = cols)
legend('topleft', legend = as.character(years), fill = cols)
years = c(2013, 2015, 2016, 2018, 2020)
cols =  brewer.pal(5,"Dark2")
#dev.off()
plot(ble_data$month[ble_data$year ==2013 ], ble_data$t[ble_data$year == 2013 ], type = 'b',
main = paste('Landings', i), xlab = 'Date', ylab = 'landings [tones]' , col = cols[1],
ylim = c(0,2200), xlim = c(0,12), lwd = 2 )
#par(mfrow = c(4,1))
for (i in 2:length(years)){
lines(ble_data$month[ble_data$year == years[i] ], ble_data$t[ble_data$year == years[i] ], type = 'b',
main = paste('Landings', i), xlab = 'Date', ylab = 'landings [tones]', col = cols[i] , lwd = 2)
}
legend('topleft', legend = as.character(years), fill = cols)
landings_january_avg = mean(ble_data$t[ble_data$month ==1])
landings_january_avg
ble_data$t[ble_data$month ==1 & ble_data$year ==2015]
ble_data$t[ble_data$month ==1 & ble_data$year ==2016]
ble_data$t[ble_data$month ==1 & ble_data$year ==2018]
ble_data$t[ble_data$month ==1 & ble_data$year ==2010]
ble_data$t[ble_data$month ==1 & ble_data$year ==2009]
ble_data$t[ble_data$month ==1 & ble_data$year ==2020]
ble_data$t[ble_data$month ==1 & ble_data$year ==2016]
ble_data$t[ble_data$month ==1 & ble_data$year ==2025]
library(ggplot2)
library(deSolve)
library(RColorBrewer)
library(BrownShrimp)
library(viridis)
library(dplyr)
library(tidyr)
library("colorspace")
library(lubridate)
library(latex2exp)
library(profvis)
#library(devtools)
#UPLOAD TEMPERATURE DATA
temperature_dataSet <- read.csv("./data/Temperature_data_1982-2018_MarBiol.csv", header = TRUE, sep = ';')
temperature_14_18 <- temperature_func(temperature_dataSet, "01/01/2014", "31/12/2018")
t_5years = seq(0,length(temperature_14_18$temperature)-0.1)
state_r = c(P = 2, E = 0.1, L= 0.0928 *1.5 ,
BF = BF+0.1, BM = BM+0.1,
Pred = 0.05 )
devtools::load_all(".")
state_r = c(P = 2, E = 0.1, L= 0.0928 *1.5 ,
BF = BF+0.1, BM = BM+0.1,
Pred = 0.05 )
bothPF_params = parameters_solv
bothPF_params$general_params$Fi = 0.025 #reduced fishery
start <- Sys.time()
test_bothFP <- solver_sizeClass.v4(t = t_5years, state = state_r, parameters = bothPF_params, temperature_dataSet = temperature_14_18)
print(Sys.time() - start)
#Plot size spectra
plot_sizeSpectra(test_bothFP, 2015, title = "F&P")
devtools::load_all(".")
library(ggplot2)
library(deSolve)
library(RColorBrewer)
library(BrownShrimp)
library(viridis)
library(dplyr)
library(tidyr)
library("colorspace")
library(lubridate)
library(latex2exp)
library(profvis)
#library(devtools)
#UPLOAD TEMPERATURE DATA
temperature_dataSet <- read.csv("./data/Temperature_data_1982-2018_MarBiol.csv", header = TRUE, sep = ';')
temperature_14_18 <- temperature_func(temperature_dataSet, "01/01/2014", "31/12/2018")
t_5years = seq(0,length(temperature_14_18$temperature)-0.1)
state_r = c(P = 2, E = 0.1, L= 0.0928 *1.5 ,
BF = BF+0.1, BM = BM+0.1,
Pred = 0.05 )
#### TEST (1 out of 4) WITHOUT ANY KIND OF PREASURE (P NEITHER F) ####
noPreasure_params = parameters_solv
noPreasure_params$general_params$Fi = 0 #No fishery
noPreasure_params$general_params$Imax_ik = 0 #No predation
start <- Sys.time()
test_noPreasure <- solver_sizeClass.v4(t = t_5years, state = state_r, parameters = noPreasure_params, temperature_dataSet = temperature_14_18)
print(Sys.time() - start)
#Plot size spectra
plot_sizeSpectra(test_noPreasure, 2015, title = "NP")
#### TEST (2 out of 4) ONLY PREDATION ####
pred_params = parameters_solv
pred_params$general_params$Fi = 0 #No fishery
start <- Sys.time()
test_predation <- solver_sizeClass.v4(t = t_5years, state = state_r, parameters = pred_params, temperature_dataSet = temperature_14_18)
print(Sys.time() - start)
#Plot size spectra
plot_sizeSpectra(test_predation, 2015, title = "Pred")
#### TEST (3 out of 4) ONLY FISHERY ####
fishery_params = parameters_solv
fishery_params$general_params$Imax_ik = 0 #No predation
fishery_params$general_params$Fi = 0.025 #reduced fishery
start <- Sys.time()
test_fishery <- solver_sizeClass.v4(t = t_5years, state = state_r, parameters = fishery_params, temperature_dataSet = temperature_14_18)
print(Sys.time() - start)
#Plot size spectra
plot_sizeSpectra(test_fishery, 2015, title = "Fi")
#### TEST (4 out of 4) PREDATION AND FISHERY####
bothPF_params = parameters_solv
bothPF_params$general_params$Fi = 0.025 #reduced fishery
start <- Sys.time()
test_bothFP <- solver_sizeClass.v4(t = t_5years, state = state_r, parameters = bothPF_params, temperature_dataSet = temperature_14_18)
print(Sys.time() - start)
#Plot size spectra
plot_sizeSpectra(test_bothFP, 2015, title = "F&P")
size_mean_F
sol_15_jan = sol_df %>%
filter(as.Date(sol_df$dateTime) > as.Date("31/12/2014", format= "%d/%m/%Y" ) &
as.Date(sol_df$dateTime) < as.Date("01/02/2014", format= "%d/%m/%Y") ) %>%
select(BF1, BF2, BF3, BF4, BF5, BF6, BF7, BF8, BM1, BM2, BM3, BM4, BM5)
sol_15_jan = test_bothFP %>%
filter(as.Date(sol_df$dateTime) > as.Date("31/12/2014", format= "%d/%m/%Y" ) &
as.Date(sol_df$dateTime) < as.Date("01/02/2014", format= "%d/%m/%Y") ) %>%
select(BF1, BF2, BF3, BF4, BF5, BF6, BF7, BF8, BM1, BM2, BM3, BM4, BM5)
sol_15_jan = test_bothFP %>%
filter(as.Date(test_bothFP$dateTime) > as.Date("31/12/2014", format= "%d/%m/%Y" ) &
as.Date(test_bothFP$dateTime) < as.Date("01/02/2014", format= "%d/%m/%Y") ) %>%
select(BF1, BF2, BF3, BF4, BF5, BF6, BF7, BF8, BM1, BM2, BM3, BM4, BM5)
cols <- c("f" = "#8856a7", "m" = "#add8e6")
class_labels <- c("BL1", "BL2", "BL3", "BL4", "BL5", "BL6", "BL7", "BL8")
label_map <- setNames(class_labels, class_labels)
# Set up 2x2 plot grid for 4 quarters
#par(mfrow = c(2, 2))
#for (q in 1:4) {
# Indices for quarter (912 time steps per quarter)
# init_idx <-  91.2 * (q - 1) + 1
#  final_idx <- 91.2 * q
#prepare quarterly data:
# quarter_data <- sol_df_year[init_idx:final_idx, ]
# 1. Extract female and male size class columns
female_cols <- paste0("BF", 1:8)
male_cols   <- paste0("BM", 1:5)
# 2. Compute means
f_means <- colMeans(sol_15_jan[, female_cols])
m_means <- colMeans(sol_15_jan[, male_cols])
# 3. Stackable part: BF1–BF5 with BM1–BM5
stack_classes <- paste0("BF", 1:5)
f_stack <- f_means[stack_classes]
m_stack <- m_means  # BM1–BM5 assumed to match BF1–BF5 by order
# 4. Non-stackable part: BF6–BF8 (females only)
f_extra_classes <- paste0("BF", 6:8)
f_extra <- f_means[f_extra_classes]
# 5. Construct matrix for barplot: one row per sex, one column per size class
# Columns: BF1–BF5 (stacked), BF6–BF8 (female only)
f_vals <- c(f_stack, f_extra)
m_vals <- c(m_stack, rep(0, length(f_extra)))  # No males for BF6–BF8
mat <- rbind("f" = f_vals, "m" = m_vals)
# Plot barplot V4 (background because B is higher)
barplot(
mat,
col = cols[rownames(mat)],
main = paste(title , "Q", q, "–", as.character(year)),
names.arg = label_map,
las = 2,
cex.main = 1.5,
cex.axis = 1.2,
cex.names = 1.2,
ylim = c(0, max(colSums(mat)) * 1.1),
space = 0,
beside = FALSE,
legend.text = rownames(mat),
args.legend = list(x = "topright", bty = "n", inset = 0.02, cex = 1)
)
barplot(
mat,
col = cols[rownames(mat)],
main = paste(title , "Q", q, "–", as.character(year)),
names.arg = label_map,
las = 2,
cex.main = 1.5,
cex.axis = 1.2,
cex.names = 1.2,
#ylim = c(0, max(colSums(mat)) * 1.1),
space = 0,
beside = FALSE,
legend.text = rownames(mat),
args.legend = list(x = "topright", bty = "n", inset = 0.02, cex = 1)
)
dev.off()
barplot(
mat,
col = cols[rownames(mat)],
main = paste(title , "Q", q, "–", as.character(year)),
names.arg = label_map,
las = 2,
cex.main = 1.5,
cex.axis = 1.2,
cex.names = 1.2,
#ylim = c(0, max(colSums(mat)) * 1.1),
space = 0,
beside = FALSE,
legend.text = rownames(mat),
args.legend = list(x = "topright", bty = "n", inset = 0.02, cex = 1)
)
View(sol_15_jan)
sol_15_jan = test_bothFP %>%
filter(as.Date(test_bothFP$dateTime) > as.Date("31/12/2014", format= "%d/%m/%Y" ) &
as.Date(test_bothFP$dateTime) < as.Date("01/02/2015", format= "%d/%m/%Y") ) %>%
select(BF1, BF2, BF3, BF4, BF5, BF6, BF7, BF8, BM1, BM2, BM3, BM4, BM5)
cols <- c("f" = "#8856a7", "m" = "#add8e6")
# Define size classes to include and their order
class_labels <- c("BL1", "BL2", "BL3", "BL4", "BL5", "BL6", "BL7", "BL8")
label_map <- setNames(class_labels, class_labels)
# Set up 2x2 plot grid for 4 quarters
#par(mfrow = c(2, 2))
#for (q in 1:4) {
# Indices for quarter (912 time steps per quarter)
# init_idx <-  91.2 * (q - 1) + 1
#  final_idx <- 91.2 * q
#prepare quarterly data:
# quarter_data <- sol_df_year[init_idx:final_idx, ]
# 1. Extract female and male size class columns
female_cols <- paste0("BF", 1:8)
male_cols   <- paste0("BM", 1:5)
# 2. Compute means
f_means <- colMeans(sol_15_jan[, female_cols])
m_means <- colMeans(sol_15_jan[, male_cols])
# 3. Stackable part: BF1–BF5 with BM1–BM5
stack_classes <- paste0("BF", 1:5)
f_stack <- f_means[stack_classes]
m_stack <- m_means  # BM1–BM5 assumed to match BF1–BF5 by order
# 4. Non-stackable part: BF6–BF8 (females only)
f_extra_classes <- paste0("BF", 6:8)
f_extra <- f_means[f_extra_classes]
# 5. Construct matrix for barplot: one row per sex, one column per size class
# Columns: BF1–BF5 (stacked), BF6–BF8 (female only)
f_vals <- c(f_stack, f_extra)
m_vals <- c(m_stack, rep(0, length(f_extra)))  # No males for BF6–BF8
mat <- rbind("f" = f_vals, "m" = m_vals)
# Plot barplot V4 (background because B is higher)
barplot(
mat,
col = cols[rownames(mat)],
main = paste(title , "Q", q, "–", as.character(year)),
names.arg = label_map,
las = 2,
cex.main = 1.5,
cex.axis = 1.2,
cex.names = 1.2,
#ylim = c(0, max(colSums(mat)) * 1.1),
space = 0,
beside = FALSE,
legend.text = rownames(mat),
args.legend = list(x = "topright", bty = "n", inset = 0.02, cex = 1)
)
?barplot
barplot(
mat,
col = cols[rownames(mat)],
main = paste("Size distribution in January"),
names.arg = label_map,
ylab = 'Biomass',
las = 2,
cex.main = 1.5,
cex.axis = 1.2,
cex.names = 1.2,
#ylim = c(0, max(colSums(mat)) * 1.1),
space = 0,
beside = FALSE,
legend.text = rownames(mat),
args.legend = list(x = "topright", bty = "n", inset = 0.02, cex = 1)
)
barplot(
mat,
col = cols[rownames(mat)],
main = paste("Size distribution in January"),
names.arg = label_map,
ylab = 'Biomass',
las = 2,
cex.main = 1.5,
cex.axis = 1.2,
cex.names = 1.2,
ylim = c(0,25),
space = 0,
beside = FALSE,
legend.text = rownames(mat),
args.legend = list(x = "topright", bty = "n", inset = 0.02, cex = 2)
)
barplot(
mat,
col = cols[rownames(mat)],
main = paste("Size distribution in January"),
names.arg = label_map,
ylab = 'Biomass',
las = 2,
cex.main = 1.5,
cex.axis = 1.2,
cex.names = 1.2,
cex.lab = 1.2,
ylim = c(0,25),
space = 0,
beside = FALSE,
legend.text = rownames(mat),
args.legend = list(x = "topright", bty = "n", inset = 0.02, cex = 2)
)
barplot(
mat,
col = cols[rownames(mat)],
main = paste("Size distribution in January"),
names.arg = label_map,
ylab = 'Biomass',
las = 2,
cex.main = 1.5,
cex.axis = 1.2,
cex.names = 1.2,
cex.lab = 1.5,
ylim = c(0,25),
space = 0,
beside = FALSE,
legend.text = rownames(mat),
args.legend = list(x = "topright", bty = "n", inset = 0.02, cex = 1.5)
)
