lines(temperature_range, 1/func_toPlot_adultI , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
par(mfrow = c(3,1))
#subplot 1
plot(temperature_range,  1 / (fits_df['LJ2', 'intercept'] + fits_df['LJ2', 'factor']*(1/k_vals) ),
main = 'growth JuvII vs function', ylim = c(0, 0.4), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, 1/func_toPlot , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"), cex = )
#subplot 2
plot(temperature_range,  1 / (fits_df['LJ4', 'intercept'] + fits_df['LJ4', 'factor']*(1/k_vals) ),
main = 'growth JuvIV vs function', ylim = c(0,  0.4), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, 1/func_toPlot_juvIV , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
#subplot 3
plot(temperature_range,  1 / (fits_df['LA1', 'intercept'] + fits_df['LA1', 'factor']*(1/k_vals) ),
main = 'growth AdulstI vs function', ylim = c(0,  0.4), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, 1/func_toPlot_adultI , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
plot(temperature_range,  1 / (fits_df['LJ2', 'intercept'] + fits_df['LJ2', 'factor']*(1/k_vals) ),
main = 'growth JuvII vs function', ylim = c(0, 0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, 1/func_toPlot , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"), cex = )
#subplot 2
plot(temperature_range,  1 / (fits_df['LJ4', 'intercept'] + fits_df['LJ4', 'factor']*(1/k_vals) ),
main = 'growth JuvIV vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, 1/func_toPlot_juvIV , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
#subplot 3
plot(temperature_range,  1 / (fits_df['LA1', 'intercept'] + fits_df['LA1', 'factor']*(1/k_vals) ),
main = 'growth AdulstI vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, 1/func_toPlot_adultI , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
par(mfrow = c(3,1))
#subplot 1
plot(temperature_range,  1 / (fits_df['LJ2', 'intercept'] + fits_df['LJ2', 'factor']*(1/k_vals) ),
main = 'growth JuvII vs function', ylim = c(0, 0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, 1/func_toPlot , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"), cex = )
#subplot 2
plot(temperature_range,  1 / (fits_df['LJ4', 'intercept'] + fits_df['LJ4', 'factor']*(1/k_vals) ),
main = 'growth JuvIV vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, 1/func_toPlot_juvIV , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
#subplot 3
plot(temperature_range,  1 / (fits_df['LA1', 'intercept'] + fits_df['LA1', 'factor']*(1/k_vals) ),
main = 'growth AdulstI vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, 1/func_toPlot_adultI , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
mean_intercept
growth_optionA = funciton(L_mean, temperature, sex){
growth_optionA = funciton(L_mean, temperature, sex){
growth_optionA = function(L_mean, temperature, sex){
intercept = -0.4968367 #-0.522060 + L_mean*0.006774
factor = 0.022447 * exp(0.306237 * L_mean) #0.06734 * exp(0.30622*L_mean)
k = K_func(temperature)
return(intercept + factor*k)
}
growth_optionA = function(L_mean, temperature, sex){
intercept = -0.4968367 #-0.522060 + L_mean*0.006774
factor = 0.022447 * exp(0.306237 * L_mean) #0.06734 * exp(0.30622*L_mean)
k = K_func(temperature)
return(intercept + factor*(1/k))
}
growth_optionA = function(L_mean, temperature, sex){
intercept = -0.4968367 #-0.522060 + L_mean*0.006774
factor = 0.022447 * exp(0.306237 * L_mean) #0.06734 * exp(0.30622*L_mean)
k = K_func(temperature)
return(1/ (intercept + factor*(1/k)) )
}
plot(temperature_range,  1 / (fits_df['LJ', 'intercept'] + fits_df['LJ', 'factor']*(1/k_vals) ),
main = 'growth JuvII vs function', ylim = c(0, 0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, growth_optionA(LJ, temperature_range, 'F') , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"), cex = )
dev.off()
plot(temperature_range,  1 / (fits_df['LJ', 'intercept'] + fits_df['LJ', 'factor']*(1/k_vals) ),
main = 'growth JuvII vs function', ylim = c(0, 0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, growth_optionA(LJ, temperature_range, 'F') , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"), cex = )
growth_optionA = function(L_mean, temperature, sex){
intercept = -0.4968367 #-0.522060 + L_mean*0.006774
factor = 0.022447 * exp(0.306237 * L_mean) #0.06734 * exp(0.30622*L_mean)
k = K_func(temperature)
return(1/ (intercept + factor*(1/k)) )
}
plot(temperature_range,  1 / (fits_df['LJ', 'intercept'] + fits_df['LJ', 'factor']*(1/k_vals) ),
main = 'growth JuvI vs function', ylim = c(0, 0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, growth_optionA(LJ, temperature_range, 'F') , col = 'red3' , lwd = 1.8)
plot(temperature_range,  1 / (fits_df['LJ', 'intercept'] + fits_df['LJ', 'factor']*(1/k_vals) ),
main = 'growth JuvI vs function', ylim = c(0, 0.4), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, growth_optionA(LJ, temperature_range, 'F') , col = 'red3' , lwd = 1.8)
plot(temperature_range,  1 / (fits_df['LJ2', 'intercept'] + fits_df['LJ2', 'factor']*(1/k_vals) ),
main = 'growth JuvI vs function', ylim = c(0, 0.4), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, growth_optionA(LJ2, temperature_range, 'F') , col = 'red3' , lwd = 1.8)
plot(1:length(sizeClass_names), fits_df$intercept)
abline(h= mean(fits_df$intercept), lty=2 )
lines(1:length(sizeClass_names), predict(fit_intercepts), col = 'orange3')
par(mfrow = c(3,2))
#subplot 1
plot(temperature_range,  1 / (fits_df['LJ', 'intercept'] + fits_df['LJ', 'factor']*(1/k_vals) ),
main = 'growth JuvII vs function', ylim = c(0, 0.4), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, growth_optionA(LJ, temperature_range, 'F') , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"), cex = )
#subplot 2
plot(temperature_range,  1 / (fits_df['LJ2', 'intercept'] + fits_df['LJ2', 'factor']*(1/k_vals) ),
main = 'growth JuvII vs function', ylim = c(0, 0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, 1/func_toPlot , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"), cex = )
#subplot 3
plot(temperature_range,  1 / (fits_df['LJ4', 'intercept'] + fits_df['LJ4', 'factor']*(1/k_vals) ),
main = 'growth JuvIV vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, growth_optionA(LJ4, temperature_range, 'F')  , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
#subplot 4
plot(temperature_range,  1 / (fits_df['LJ5', 'intercept'] + fits_df['LJ5', 'factor']*(1/k_vals) ),
main = 'growth AdulstI vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, growth_optionA(LJ5, temperature_range, 'F'), col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
#subplot 5
plot(temperature_range,  1 / (fits_df['LA1', 'intercept'] + fits_df['LA1', 'factor']*(1/k_vals) ),
main = 'growth AdulstI vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, 1/func_toPlot_adultI , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
#subplot 5
plot(temperature_range,  1 / (fits_df['LA2', 'intercept'] + fits_df['LA2', 'factor']*(1/k_vals) ),
main = 'growth AdulstI vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, growth_optionA(LA2, temperature_range, 'F'), col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
par(mfrow = c(3,2))
#subplot 1
plot(temperature_range,  1 / (fits_df['LJ', 'intercept'] + fits_df['LJ', 'factor']*(1/k_vals) ),
main = 'growth JuvII vs function', ylim = c(0, 0.5), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, growth_optionA(LJ, temperature_range, 'F') , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"), cex = )
#subplot 2
plot(temperature_range,  1 / (fits_df['LJ2', 'intercept'] + fits_df['LJ2', 'factor']*(1/k_vals) ),
main = 'growth JuvII vs function', ylim = c(0, 0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, 1/func_toPlot , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"), cex = )
#subplot 3
plot(temperature_range,  1 / (fits_df['LJ4', 'intercept'] + fits_df['LJ4', 'factor']*(1/k_vals) ),
main = 'growth JuvIV vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, growth_optionA(LJ4, temperature_range, 'F')  , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
#subplot 4
plot(temperature_range,  1 / (fits_df['LJ5', 'intercept'] + fits_df['LJ5', 'factor']*(1/k_vals) ),
main = 'growth AdulstI vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, growth_optionA(LJ5, temperature_range, 'F'), col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
#subplot 5
plot(temperature_range,  1 / (fits_df['LA1', 'intercept'] + fits_df['LA1', 'factor']*(1/k_vals) ),
main = 'growth AdulstI vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, 1/func_toPlot_adultI , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
#subplot 5
plot(temperature_range,  1 / (fits_df['LA2', 'intercept'] + fits_df['LA2', 'factor']*(1/k_vals) ),
main = 'growth AdulstI vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, growth_optionA(LA2, temperature_range, 'F'), col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
par(mfrow = c(3,2))
#subplot 1
plot(temperature_range,  1 / (fits_df['LJ', 'intercept'] + fits_df['LJ', 'factor']*(1/k_vals) ),
main = 'growth Juv I vs function', ylim = c(0, 0.5), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, growth_optionA(LJ, temperature_range, 'F') , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"), cex = )
#subplot 2
plot(temperature_range,  1 / (fits_df['LJ2', 'intercept'] + fits_df['LJ2', 'factor']*(1/k_vals) ),
main = 'growth Juv II vs function', ylim = c(0, 0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, 1/func_toPlot , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"), cex = )
#subplot 3
plot(temperature_range,  1 / (fits_df['LJ4', 'intercept'] + fits_df['LJ4', 'factor']*(1/k_vals) ),
main = 'growth Juv IV vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, growth_optionA(LJ4, temperature_range, 'F')  , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
#subplot 4
plot(temperature_range,  1 / (fits_df['LJ5', 'intercept'] + fits_df['LJ5', 'factor']*(1/k_vals) ),
main = 'growth Juv V vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, growth_optionA(LJ5, temperature_range, 'F'), col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
#subplot 5
plot(temperature_range,  1 / (fits_df['LA1', 'intercept'] + fits_df['LA1', 'factor']*(1/k_vals) ),
main = 'growth Adult I vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, growth_optionA(LA1, temperature_range, 'F') , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
#subplot 5
plot(temperature_range,  1 / (fits_df['LA2', 'intercept'] + fits_df['LA2', 'factor']*(1/k_vals) ),
main = 'growth Adult II vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, growth_optionA(LA2, temperature_range, 'F'), col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
par(mfrow = c(3,2))
#subplot 1
plot(temperature_range,  1 / (fits_df['LJ', 'intercept'] + fits_df['LJ', 'factor']*(1/k_vals) ),
main = 'growth Juv I vs function', ylim = c(0, 0.6), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, growth_optionA(LJ, temperature_range, 'F') , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"), cex = )
#subplot 2
plot(temperature_range,  1 / (fits_df['LJ2', 'intercept'] + fits_df['LJ2', 'factor']*(1/k_vals) ),
main = 'growth Juv II vs function', ylim = c(0, 0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, 1/func_toPlot , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"), cex = )
#subplot 3
plot(temperature_range,  1 / (fits_df['LJ4', 'intercept'] + fits_df['LJ4', 'factor']*(1/k_vals) ),
main = 'growth Juv IV vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, growth_optionA(LJ4, temperature_range, 'F')  , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
#subplot 4
plot(temperature_range,  1 / (fits_df['LJ5', 'intercept'] + fits_df['LJ5', 'factor']*(1/k_vals) ),
main = 'growth Juv V vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, growth_optionA(LJ5, temperature_range, 'F'), col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
#subplot 5
plot(temperature_range,  1 / (fits_df['LA1', 'intercept'] + fits_df['LA1', 'factor']*(1/k_vals) ),
main = 'growth Adult I vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, growth_optionA(LA1, temperature_range, 'F') , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
#subplot 5
plot(temperature_range,  1 / (fits_df['LA2', 'intercept'] + fits_df['LA2', 'factor']*(1/k_vals) ),
main = 'growth Adult II vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, growth_optionA(LA2, temperature_range, 'F'), col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
par(mfrow = c(3,2))
#subplot 1
plot(temperature_range,  1 / (fits_df['LJ', 'intercept'] + fits_df['LJ', 'factor']*(1/k_vals) ),
main = 'growth Juv I vs function', ylim = c(0, 0.6), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range, growth_optionA(LJ, temperature_range, 'F') , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"), cex = )
#subplot 2
plot(temperature_range,  1 / (fits_df['LJ2', 'intercept'] + fits_df['LJ2', 'factor']*(1/k_vals) ),
main = 'growth Juv II vs function', ylim = c(0, 0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5 )
lines(temperature_range,  growth_optionA(LJ2, temperature_range, 'F')  , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"), cex = )
#subplot 3
plot(temperature_range,  1 / (fits_df['LJ4', 'intercept'] + fits_df['LJ4', 'factor']*(1/k_vals) ),
main = 'growth Juv IV vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, growth_optionA(LJ4, temperature_range, 'F')  , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
#subplot 4
plot(temperature_range,  1 / (fits_df['LJ5', 'intercept'] + fits_df['LJ5', 'factor']*(1/k_vals) ),
main = 'growth Juv V vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, growth_optionA(LJ5, temperature_range, 'F'), col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
#subplot 5
plot(temperature_range,  1 / (fits_df['LA1', 'intercept'] + fits_df['LA1', 'factor']*(1/k_vals) ),
main = 'growth Adult I vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, growth_optionA(LA1, temperature_range, 'F') , col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
#subplot 5
plot(temperature_range,  1 / (fits_df['LA2', 'intercept'] + fits_df['LA2', 'factor']*(1/k_vals) ),
main = 'growth Adult II vs function', ylim = c(0,  0.28), ylab = "growth rate", las = 1, cex.main = 1.4, cex.lab = 1.3, cex.axis = 1.5)
lines(temperature_range, growth_optionA(LA2, temperature_range, 'F'), col = 'red3' , lwd = 1.8)
legend("topright", legend = c('1/devTime', 'growth function'), fill = c("black", "red3"))
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library("colorspace")
library(deSolve)
library(tidyr)
library(RColorBrewer)
library(BrownShrimp)
library(viridis)
library(devtools)
#UPLOAD TEMPERATURE DATA
temperature_dataSet <- read.csv("C:/Users/andre/Desktop/Hereon/Data/Wadden Sea, Penning/Temperature_data_1982-2018_MarBiol.csv", header = TRUE, sep = ';')
temperature_95_96 <- temperature_func(temperature_dataSet, "01/01/1995", "31/12/1996")
temperature_10_11 <- temperature_func(temperature_dataSet, "01/01/2010", "31/12/2011")
temperature_10_14 <- temperature_func(temperature_dataSet, "01/01/2010", "31/12/2014")
######### START ###########
#Def. Size Classes ranges
L_as_F <- 85
juvI_min <- 6
juvI_max <- 10
juvII_min  <- 10
juvII_max <- 20
juvIII_min  <- 20
juvIII_max <- 30
juvIV_min  <- 30
juvIV_max <- 40
juvV_min  <- 40
juvV_max <- 50
adultI_min <- 50
adultI_max <- 70
adultII_min <- 70
adultII_max <- L_as_F
LL = 0.3
LJ = (juvI_min+juvI_max)/2 #cm
LJ2 = (juvII_min+juvII_max)/2 /10  # 3cm
LJ3 = (juvIII_min+juvIII_max)/2 /10
LJ4 = (juvIV_min+juvIV_max)/2 /10
LJ5 = (juvV_min+juvV_max)/2 /10
LA1 = (adultI_min + adultI_max)/2 /10
LA2 = (adultII_min + adultII_max)/2 /10 #cm
time_range <- seq(1,1095)
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library("colorspace")
library(deSolve)
library(tidyr)
library(RColorBrewer)
library(BrownShrimp)
library(viridis)
library(devtools)
#UPLOAD TEMPERATURE DATA
temperature_dataSet <- read.csv("C:/Users/andre/Desktop/Hereon/Data/Wadden Sea, Penning/Temperature_data_1982-2018_MarBiol.csv", header = TRUE, sep = ';')
temperature_95_96 <- temperature_func(temperature_dataSet, "01/01/1995", "31/12/1996")
temperature_10_11 <- temperature_func(temperature_dataSet, "01/01/2010", "31/12/2011")
temperature_10_14 <- temperature_func(temperature_dataSet, "01/01/2010", "31/12/2014")
######### START ###########
#Def. Size Classes ranges
L_as_F <- 85
juvI_min <- 6
juvI_max <- 10
juvII_min  <- 10
juvII_max <- 20
juvIII_min  <- 20
juvIII_max <- 30
juvIV_min  <- 30
juvIV_max <- 40
juvV_min  <- 40
juvV_max <- 50
adultI_min <- 50
adultI_max <- 70
adultII_min <- 70
adultII_max <- L_as_F
LL = 0.3
LJ = (juvI_min+juvI_max)/2 #cm
LJ2 = (juvII_min+juvII_max)/2 /10  # 3cm
LJ3 = (juvIII_min+juvIII_max)/2 /10
LJ4 = (juvIV_min+juvIV_max)/2 /10
LJ5 = (juvV_min+juvV_max)/2 /10
LA1 = (adultI_min + adultI_max)/2 /10
LA2 = (adultII_min + adultII_max)/2 /10 #cm
time_range <- seq(1,1095)
t = seq(0,length(temperature_10_11$temperature)-0.1, by = 0.1)
t_5years = seq(0,length(temperature_10_14$temperature)-0.1, by = 0.1)
state = c(P = 2, E = 0.1, L= 0.4 , J = .4 , J2 = 0.3, J3 = 0.3, J4 = 0.2, J5 = 0.2, A1 = 0.35, A2 = 0.1)
#state = c(P = 100, E = 2, L= 40 , J = 70 , J2 = 50, A2 = 40)
parameters = c()
state2 <- c(P = 2, E = 0.1, L= 0.4 , J = .175 , J2 = 0.125, J3 = 0.125, J4 = 0.1, J5 = 0.1, A1 = 0.35, A2 = 0.1)
start <- Sys.time()
cc_2 <- solver_sizeClass_extended(t = t_5years, state = state2, parameters = parameters, temperature_10_14)
print(Sys.time() - start)
devtools::load_all(".")
cc_2 <- solver_sizeClass_extended(t = t_5years, state = state2, parameters = parameters, temperature_10_14)
start <- Sys.time()
cc_2 <- solver_sizeClass_extended(t = t_5years, state = state2, parameters = parameters, temperature_10_14)
print(Sys.time() - start)
start_date <- as.POSIXct("2010-01-01", format="%Y-%m-%d", tz = "UTC")
cc_2 <- mutate(cc_2, dateTime = start_date + cc_2$time * 86400) #86400 seconds in one day
cc_2 <- cc_2[ , -1] # delete timesteps column
#cc_long_2 <- gather(cc_2, key = "Type", value = "Value", P, E, L, J, J2, J3, J4, J5, A1, A2)
cc_2_long <- cc_2 %>%
pivot_longer(-dateTime, names_to = "variable", values_to = "value")
ggplot(cc_2_long, aes(x = dateTime, y = value, color = variable)) +
geom_line(size = 1) +  # Plot lines
labs(title = " extended size classes aprox. each 10 mm \n 2010-2014 ", x = "Days", y = "Biomass") +
scale_color_manual(
values = c( "P" = "#d9f0a3", "E"= "#1c9099" ,"L" = "gray"  ,"J" = "#bfd3e6", "J2" = "#9ebcda", "J3" = "#8c96c6", "J4" = "#8856a7", "J5" = "#810f7c" ,
"A1" = "#fd8d3c" ,"A2" = "#e6550d" )) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), # Center title
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.position="bottom") #+ ylim(0,100)
View(cc_2)
shift_next_sizeClass_test(5.5, 10, 'F')
shift_next_sizeClass_test(5.5, 1, 'F')
shift_next_sizeClass_test(5.5, .1, 'F')
shift_next_sizeClass_test(5.5, .5, 'F')
shift_next_sizeClass_test(5.5, 0, 'F')
shift_next_sizeClass_test(5.5, -5, 'F')
shift_next_sizeClass_test(5.5, -10, 'F')
shift_next_sizeClass_test(5.5, -20, 'F')
hatch_eggs(5)
hatch_eggs(10)
hatch_eggs(15)
hatch_eggs(1)
hatch_eggs(0)
hatch_eggs(0.5)
hatch_eggs(-1)
hatch_eggs(-5)
1/0
hatch_eggs(0)
0**5
0**-5
0^-5
devtools::load_all(".")
hatch_eggs(10)
hatch_eggs(0)
hatch_eggs(0.5)
hatch_eggs(-1)
hatch_eggs(-10)
devtools::load_all(".")
start <- Sys.time()
cc_2 <- solver_sizeClass_extended(t = t_5years, state = state2, parameters = parameters, temperature_10_14)
print(Sys.time() - start)
start_date <- as.POSIXct("2010-01-01", format="%Y-%m-%d", tz = "UTC")
cc_2 <- mutate(cc_2, dateTime = start_date + cc_2$time * 86400) #86400 seconds in one day
cc_2 <- cc_2[ , -1] # delete timesteps column
#cc_long_2 <- gather(cc_2, key = "Type", value = "Value", P, E, L, J, J2, J3, J4, J5, A1, A2)
cc_2_long <- cc_2 %>%
pivot_longer(-dateTime, names_to = "variable", values_to = "value")
ggplot(cc_2_long, aes(x = dateTime, y = value, color = variable)) +
geom_line(size = 1) +  # Plot lines
labs(title = " extended size classes aprox. each 10 mm \n 2010-2014 ", x = "Days", y = "Biomass") +
scale_color_manual(
values = c( "P" = "#d9f0a3", "E"= "#1c9099" ,"L" = "gray"  ,"J" = "#bfd3e6", "J2" = "#9ebcda", "J3" = "#8c96c6", "J4" = "#8856a7", "J5" = "#810f7c" ,
"A1" = "#fd8d3c" ,"A2" = "#e6550d" )) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), # Center title
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.position="bottom")
ggplot(cc_2_long, aes(x = dateTime, y = value, color = variable)) +
geom_line(size = 1) +  # Plot lines
labs(title = " extended size classes aprox. each 10 mm \n 2010-2014 ", x = "Days", y = "Biomass") +
scale_color_manual(
values = c( "P" = "#d9f0a3", "E"= "#1c9099" ,"L" = "gray"  ,"J" = "#bfd3e6", "J2" = "#9ebcda", "J3" = "#8c96c6", "J4" = "#8856a7", "J5" = "#810f7c" ,
"A1" = "#fd8d3c" ,"A2" = "#e6550d" )) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), # Center title
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.position="bottom") + ylim(0,20)
df_long2 <- cc_2[ ,-1] %>%
pivot_longer(-dateTime, names_to = "variable", values_to = "value")
# Calculate total at each time point and normalize to proportions
#df_long$Date <- as.Date(df$time, origin = "01/01/2010")  # If time starts at 0 "31/12/2009"
#ensure that vertical order is same as life stages
stack_order <- rev(c(colnames(cc_2)[2:10]) ) #rev(c(names(df_long_prev)[2:10], 'sum_all') )
# Ensure 'variable' is a factor with levels in the same order
df_long2$variable <- factor(df_long2$variable, levels = stack_order)
#dev.off()
ggplot(df_long2, aes(x = dateTime, y = value, fill = variable)) +
geom_area() +
scale_fill_viridis_d() +
labs(
title = "",
x = "Date",
y = "Biomass",
fill = "Size class"
)
devtools::load_all(".")
#### Some params ####
temp_range = seq(1,30, 0.1)
natural_mort_br <- sapply(temp_range, natural_mortality_b, 3)
natural_mort_br <- sapply(temp_range, respiration_rate_b, 3)
#dev.off()
plot(temp_range, natural_mortality(temp_range, 3) , type = "b", col = "blue",
xlab = "Temperature (°C)", ylab = " ",
main = "natural mortality Gauss vs Briere")
plot(temp_range, respiration_rate(temp_range, 3) , type = "b", col = "blue",
xlab = "Temperature (°C)", ylab = " ",
main = "natural mortality Gauss vs Briere")
lines(temp_range, natural_mort_br, type = "b", col = 'red' , cex = 0.5)
legend("topright", legend = c("Gauss", "Briere"), col = c("blue", "red"), lty = 1, pch = 1)
natural_mortality_test = function(temperature,L){
m=3
K_range = 0.007613879*m - 0.0005557642*m #max_K - min_K #max(sapply(temp_range, K_func))
K_inv = (0.007613879*m - K_func(temperature)*m) #/ K_range
mu = convertL_to_W(L) * K_inv  # this is the rigth term of vB eq.
if (L>5) mu = 0 #tbc
return(mu)
}
sizes <- c(1.8, 2.8, 3.8, 4.8) #cm
par(mfrow = c(2,2))
for (i in sizes){
plot(temp_range, natural_mortality_test(temp_range, i) , type = "b", col = "blue",
xlab = "Temperature (°C)", ylab = " ",
main = paste("L = ", i, " cm mortality with K_func inverese \n mu = convertL_to_W(L)* K_inv"),
cex.main = 1.5, cex.lab = 1.5, cex.axis = 1.5)#, ylim = c(0, 0.6) )
lines(temp_range, sapply(temp_range, natural_mortality_test_b, i) , type = "b", col = "red", cex = 0.8)
}
respiration_rate_b_check = function(temperature,L){
mu = 0
if (L>5) {} # nothing happens, mu = 0
else{
mu = m*convertL_to_W(L)*K_func_briere(temperature)# this is the rigth term of vB eq.
}
return(mu)
}
respiration_rate_b_check(10)
respiration_rate_b_check(10, 3)
respiration_rate_b_check(5, 3)
respiration_rate_b_check(1, 3)
respiration_rate_b_check(1.5, 3)
respiration_rate_b_check(0.5, 3)
respiration_rate_b_check(0.4, 3)
respiration_rate_b_check(0.3, 3)
respiration_rate_b_check(0, 3)
respiration_rate_b_check(1, 3)
respiration_rate_b_check-(1, 3)
respiration_rate_b_check(-1, 3)
respiration_rate_b_check = function(temperature,L){
mu = m*convertL_to_W(L)*K_func(temperature)# this is the rigth term of vB eq.
if (L>5) {
mu =  convertL_to_W(L) *K_func_briere(temperature) *( 1 - molting_fraction(L, temperature)) #tbc (1-molting_fraction) all non molting fems still have a natural mortality
}
return(mu)
}
respiration_rate_b_check(2, 3)
respiration_rate_b_check(1, 3)
respiration_rate_b_check(0.8, 3)
respiration_rate_b_check(0.5, 3)
respiration_rate_b_check(0.3, 3)
respiration_rate_b_check(0.1, 3)
respiration_rate_b_check(0, 3)
respiration_rate_b_check(0.5, 3)
respiration_rate_b_check(-0.5, 3)
respiration_rate_b_check(-5, 3)
respiration_rate(-5, 3)
respiration_rate(-0.5, 3)
