L_avg_pred_nosex16 = pred_nosex16 %>%
mutate(L_avg = ( L1*size_mean_F[1] + L2*size_mean_F[2]+ L3*size_mean_F[3]+ L4*size_mean_F[4] + L5*size_mean_F[5]
+ BF6*size_mean_F[6] + BF7*size_mean_F[7]+ BF8*size_mean_F[8])/ttlB )
#Only fishery
fish_nosex16 = prep_sol_Lavg(fishery16, "31/12/2015", "01/01/2019")
L_avg_fish_nosex16 = fish_nosex16 %>%
mutate(L_avg = ( L1*size_mean_F[1] + L2*size_mean_F[2]+ L3*size_mean_F[3]+ L4*size_mean_F[4] + L5*size_mean_F[5]
+ BF6*size_mean_F[6] + BF7*size_mean_F[7]+ BF8*size_mean_F[8])/ttlB )
#Both F&P
both_nosex16 = prep_sol_Lavg(FP_15_18_g.22, "31/12/2015", "01/01/2019")
L_avg_both_nosex16 = both_nosex16 %>%
mutate(L_avg = ( L1*size_mean_F[1] + L2*size_mean_F[2]+ L3*size_mean_F[3]+ L4*size_mean_F[4] + L5*size_mean_F[5]
+ BF6*size_mean_F[6] + BF7*size_mean_F[7]+ BF8*size_mean_F[8])/ttlB )
#PLOT CHANGES IN AVG SIZE
#par(mfrow = c(2,1))
cols = brewer.pal(4,"Dark2")
layout(matrix(c(1,2), nrow = 1), widths = c(2,1))
plot(L_avg_noPreasure16$dateTime, L_avg_noPreasure16$L_avg, las = 1,  col = 'grey', cex.axis = 1.4, cex.lab = 1.4,
xlab = 'years', ylab = paste(TeX("$L$"), '[cm]'), ylim = c(3.5, 5) ,type = 'l', lty = 2, lwd = 3, #TeX(r"($\ell$)" )
main = ' ', cex.main = 1.4) #main = "main = 'Changes in average size'"
lines(L_avg_pred_nosex16$dateTime, L_avg_pred_nosex16$L_avg, col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, L_avg_fish_nosex16$L_avg, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, L_avg_both_nosex16$L_avg, col = cols[3], lty=1, lwd = 2.5)
plot.new()
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'), xjust = 1,
yjust = 0, fill = c('grey', cols[1], cols[2],cols[3]), border = NA, y.intersp = 0.5,
bty = "n", xpd = TRUE, inset = c(-0.05, -0.05), cex = 1.5)
cols = brewer.pal(4,"Dark2")
layout(matrix(c(1,2), nrow = 1), widths = c(2,1))
plot(L_avg_noPreasure16$dateTime, L_avg_noPreasure16$L_avg, las = 1,  col = 'grey', cex.axis = 1.4, cex.lab = 1.4,
xlab = 'years', ylab = paste(TeX("$L$"), '[cm]'), ylim = c(3.25, 5) ,type = 'l', lty = 2, lwd = 3, #TeX(r"($\ell$)" )
main = ' ', cex.main = 1.4) #main = "main = 'Changes in average size'"
lines(L_avg_pred_nosex16$dateTime, L_avg_pred_nosex16$L_avg, col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, L_avg_fish_nosex16$L_avg, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, L_avg_both_nosex16$L_avg, col = cols[3], lty=1, lwd = 2.5)
plot.new()
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'), xjust = 1,
yjust = 0, fill = c('grey', cols[1], cols[2],cols[3]), border = NA, y.intersp = 0.5,
bty = "n", xpd = TRUE, inset = c(-0.05, -0.05), cex = 1.5)
layout(matrix(c(1,2), nrow = 1), widths = c(2,1))
plot(L_avg_noPreasure16$dateTime, L_avg_noPreasure16$L_avg, las = 1,  col = 'grey', cex.axis = 1.4, cex.lab = 1.4,
xlab = 'years', ylab = paste(TeX("$L$"), '[cm]'), ylim = c(3.15, 5.1) ,type = 'l', lty = 2, lwd = 3, #TeX(r"($\ell$)" )
main = ' ', cex.main = 1.4) #main = "main = 'Changes in average size'"
lines(L_avg_pred_nosex16$dateTime, L_avg_pred_nosex16$L_avg, col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, L_avg_fish_nosex16$L_avg, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, L_avg_both_nosex16$L_avg, col = cols[3], lty=1, lwd = 2.5)
plot.new()
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'), xjust = 1,
yjust = 0, fill = c('grey', cols[1], cols[2],cols[3]), border = NA, y.intersp = 0.5,
bty = "n", xpd = TRUE, inset = c(-0.05, -0.05), cex = 1.5)
layout(matrix(c(1,2), nrow = 1), widths = c(2,1))
plot(L_avg_noPreasure16$dateTime, L_avg_noPreasure16$L_avg, las = 1,  col = 'grey', cex.axis = 1.4, cex.lab = 1.4,
xlab = 'years', ylab = paste(TeX("$L$"), '[cm]'), ylim = c(3.15, 5.1) ,type = 'l', lty = 2, lwd = 3, #TeX(r"($\ell$)" )
main = ' ', cex.main = 1.4) #main = "main = 'Changes in average size'"
lines(L_avg_pred_nosex16$dateTime, L_avg_pred_nosex16$L_avg, col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, L_avg_fish_nosex16$L_avg, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, L_avg_both_nosex16$L_avg, col = cols[3], lty=1, lwd = 2.5)
plot.new()
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'), xjust = 1,
yjust = 0, fill = c('grey', cols[1], cols[2],cols[3]), border = NA, y.intersp = 0.75,
bty = "n", xpd = TRUE, inset = c(-0.05, -0.05), cex = 1.5)
layout(matrix(c(1,2), nrow = 1), widths = c(2,1))
plot(L_avg_noPreasure16$dateTime, L_avg_noPreasure16$L_avg, las = 1,  col = 'grey', cex.axis = 1.4, cex.lab = 1.4,
xlab = 'years', ylab = paste(TeX("$L$"), '[cm]'), ylim = c(3.15, 5.1) ,type = 'l', lty = 2, lwd = 3, #TeX(r"($\ell$)" )
main = ' ', cex.main = 1.4) #main = "main = 'Changes in average size'"
lines(L_avg_pred_nosex16$dateTime, L_avg_pred_nosex16$L_avg, col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, L_avg_fish_nosex16$L_avg, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, L_avg_both_nosex16$L_avg, col = cols[3], lty=1, lwd = 2.5)
plot.new()
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'), xjust = 1,
yjust = 0, fill = c('grey', cols[1], cols[2],cols[3]), border = NA, y.intersp = 0.75,
bty = "n", xpd = TRUE, inset = c(-0.05, -0.05), cex = 1.35)
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime, noPreasure_noSex16$ttlB, las = 1,  col = 'grey', cex = 0.8,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass ', ylim = c(250, 10000) )
lines(L_avg_pred_nosex16$dateTime, pred_nosex16$ttlB, col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, fish_nosex16$ttlB, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, both_nosex16$ttlB, col = cols[3], lty=1, lwd = 2.5)
legend("topleft", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.6)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime, noPreasure_noSex16$ttlB, las = 1,  col = 'grey', cex = 0.8,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass ', ylim = c(250, 5000) )
lines(L_avg_pred_nosex16$dateTime, pred_nosex16$ttlB, col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, fish_nosex16$ttlB, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, both_nosex16$ttlB, col = cols[3], lty=1, lwd = 2.5)
legend("topleft", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.6)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime, noPreasure_noSex16$ttlB, las = 1,  col = 'grey', cex = 0.8,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass ', ylim = c(250, 5000) )
lines(L_avg_pred_nosex16$dateTime, pred_nosex16$ttlB, col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, fish_nosex16$ttlB, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, both_nosex16$ttlB, col = cols[3], lty=1, lwd = 2.5)
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.6)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime, noPreasure_noSex16$ttlB, las = 1,  col = 'grey', cex = 0.8,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass ', ylim = c(250, 5000) )
lines(L_avg_pred_nosex16$dateTime, pred_nosex16$ttlB, col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, fish_nosex16$ttlB, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, both_nosex16$ttlB, col = cols[3], lty=1, lwd = 2.5)
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.75, cex = 1.25)
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime, noPreasure_noSex16$ttlB, las = 1,  col = 'grey', cex = 1,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass ', ylim = c(250, 5000) )
lines(L_avg_pred_nosex16$dateTime, pred_nosex16$ttlB, col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, fish_nosex16$ttlB, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, both_nosex16$ttlB, col = cols[3], lty=1, lwd = 2.5)
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.75, cex = 1.2)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime, noPreasure_noSex16$ttlB, las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass ', ylim = c(250, 5000) )
lines(L_avg_pred_nosex16$dateTime, pred_nosex16$ttlB, col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, fish_nosex16$ttlB, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, both_nosex16$ttlB, col = cols[3], lty=1, lwd = 2.5)
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.75, cex = 1.2)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
days = seq(1,365)
plot(days, ST_predation(days, 10, eta_J(days) ))
plot(days, ST_predation(days, 10, eta = eta_J(days) ))
plot(days, ST_predation(days, 10, 200 ,eta = eta_J(days) ))
plot(days, ST_predation(days, 10, 2000 ,eta = eta_J(days) ))
plot(days, ST_predation(days, 10, 20000 ,eta = eta_J(days) ))
4/365
library(deSolve)
library(RColorBrewer)
library(BrownShrimp)
library(viridis)
library(dplyr)
library(tidyr)
library("colorspace")
#library(lubridate)
library(latex2exp)
library(profvis)
library(stringr)
#library(devtools)
#Read water temperature from Wadden Sea:
temperature_dataSet <- read.csv("./data/Temperature_data_1982-2018_MarBiol.csv", header = TRUE, sep = ';')
temperature_10_15 <- temperature_func(temperature_dataSet, "01/01/2010", "31/12/2015")
##########
temperature_germany <- read.csv("./data/temperature_10ger.csv")
tempG.10_15 = temperature_germany %>% filter(date_time > as.Date("31/12/2009", format = "%d/%m/%Y") & date_time < as.Date("01/01/2016", format = "%d/%m/%Y"))
ble_data = read.csv("./data/BLE_Inlandslandungen_SpeiseKrabbe.csv", sep = ';')
t_years = seq(0,length(tempG.10_15$temperature)-.1)
#initialize Initial conditions
BF_p = c(3.801852,  7.063263,  12.657331, 25.166351, 49.297133, 45.876772, 34.672340,  19.396426)#*1e-6 #see calculation in file 'sizeSpectraMoldel.R'
BM_p = c(4.573332  , 8.203546 , 13.791605 , 26.328928 , 43.371121  )#*1e-6 #see calculation in file 'sizeSpectraMoldel.R'
IC_parameterized.v2 = c(P = 2, E = 2, L= 1 ,
BF = BF_p, BM = BM_p) #Initial conditions with reduced area (only up to 20 m depth).
#Initialitze parameters for comparation of 4 diff scenarios: no pressure, fishery, pred and both
#No pressure
noPreasure_params = parameters_solv
devtools::load_all(".")
#Initialitze parameters for comparation of 4 diff scenarios: no pressure, fishery, pred and both
#No pressure
noPreasure_params = parameters_solv
noPreasure_params$general_params$Fi = 0 #No fishery
noPreasure_params$general_params$Imax_ik = 0 #No predation
#Only predation
pred_params = parameters_solv
pred_params$general_params$Fi = 0 #No fishery
pred_params$general_params$Imax_ik = 0.185
#Only Fishery
fishery_params = parameters_solv
fishery_params$general_params$Imax_ik = 0 #No predation
fishery_params$general_params$Fi = 4/365
BF = c(8.695212, 15.349638, 21.461595, 24.672213,25.871618, 17.536662, 14.090960, 11.933151)
BM = c(10.85817, 19.93554, 29.01086, 36.67041, 58.26882)
Init.v3 = c(P = 2, E = 2, L= 1 ,
BF = BF, BM = BM)
bothPF_params16 = parameters_solv
bothPF_params16$general_params$Fi = 4/365 #Temming & Hufnagl 2015
bothPF_params16$general_params$L50 = 4.02 #et. al Santos 2018
bothPF_params16$general_params$SR = 0.82 #et. al Santos 2018
bothPF_params16$general_params$Imax_ik = 0.18#'increasing' predation in these years as per: https://www.openseas.org.uk/news/on-thin-ices-north-sea-cod/
tempG.15_18 = temperature_germany %>% filter(date_time > as.Date("31/12/2014", format = "%d/%m/%Y") & date_time < as.Date("01/01/2020", format = "%d/%m/%Y"))
t_years16 = seq(0,length(tempG.15_18$temperature)-.1)
start <- Sys.time()
FP_15_18_g.22 <- solver_sizeClass.v5(t = t_years16, state = Init.v3, parameters = bothPF_params16, temperature_dataSet = tempG.15_18)
print(Sys.time() - start)
plot_sizeSpectra_old(sol_df_main = FP_15_18_g.22, year = 2017, title = "F&P")
bothPF_params16.2 = parameters_solv
bothPF_params16.2$general_params$Fi = 4/365 #Temming & Hufnagl 2015
bothPF_params16.2$general_params$L50 = 3.69 #et. al Santos 2018
bothPF_params16.2$general_params$SR = 0.75 #et. al Santos 2018
bothPF_params16.2$general_params$Imax_ik = 0.185 #'increasing' predation in these years as per: https://www.openseas.org.uk/news/on-thin-ices-north-sea-cod/
tempG.15_18 = temperature_germany %>% filter(date_time > as.Date("31/12/2014", format = "%d/%m/%Y") & date_time < as.Date("01/01/2020", format = "%d/%m/%Y"))
t_years16 = seq(0,length(tempG.15_18$temperature)-.1)
start <- Sys.time()
FP_15_18_g.20 <- solver_sizeClass.v5(t = t_years16, state = IC_parameterized.v2, parameters = bothPF_params16.2, temperature_dataSet = tempG.15_18)
print(Sys.time() - start)
years_to_see = c(2017, 2018, 2019)
par(mfrow = c(1,length(years_to_see)))
for (i in years_to_see){
#Solution with cod-end 22 mm
sol_yearToSee = FP_15_18_g.22 %>%
filter(as.numeric(format(FP_15_18_g.22$dateTime,'%Y')) == i) %>%
mutate(month = month(dateTime)) %>%
group_by(month) %>%
summarise(across(where(is.numeric), \(x) sum(x, na.rm = TRUE)))
#Solution with cod-end 20 mm
#sol_2 = FP_15_18_g.20 %>%
#  filter(as.numeric(format(FP_15_18_g.20$dateTime,'%Y')) == i) %>%
#  mutate(month = month(dateTime)) %>%
#  group_by(month) %>%
#  summarise(across(where(is.numeric), \(x) sum(x, na.rm = TRUE)))
#Calculate the total landings per month (considering 50% discard):
plot(ble_data$month[ble_data$year == i], ble_data$t[ble_data$year == i], col = 'gray42',  lwd = 2,  type = 'b',
main = paste(' ', i), ylim = c(0,2250), cex.main = 1.5,
xlab = "Month", ylab = "Landing [t]", cex.lab = 1.5, cex.axis = 1.25, las = 1)
lines(sol_yearToSee$month, (sol_yearToSee$catch_commercial.BF6 )*7587.1/1000, col = 'green' )
#lines(sol_yearToSee$month, (sol_yearToSee$catch_undersized.BF1)*7587.1/1000, col = '#c994c7')
#lines(sol_2$month, (sol_2$catch_undersized.BF1)*7587.1/1000, col = 'red')
}
legend("topleft", legend = c('Landing data', 'Sim result'),#, 'bycatch 2.2', 'bycatch 2'),
border = NA, y.intersp = 0.85, cex = 1.2, fill = c('gray42', 'green'))#, '#c994c7','red') )
noPreasure16 <- solver_sizeClass.v5(t = t_years16, state = IC_parameterized.v2,
parameters = noPreasure_params, temperature_dataSet = tempG.15_18)
#plot_sizeSpectra_old(sol_df_main = noPreasure16, year = 2017, title = "no F&P")
predation16 <- solver_sizeClass.v5(t = t_years16, state = IC_parameterized.v2,
parameters = pred_params, temperature_dataSet = tempG.15_18)
plot_sizeSpectra_old(sol_df_main = predation16, year = 2017, title = "P")
fishery_params$general_params$L50 = 4.02
fishery_params$general_params$SR = 0.82
fishery16 <- solver_sizeClass.v5(t = t_years16, state = IC_parameterized.v2,
parameters = fishery_params, temperature_dataSet = tempG.15_18)
noPreasure_noSex16 = prep_sol_Lavg(noPreasure16, "31/12/2015", "01/01/2019")
L_avg_noPreasure16 = noPreasure_noSex16 %>%
mutate(L_avg = ( L1*size_mean_F[1] + L2*size_mean_F[2]+ L3*size_mean_F[3]+ L4*size_mean_F[4] + L5*size_mean_F[5]
+ BF6*size_mean_F[6] + BF7*size_mean_F[7]+ BF8*size_mean_F[8])/ttlB )
#Only Predation
pred_nosex16 = prep_sol_Lavg(predation16, "31/12/2015", "01/01/2019")
L_avg_pred_nosex16 = pred_nosex16 %>%
mutate(L_avg = ( L1*size_mean_F[1] + L2*size_mean_F[2]+ L3*size_mean_F[3]+ L4*size_mean_F[4] + L5*size_mean_F[5]
+ BF6*size_mean_F[6] + BF7*size_mean_F[7]+ BF8*size_mean_F[8])/ttlB )
#Only fishery
fish_nosex16 = prep_sol_Lavg(fishery16, "31/12/2015", "01/01/2019")
L_avg_fish_nosex16 = fish_nosex16 %>%
mutate(L_avg = ( L1*size_mean_F[1] + L2*size_mean_F[2]+ L3*size_mean_F[3]+ L4*size_mean_F[4] + L5*size_mean_F[5]
+ BF6*size_mean_F[6] + BF7*size_mean_F[7]+ BF8*size_mean_F[8])/ttlB )
#Both F&P
both_nosex16 = prep_sol_Lavg(FP_15_18_g.22, "31/12/2015", "01/01/2019")
L_avg_both_nosex16 = both_nosex16 %>%
mutate(L_avg = ( L1*size_mean_F[1] + L2*size_mean_F[2]+ L3*size_mean_F[3]+ L4*size_mean_F[4] + L5*size_mean_F[5]
+ BF6*size_mean_F[6] + BF7*size_mean_F[7]+ BF8*size_mean_F[8])/ttlB )
#PLOT CHANGES IN AVG SIZE
#par(mfrow = c(2,1))
cols = brewer.pal(4,"Dark2")
layout(matrix(c(1,2), nrow = 1), widths = c(2,1))
plot(L_avg_noPreasure16$dateTime, L_avg_noPreasure16$L_avg, las = 1,  col = 'grey', cex.axis = 1.4, cex.lab = 1.4,
xlab = 'years', ylab = paste(TeX("$L$"), '[cm]'), ylim = c(3.15, 5.1) ,type = 'l', lty = 2, lwd = 3, #TeX(r"($\ell$)" )
main = ' ', cex.main = 1.4) #main = "main = 'Changes in average size'"
lines(L_avg_pred_nosex16$dateTime, L_avg_pred_nosex16$L_avg, col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, L_avg_fish_nosex16$L_avg, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, L_avg_both_nosex16$L_avg, col = cols[3], lty=1, lwd = 2.5)
plot.new()
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'), xjust = 1,
yjust = 0, fill = c('grey', cols[1], cols[2],cols[3]), border = NA, y.intersp = 0.75,
bty = "n", xpd = TRUE, inset = c(-0.05, -0.05), cex = 1.35)
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime, noPreasure_noSex16$ttlB, las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass ', ylim = c(250, 5000) )
lines(L_avg_pred_nosex16$dateTime, pred_nosex16$ttlB, col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, fish_nosex16$ttlB, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, both_nosex16$ttlB, col = cols[3], lty=1, lwd = 2.5)
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.75, cex = 1.2)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
ylim_range <- range(noPreasure_noSex16$ttlB)
# Add a small buffer to the top and bottom
ylim_range[1] <- ylim_range[1] - 0.1 * diff(ylim_range)
ylim_range[2] <- ylim_range[2] + 0.1 * diff(ylim_range)
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime,  , las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass ', ylim = ylim_range )
lines(L_avg_pred_nosex16$dateTime, pred_nosex16$ttlB, col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, fish_nosex16$ttlB, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, both_nosex16$ttlB, col = cols[3], lty=1, lwd = 2.5)
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.75, cex = 1.2)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime,  , las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX("log(biomass kg $km^{-2}$") , type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass ', log = "y", ylim = c(1, max(noPreasure_noSex16$ttlB, L_avg_pred_nosex16$ttlB, fish_nosex16$ttlB, both_nosex16$ttlB)))
lines(L_avg_pred_nosex16$dateTime, pred_nosex16$ttlB, col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, fish_nosex16$ttlB, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, both_nosex16$ttlB, col = cols[3], lty=1, lwd = 2.5)
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.75, cex = 1.2)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
plot(noPreasure_noSex16$dateTime,  , las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX("log(biomass kg $km^{-2}$") , type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass ', log = "y",
ylim = c(1, max(noPreasure_noSex16$ttlB, L_avg_pred_nosex16$ttlB, fish_nosex16$ttlB, both_nosex16$ttlB)))
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime,  , las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass ', ylim = c(250, 5000) , log = 'y')
lines(L_avg_pred_nosex16$dateTime, pred_nosex16$ttlB, col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, fish_nosex16$ttlB, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, both_nosex16$ttlB, col = cols[3], lty=1, lwd = 2.5)
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.75, cex = 1.2)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime,  , las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass ', log = 'y') #, ylim = c(250, 5000)
lines(L_avg_pred_nosex16$dateTime, pred_nosex16$ttlB, col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, fish_nosex16$ttlB, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, both_nosex16$ttlB, col = cols[3], lty=1, lwd = 2.5)
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.75, cex = 1.2)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
#plot_sizeSpectra(FP_15_18_g.20, sol_df_overlay= FP_15_18_g.22 ,year = 2017, title = "cod-end 2 vs 2.2 cm")
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime,  , las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass ', log = 'y') #, ylim = c(250, 5000)
lines(L_avg_pred_nosex16$dateTime, pred_nosex16$ttlB, col = cols[1], lty=1, lwd = 2.5, log = 'y')
lines(L_avg_fish_nosex16$dateTime, fish_nosex16$ttlB, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, both_nosex16$ttlB, col = cols[3], lty=1, lwd = 2.5)
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.75, cex = 1.2)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
plot(L_avg_pred_nosex16$dateTime, pred_nosex16$ttlB, col = cols[1], lty=1, lwd = 2.5, log = 'y')
plot(noPreasure_noSex16$dateTime,  , las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass ', log = 'y') #, ylim = c(250, 5000)
plot(L_avg_pred_nosex16$dateTime, pred_nosex16$ttlB, col = cols[1], lty=1, lwd = 2.5)#, log = 'y')
plot(L_avg_pred_nosex16$dateTime, pred_nosex16$ttlB, col = cols[1], lty=1, lwd = 2.5)#, log = 'y')
plot(L_avg_pred_nosex16$dateTime, pred_nosex16$ttlB, col = cols[1], lty=1, lwd = 2.5, log = 'y')
log(1800)
plot(L_avg_pred_nosex16$dateTime, pred_nosex16$ttlB, col = cols[1], lty=1, lwd = 2.5, log = "y")
plot(L_avg_pred_nosex16$dateTime, log(pred_nosex16$ttlB) , col = cols[1], lty=1, lwd = 2.5)
plot(noPreasure_noSex16$dateTime,  , las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass ', log = 'y') #, ylim = c(250, 5000)
lines(L_avg_pred_nosex16$dateTime, log(pred_nosex16$ttlB) , col = cols[1], lty=1, lwd = 2.5)
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime,noPreasure_noSex16$ttlB  , las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass ', log = 'y') #, ylim = c(250, 5000)
lines(L_avg_pred_nosex16$dateTime, log(pred_nosex16$ttlB) , col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, fish_nosex16$ttlB, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, both_nosex16$ttlB, col = cols[3], lty=1, lwd = 2.5)
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.75, cex = 1.2)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime, log(noPreasure_noSex16$ttlB), las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass') #, ylim = c(250, 5000)
lines(L_avg_pred_nosex16$dateTime, log(pred_nosex16$ttlB) , col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, fish_nosex16$ttlB, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, both_nosex16$ttlB, col = cols[3], lty=1, lwd = 2.5)
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.75, cex = 1.2)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
plot(L_avg_pred_nosex16$dateTime, log(pred_nosex16$ttlB) , col = cols[1], lty=1, lwd = 2.5)
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime, log(noPreasure_noSex16$ttlB), las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass', ylim = c(0, 10) )
lines(L_avg_pred_nosex16$dateTime, log(pred_nosex16$ttlB) , col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, fish_nosex16$ttlB, col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, both_nosex16$ttlB, col = cols[3], lty=1, lwd = 2.5)
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.75, cex = 1.2)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime, log(noPreasure_noSex16$ttlB), las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass', ylim = c(3, 10) )
lines(L_avg_pred_nosex16$dateTime, pred_nosex16$ttlB , col = cols[1], lty=1, lwd = 2.5, log = "y")
lines(L_avg_fish_nosex16$dateTime, fish_nosex16$ttlB, col = cols[2], lty=1, lwd = 2.5, log = "y")
lines(L_avg_both_nosex16$dateTime, both_nosex16$ttlB, col = cols[3], lty=1, lwd = 2.5, log = "y")
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.75, cex = 1.2)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime, log(noPreasure_noSex16$ttlB), las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass', ylim = c(3, 10) )
lines(L_avg_pred_nosex16$dateTime, log(pred_nosex16$ttlB) , col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, log(fish_nosex16$ttlB), col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, log(both_nosex16$ttlB), col = cols[3], lty=1, lwd = 2.5)
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.75, cex = 1.2)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime, log(noPreasure_noSex16$ttlB), las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass', ylim = c(5.5, 10) )
lines(L_avg_pred_nosex16$dateTime, log(pred_nosex16$ttlB) , col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, log(fish_nosex16$ttlB), col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, log(both_nosex16$ttlB), col = cols[3], lty=1, lwd = 2.5)
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.75, cex = 1.2)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime, log(noPreasure_noSex16$ttlB), las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass', ylim = c(5.75, 11) )
lines(L_avg_pred_nosex16$dateTime, log(pred_nosex16$ttlB) , col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, log(fish_nosex16$ttlB), col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, log(both_nosex16$ttlB), col = cols[3], lty=1, lwd = 2.5)
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.75, cex = 1.2)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime, log(noPreasure_noSex16$ttlB), las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass', ylim = c(5.75, 11) )
lines(L_avg_pred_nosex16$dateTime, log(pred_nosex16$ttlB) , col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, log(fish_nosex16$ttlB), col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, log(both_nosex16$ttlB), col = cols[3], lty=1, lwd = 2.5)
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.65, cex = 1.1)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
par(mfrow = c(1,1) )
plot(noPreasure_noSex16$dateTime, log(noPreasure_noSex16$ttlB), las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass', ylim = c(5.75, 11.5) )
lines(L_avg_pred_nosex16$dateTime, log(pred_nosex16$ttlB) , col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, log(fish_nosex16$ttlB), col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, log(both_nosex16$ttlB), col = cols[3], lty=1, lwd = 2.5)
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.65, cex = 1.1)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
par(mfrow = c(1,2) )
plot(noPreasure_noSex16$dateTime, log(noPreasure_noSex16$ttlB), las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass', ylim = c(5.75, 10) )
lines(L_avg_pred_nosex16$dateTime, log(pred_nosex16$ttlB) , col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, log(fish_nosex16$ttlB), col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, log(both_nosex16$ttlB), col = cols[3], lty=1, lwd = 2.5)
plot.new()
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.65, cex = 1.1)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
layout(matrix(c(1,2), nrow = 1), widths = c(2,1))
plot(noPreasure_noSex16$dateTime, log(noPreasure_noSex16$ttlB), las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass', ylim = c(5.75, 10) )
lines(L_avg_pred_nosex16$dateTime, log(pred_nosex16$ttlB) , col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, log(fish_nosex16$ttlB), col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, log(both_nosex16$ttlB), col = cols[3], lty=1, lwd = 2.5)
plot.new()
legend("topright", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.65, cex = 1.1)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
#par(mfrow = c(1,2) )
layout(matrix(c(1,2), nrow = 1), widths = c(2,1))
plot(noPreasure_noSex16$dateTime, log(noPreasure_noSex16$ttlB), las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass', ylim = c(5.75, 10) )
lines(L_avg_pred_nosex16$dateTime, log(pred_nosex16$ttlB) , col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, log(fish_nosex16$ttlB), col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, log(both_nosex16$ttlB), col = cols[3], lty=1, lwd = 2.5)
plot.new()
legend("center", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.65, cex = 1.1)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
layout(matrix(c(1,2), nrow = 1), widths = c(2.3,1))
par(mar = c(4.5, 5, 3, 1), oma = c(0, 0, 0, 0))
plot(noPreasure_noSex16$dateTime, log(noPreasure_noSex16$ttlB), las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = 'Changes in biomass', ylim = c(5.75, 10) )
lines(L_avg_pred_nosex16$dateTime, log(pred_nosex16$ttlB) , col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, log(fish_nosex16$ttlB), col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, log(both_nosex16$ttlB), col = cols[3], lty=1, lwd = 2.5)
par(mar = c(0, 0, 0, 0))
plot.new()
legend("center", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.65, cex = 1.1)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
layout(matrix(c(1,2), nrow = 1), widths = c(2.3,1))
par(mar = c(4.5, 5, 3, 1), oma = c(0, 0, 0, 0))
plot(noPreasure_noSex16$dateTime, log(noPreasure_noSex16$ttlB), las = 1,  col = 'grey', cex.axis = 1.2, cex.lab = 1.2,
xlab = 'years', ylab = TeX(" biomass kg $km^{-2}$"), type = 'l', lty = 2, lwd = 3,
main = ' ', ylim = c(5.75, 10) ) # main = 'Changes in biomass'
lines(L_avg_pred_nosex16$dateTime, log(pred_nosex16$ttlB) , col = cols[1], lty=1, lwd = 2.5)
lines(L_avg_fish_nosex16$dateTime, log(fish_nosex16$ttlB), col = cols[2], lty=1, lwd = 2.5)
lines(L_avg_both_nosex16$dateTime, log(both_nosex16$ttlB), col = cols[3], lty=1, lwd = 2.5)
par(mar = c(0, 0, 0, 0))
plot.new()
legend("center", legend = c('no pressure', 'only predation', 'only fishery', 'both F & P'),
fill = c('grey', cols[1], cols[2],cols[3]), border = NA, bty = "n", y.intersp = 0.65, cex = 1.1)#,
#inset = c(0.0, 0.05)) #,xpd = TRUE
plot(FP_10_15_g$dateTime, FP_10_15_g$P)
plot(FP_15_18_g.22$dateTime, FP_15_18_g.22$P )
dev.off()
plot(FP_15_18_g.22$dateTime, FP_15_18_g.22$P )
plot_sizeSpectra(fishery16, sol_df_overlay = predation16, year = 2017, title = "F vs P")
